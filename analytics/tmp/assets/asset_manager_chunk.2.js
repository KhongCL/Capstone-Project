/* Matomo Javascript - cb=b34c37c689f78009341cf4832ea0ae00*/

(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin","SegmentEditor"],t):"object"===typeof exports?exports["PrivacyManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):e["PrivacyManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"],e["SegmentEditor"])})("undefined"!==typeof self?self:this,(function(e,t,n,a){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/PrivacyManager/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},f06f:function(e,t){e.exports=a},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ManageGdpr",(function(){return re})),n.d(t,"AnonymizeIp",(function(){return je})),n.d(t,"OptOutCustomizer",(function(){return Ge})),n.d(t,"AnonymizeLogData",(function(){return _t})),n.d(t,"DoNotTrackPreference",(function(){return wt})),n.d(t,"ReportDeletionSettings",(function(){return Bt})),n.d(t,"DeleteOldLogs",(function(){return Wt})),n.d(t,"DeleteOldReports",(function(){return ln})),n.d(t,"ScheduleReportDeletion",(function(){return Cn})),n.d(t,"AskingForConsent",(function(){return Wn})),n.d(t,"GdprOverview",(function(){return ha})),n.d(t,"PreviousAnonymizations",(function(){return Ta})),n.d(t,"PrivacySettings",(function(){return qa})),n.d(t,"UsersOptOut",(function(){return Ja})),"undefined"!==typeof window){var a=window.document.currentScript,o=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var r=n("8bbf"),i={class:"manageGdpr"},l={class:"intro"},c=Object(r["createElementVNode"])("br",null,null,-1),s=Object(r["createElementVNode"])("br",null,null,-1),d=Object(r["createElementVNode"])("br",null,null,-1),u=Object(r["createElementVNode"])("br",null,null,-1),m=["innerHTML"],b={class:"form-group row"},p={class:"col s12 input-field"},g={for:"gdprsite",class:"siteSelectorLabel"},O={class:"sites_autocomplete"},j={key:0,class:"form-group row segmentFilterGroup"},v={class:"col s12"},y={style:{margin:"8px 0",display:"inline-block"}},h={key:2,class:"dataUnavailable system notification notification-icon\n      notification-info"},f={key:0,class:"system notification notification-icon\n      notification-info"},V={class:"notification-body"},D=Object(r["createElementVNode"])("br",null,null,-1),N=Object(r["createTextVNode"])(),E=Object(r["createElementVNode"])("br",null,null,-1),S=Object(r["createElementVNode"])("br",null,null,-1),C=Object(r["createElementVNode"])("br",null,null,-1),k={class:"checkInclude"},_={colspan:"8"},P=["title"],M={class:"checkInclude"},w=["title"],z={class:"visitId"},A={class:"visitorId"},T=["title","onClick"],I={class:"visitorIp"},L=["title","onClick"],B={class:"userId"},x=["title","onClick"],F=["title"],R=["src"],U=["title"],H=["src"],q=["title"],G=["src"],K=["title"],W=["src"],Y=["onClick"],J=Object(r["createElementVNode"])("img",{src:"plugins/Live/images/visitorProfileLaunch.png",style:{"margin-right":"3.5px"}},null,-1),Q={class:"ui-confirm",id:"confirmDeleteDataSubject",ref:"confirmDeleteDataSubject"},X=["value"],Z=["value"];function ee(e,t,n,a,o,$){var ee=Object(r["resolveComponent"])("SiteSelector"),te=Object(r["resolveComponent"])("SegmentGenerator"),ne=Object(r["resolveComponent"])("SaveButton"),ae=Object(r["resolveComponent"])("ContentBlock"),oe=Object(r["resolveComponent"])("Field"),re=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",i,[Object(r["createVNode"])(ae,{"content-title":e.translate("PrivacyManager_GdprTools")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",l,[Object(r["createElementVNode"])("p",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntro1"))+" ",1),c,s,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntro2"))+" ",1),d]),Object(r["createElementVNode"])("ol",null,[Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntroAccessRight")),1),Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntroEraseRight")),1)]),Object(r["createElementVNode"])("p",null,[u,Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.overviewHintText)},null,8,m)])]),Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_SearchForDataSubject")),1),Object(r["createElementVNode"])("div",b,[Object(r["createElementVNode"])("div",p,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",g,Object(r["toDisplayString"])(e.translate("PrivacyManager_SelectWebsite")),1),Object(r["createElementVNode"])("div",O,[Object(r["createVNode"])(ee,{id:"gdprsite",modelValue:e.site,"onUpdate:modelValue":[t[0]||(t[0]=function(t){return e.site=t}),t[1]||(t[1]=function(t){return e.changeSite(t)})],"show-all-sites-item":!0,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["modelValue"])])])])]),e.isVisitorLogAndProfileEnabled?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",j,[Object(r["createElementVNode"])("div",v,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",y,Object(r["toDisplayString"])(e.translate("PrivacyManager_FindDataSubjectsBy")),1),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(te,{modelValue:e.segment_filter,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.segment_filter=t}),"visit-segments-only":!0,idsite:e.site.id,"show-segment-editor":!0},null,8,["modelValue","idsite"])])])])])):Object(r["createCommentVNode"])("",!0),e.isVisitorLogAndProfileEnabled?(Object(r["openBlock"])(),Object(r["createBlock"])(ne,{key:1,class:"findDataSubjects",value:e.translate("PrivacyManager_FindMatchingDataSubjects"),onConfirm:t[3]||(t[3]=function(t){return e.findDataSubjects()}),disabled:!e.segment_filter,saving:e.isLoading},null,8,["value","disabled","saving"])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",h,[Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_SiteDataNotAvailable")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_VisitorLogsProfilesDisabledMessage")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_PleaseEnableVisitorLogsProfiles")),1)]))]})),_:1},8,["content-title"]),e.allWebsitesContainsDisabledSite?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",f,[Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_SiteDataNotAvailableCertainSites")),1),Object(r["createElementVNode"])("div",V,[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_VisitorLogsProfilesSiteNamesDisabledMessage")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_PleaseEnableVisitorLogsProfilesSites")),1)])])):Object(r["createCommentVNode"])("",!0),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_NoDataSubjectsFound")),1)],512),[[r["vShow"],!e.dataSubjects.length&&e.hasSearched]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_MatchingDataSubjects")),1),Object(r["createElementVNode"])("p",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_VisitsMatchedCriteria"))+" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_ExportingNote"))+" ",1),D,N,E,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_DeletionFromMatomoOnly"))+" ",1),S,C,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_ResultIncludesAllVisits")),1)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",k,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(oe,{uicontrol:"checkbox",name:"activateAll","model-value":e.toggleAll,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.toggleAll=t,e.toggleActivateAll()}),"full-width":!0},null,8,["model-value"])])]),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_Website")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_VisitId")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_VisitorID")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_VisitorIP")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_UserId")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_Details")),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_Action")),513),[[r["vShow"],e.profileEnabled]])])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",_,Object(r["toDisplayString"])(e.translate("PrivacyManager_ResultTruncated","400")),1)],512),[[r["vShow"],e.dataSubjects.length>400]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.dataSubjects,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{title:"".concat(e.translate("PrivacyManager_LastAction"),": ").concat(t.lastActionDateTime),key:n},[Object(r["createElementVNode"])("td",M,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(oe,{uicontrol:"checkbox",name:"subject".concat(t.idVisit),modelValue:e.dataSubjectsActive[n],"onUpdate:modelValue":function(t){return e.dataSubjectsActive[n]=t},"full-width":!0},null,8,["name","modelValue","onUpdate:modelValue"])])]),Object(r["createElementVNode"])("td",{class:"site",title:"(".concat(e.translate("General_Id")," ").concat(t.idSite,")")},Object(r["toDisplayString"])(t.siteName),9,w),Object(r["createElementVNode"])("td",z,Object(r["toDisplayString"])(t.idVisit),1),Object(r["createElementVNode"])("td",A,[Object(r["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddVisitorIdToSearch"),onClick:function(n){return e.addFilter("visitorId",t.visitorId)}},Object(r["toDisplayString"])(t.visitorId),9,T)]),Object(r["createElementVNode"])("td",I,[Object(r["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddVisitorIPToSearch"),onClick:function(n){return e.addFilter("visitIp",t.visitIp)}},Object(r["toDisplayString"])(t.visitIp),9,L)]),Object(r["createElementVNode"])("td",B,[Object(r["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddUserIdToSearch"),onClick:function(n){return e.addFilter("userId",t.userId)}},Object(r["toDisplayString"])(t.userId),9,x)]),Object(r["createElementVNode"])("td",null,[Object(r["createElementVNode"])("span",{title:"".concat(t.deviceType," ").concat(t.deviceModel),style:{"margin-right":"3.5px"}},[Object(r["createElementVNode"])("img",{height:"16",src:t.deviceTypeIcon},null,8,R)],8,F),Object(r["createElementVNode"])("span",{title:t.operatingSystem,style:{"margin-right":"3.5px"}},[Object(r["createElementVNode"])("img",{height:"16",src:t.operatingSystemIcon},null,8,H)],8,U),Object(r["createElementVNode"])("span",{title:"".concat(t.browser," ").concat(t.browserFamilyDescription),style:{"margin-right":"3.5px"}},[Object(r["createElementVNode"])("img",{height:"16",src:t.browserIcon},null,8,G)],8,q),Object(r["createElementVNode"])("span",{title:"".concat(t.country," ").concat(t.region||"")},[Object(r["createElementVNode"])("img",{height:"16",src:t.countryFlag},null,8,W)],8,K)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("td",null,[Object(r["createElementVNode"])("a",{class:"visitorLogTooltip",title:"View visitor profile",onClick:function(n){return e.showProfile(t.visitorId,t.idSite)}},[J,Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(e.translate("Live_ViewVisitorProfile")),1)],8,Y)],512),[[r["vShow"],e.profileEnabled]])],8,P)})),128))])],512),[[re]]),Object(r["createVNode"])(ne,{class:"exportDataSubjects",style:{"margin-right":"3.5px"},onConfirm:t[5]||(t[5]=function(t){return e.exportDataSubject()}),disabled:!e.hasActiveDataSubjects,value:e.translate("PrivacyManager_ExportSelectedVisits")},null,8,["disabled","value"]),Object(r["createVNode"])(ne,{class:"deleteDataSubjects",onConfirm:t[6]||(t[6]=function(t){return e.deleteDataSubject()}),disabled:!e.hasActiveDataSubjects||e.isDeleting,value:e.translate("PrivacyManager_DeleteSelectedVisits")},null,8,["disabled","value"])],512),[[r["vShow"],e.dataSubjects.length]]),Object(r["createElementVNode"])("div",Q,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_DeleteVisitsConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,X),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Z)],512)])}var te=n("19dc"),ne=n("f06f"),ae=n("a5a2"),oe=Object(r["defineComponent"])({components:{ContentBlock:te["ContentBlock"],SiteSelector:te["SiteSelector"],SegmentGenerator:ne["SegmentGenerator"],SaveButton:ae["SaveButton"],Field:ae["Field"]},directives:{ContentTable:te["ContentTable"]},data:function(){return{isLoading:!1,isDeleting:!1,site:{id:"all",name:Object(te["translate"])("UsersManager_AllWebsites")},segment_filter:"visitId==",dataSubjects:[],toggleAll:!0,hasSearched:!1,profileEnabled:te["Matomo"].visitorProfileEnabled,dataSubjectsActive:[],isVisitorLogAndProfileEnabled:!0,allWebsitesContainsDisabledSite:!1}},created:function(){this.changeSite(this.site)},watch:{site:function(e){var t=this;"all"!==e.id?(this.allWebsitesContainsDisabledSite=!1,this.isLoading=!0,this.dataSubjects=[],this.hasSearched=!1,te["AjaxHelper"].fetch({method:"Live.isVisitorProfileEnabled",idSite:e.id}).then((function(e){t.isVisitorLogAndProfileEnabled=e.value})).finally((function(){t.isLoading=!1}))):this.isVisitorLogAndProfileEnabled=!0}},setup:function(){var e=te["AjaxHelper"].fetch({method:"SitesManager.getSitesIdWithAdminAccess",filter_limit:"-1"});return{getSites:function(){return e}}},methods:{changeSite:function(e){var t=this;te["AjaxHelper"].fetch({module:"API",method:"Live.isVisitorProfileEnabled",filter_limit:-1,idSite:e.id},{createErrorNotification:!1}).then((function(e){e.value||"userId=="!==t.segment_filter?e.value&&"visitId=="===t.segment_filter&&(t.segment_filter="userId=="):t.segment_filter="visitId=="})).catch((function(){t.segment_filter="visitId=="}))},showSuccessNotification:function(e){var t=te["NotificationsStore"].show({message:e,context:"success",id:"manageGdpr",type:"transient"});setTimeout((function(){te["NotificationsStore"].scrollToNotification(t)}),200)},linkTo:function(e){return"?".concat(te["MatomoUrl"].stringify(Object.assign(Object.assign({},te["MatomoUrl"].urlParsed.value),{},{module:"PrivacyManager",action:e})))},toggleActivateAll:function(){this.dataSubjectsActive.fill(this.toggleAll)},showProfile:function(e,t){te["Matomo"].helper.showVisitorProfilePopup(e,t)},exportDataSubject:function(){var e=this,t=this.activatedDataSubjects;te["AjaxHelper"].post({module:"API",method:"PrivacyManager.exportDataSubjects",format:"json",filter_limit:-1},{visits:t}).then((function(t){e.showSuccessNotification(Object(te["translate"])("PrivacyManager_VisitsSuccessfullyExported")),te["Matomo"].helper.sendContentAsDownload("exported_data_subjects.json",JSON.stringify(t))}))},deleteDataSubject:function(){var e=this;te["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteDataSubject,{yes:function(){e.isDeleting=!0;var t=e.activatedDataSubjects;te["AjaxHelper"].post({module:"API",method:"PrivacyManager.deleteDataSubjects",filter_limit:-1},{visits:t}).then((function(){e.dataSubjects=[],e.showSuccessNotification(Object(te["translate"])("PrivacyManager_VisitsSuccessfullyDeleted")),e.findDataSubjects()})).finally((function(){e.isDeleting=!1}))}})},addFilter:function(e,t){this.segment_filter+=",".concat(e,"==").concat(t),this.findDataSubjects()},findDataSubjects:function(){var e=this;this.dataSubjects=[],this.dataSubjectsActive=[],this.isLoading=!0,this.toggleAll=!0,this.hasSearched=!1,this.getSites().then((function(t){var n=e.site.id;"all"!==n||te["Matomo"].hasSuperUserAccess||(n=t,Array.isArray(t)&&(n=t.join(","))),te["AjaxHelper"].fetch({method:"Live.isVisitorProfileEnabled",idSite:n}).then((function(t){e.allWebsitesContainsDisabledSite=!t.value})),te["AjaxHelper"].fetch({idSite:n,module:"API",method:"PrivacyManager.findDataSubjects",segment:e.segment_filter}).then((function(t){e.hasSearched=!0,e.dataSubjectsActive=t.map((function(){return!0})),e.dataSubjects=t})).finally((function(){e.isLoading=!1}))}))}},computed:{hasActiveDataSubjects:function(){return!!this.activatedDataSubjects.length},activatedDataSubjects:function(){var e=this;return this.dataSubjects.filter((function(t,n){return e.dataSubjectsActive[n]})).map((function(e){return{idsite:e.idSite,idvisit:e.idVisit}}))},overviewHintText:function(){return Object(te["translate"])("PrivacyManager_GdprToolsOverviewHint",'<a href="'.concat(this.linkTo("gdprOverview"),'">'),"</a>")}}});oe.render=ee;var re=oe,ie=Object(r["createElementVNode"])("br",null,null,-1),le=Object(r["createElementVNode"])("br",null,null,-1),ce=Object(r["createElementVNode"])("br",null,null,-1),se=Object(r["createElementVNode"])("br",null,null,-1),de={key:0},ue=Object(r["createElementVNode"])("br",null,null,-1),me=Object(r["createElementVNode"])("br",null,null,-1),be={class:"alert-warning alert"};function pe(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("SaveButton"),s=Object(r["resolveDirective"])("form");return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"checkbox",name:"anonymizeIpSettings",title:e.translate("PrivacyManager_UseAnonymizeIp"),modelValue:e.actualEnabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.actualEnabled=t}),"inline-help":e.anonymizeIpEnabledHelp},null,8,["title","modelValue","inline-help"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"radio",name:"maskLength",title:e.translate("PrivacyManager_AnonymizeIpMaskLengtDescription"),modelValue:e.actualMaskLength,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.actualMaskLength=t}),options:e.maskLengthOptions,"inline-help":e.translate("PrivacyManager_GeolocationAnonymizeIpNote")},null,8,["title","modelValue","options","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"radio",name:"useAnonymizedIpForVisitEnrichment",title:e.translate("PrivacyManager_UseAnonymizedIpForVisitEnrichment"),modelValue:e.actualUseAnonymizedIpForVisitEnrichment,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.actualUseAnonymizedIpForVisitEnrichment=t}),options:e.useAnonymizedIpForVisitEnrichmentOptions,"inline-help":e.translate("PrivacyManager_UseAnonymizedIpForVisitEnrichmentNote")},null,8,["title","modelValue","options","inline-help"])])],512),[[r["vShow"],e.actualEnabled]]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"checkbox",name:"anonymizeUserId",title:e.translate("PrivacyManager_PseudonymizeUserId"),modelValue:e.actualAnonymizeUserId,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.actualAnonymizeUserId=t})},{"inline-help":Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_PseudonymizeUserIdNote"))+" ",1),ie,le,Object(r["createElementVNode"])("em",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_PseudonymizeUserIdNote2")),1)]})),_:1},8,["title","modelValue"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"checkbox",name:"anonymizeOrderId",title:e.translate("PrivacyManager_UseAnonymizeOrderId"),modelValue:e.actualAnonymizeOrderId,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.actualAnonymizeOrderId=t}),"inline-help":e.translate("PrivacyManager_AnonymizeOrderIdNote")},null,8,["title","modelValue","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"checkbox",name:"forceCookielessTracking",title:e.translate("PrivacyManager_ForceCookielessTracking"),modelValue:e.actualForceCookielessTracking,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.actualForceCookielessTracking=t})},{"inline-help":Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescription",e.trackerFileName))+" ",1),ce,se,Object(r["createElementVNode"])("em",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescription2")),1),e.trackerWritable?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",de,[ue,me,Object(r["createElementVNode"])("p",be,Object(r["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescriptionNotWritable",e.trackerFileName)),1)]))]})),_:1},8,["title","modelValue"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"select",name:"anonymizeReferrer",title:e.translate("PrivacyManager_AnonymizeReferrer"),modelValue:e.actualAnonymizeReferrer,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.actualAnonymizeReferrer=t}),options:e.referrerAnonymizationOptions,"inline-help":e.translate("PrivacyManager_AnonymizeReferrerNote")},null,8,["title","modelValue","options","inline-help"])]),Object(r["createElementVNode"])("div",null,[e.configRandomisationFeatureFlag?(Object(r["openBlock"])(),Object(r["createBlock"])(l,{key:0,uicontrol:"checkbox",name:"randomizeConfigId",title:e.translate("PrivacyManager_UseRandomizeConfigId"),modelValue:e.actualRandomizeConfigId,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.actualRandomizeConfigId=t}),"inline-help":e.translate("PrivacyManager_RandomizeConfigIdNote")},null,8,["title","modelValue","inline-help"])):Object(r["createCommentVNode"])("",!0)]),Object(r["createVNode"])(c,{onConfirm:t[8]||(t[8]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])],512)),[[s]])}function ge(e){return!0===e||1===e||"1"===e?1:0}var Oe=Object(r["defineComponent"])({props:{anonymizeIpEnabled:Boolean,anonymizeUserId:Boolean,maskLength:{type:Number,required:!0},useAnonymizedIpForVisitEnrichment:[Boolean,String,Number],anonymizeOrderId:Boolean,forceCookielessTracking:Boolean,anonymizeReferrer:String,maskLengthOptions:{type:Array,required:!0},useAnonymizedIpForVisitEnrichmentOptions:{type:Array,required:!0},trackerFileName:{type:String,required:!0},trackerWritable:{type:Boolean,required:!0},referrerAnonymizationOptions:{type:Object,required:!0},randomizeConfigId:Boolean,configRandomisationFeatureFlag:Boolean},components:{Field:ae["Field"],SaveButton:ae["SaveButton"]},directives:{Form:ae["Form"]},data:function(){return{isLoading:!1,actualEnabled:this.anonymizeIpEnabled,actualMaskLength:this.maskLength,actualUseAnonymizedIpForVisitEnrichment:ge(this.useAnonymizedIpForVisitEnrichment),actualAnonymizeUserId:!!this.anonymizeUserId,actualAnonymizeOrderId:!!this.anonymizeOrderId,actualForceCookielessTracking:!!this.forceCookielessTracking,actualAnonymizeReferrer:this.anonymizeReferrer,actualRandomizeConfigId:!!this.randomizeConfigId}},methods:{save:function(){var e=this;this.isLoading=!0,te["AjaxHelper"].post({module:"API",method:"PrivacyManager.setAnonymizeIpSettings"},{anonymizeIPEnable:this.actualEnabled?"1":"0",anonymizeUserId:this.actualAnonymizeUserId?"1":"0",anonymizeOrderId:this.actualAnonymizeOrderId?"1":"0",forceCookielessTracking:this.actualForceCookielessTracking?"1":"0",anonymizeReferrer:this.actualAnonymizeReferrer?this.actualAnonymizeReferrer:"",maskLength:this.actualMaskLength,useAnonymizedIpForVisitEnrichment:this.actualUseAnonymizedIpForVisitEnrichment,randomizeConfigId:this.actualRandomizeConfigId?"1":"0"}).then((function(){var e=te["NotificationsStore"].show({message:Object(te["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"toast"});te["NotificationsStore"].scrollToNotification(e)})).finally((function(){e.isLoading=!1}))}},computed:{anonymizeIpEnabledHelp:function(){var e=Object(te["translate"])("PrivacyManager_AnonymizeIpInlineHelp"),t=Object(te["translate"])("PrivacyManager_AnonymizeIpDescription");return"".concat(e," ").concat(t)}}});Oe.render=pe;var je=Oe,ve={class:"optOutCustomizer"},ye=["innerHTML"],he={key:0,id:"opt-out-styling"},fe=["value"],Ve=["value"],De=["value"],Ne=["value"],Ee=Object(r["createStaticVNode"])('<option value="px">px</option><option value="pt">pt</option><option value="em">em</option><option value="rem">rem</option><option value="%">%</option>',5),Se=[Ee],Ce=["value"],ke=["src"],_e={class:"form-group row"},Pe={class:"col s12 m6"},Me={for:"codeType1"},we={for:"codeType2"},ze={key:0},Ae={class:"col s12 m6"},Te=["innerHTML"],Ie={ref:"pre"},Le=["innerHTML"],Be={class:"system notification notification-info optOutTestReminder"},xe=["innerHTML"];function Fe(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveDirective"])("copy-to-clipboard");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createElementVNode"])("div",ve,[Object(r["createElementVNode"])("p",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("CoreAdminHome_OptOutExplanation"))+" ",1),Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.readThisToLearnMore)},null,8,ye)]),Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutAppearance")),1),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("span",null,[Object(r["createElementVNode"])("label",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{id:"applyStyling",type:"checkbox",name:"applyStyling","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.applyStyling=t}),onKeydown:t[1]||(t[1]=function(t){return e.updateCode()}),onChange:t[2]||(t[2]=function(t){return e.updateCode()})},null,544),[[r["vModelCheckbox"],e.applyStyling]]),Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_ApplyStyling")),1)])])]),e.applyStyling?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",he,[Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_FontColor"))+": ",1),Object(r["createElementVNode"])("input",{type:"color",value:e.fontColor,onKeydown:t[3]||(t[3]=function(t){return e.onFontColorChange(t)}),onChange:t[4]||(t[4]=function(t){return e.onFontColorChange(t)})},null,40,fe)]),Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_BackgroundColor"))+": ",1),Object(r["createElementVNode"])("input",{type:"color",value:e.backgroundColor,onKeydown:t[5]||(t[5]=function(t){return e.onBgColorChange(t)}),onChange:t[6]||(t[6]=function(t){return e.onBgColorChange(t)})},null,40,Ve)]),Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_FontSize"))+": ",1),Object(r["createElementVNode"])("input",{id:"FontSizeInput",type:"number",min:"1",max:"100",value:e.fontSize,onKeydown:t[7]||(t[7]=function(t){return e.onFontSizeChange(t)}),onChange:t[8]||(t[8]=function(t){return e.onFontSizeChange(t)})},null,40,De)]),Object(r["createElementVNode"])("span",null,[Object(r["createElementVNode"])("select",{class:"browser-default",value:e.fontSizeUnit,onKeydown:t[9]||(t[9]=function(t){return e.onFontSizeUnitChange(t)}),onChange:t[10]||(t[10]=function(t){return e.onFontSizeUnitChange(t)})},Se,40,Ne)]),Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_FontFamily"))+": ",1),Object(r["createElementVNode"])("input",{id:"FontFamilyInput",type:"text",value:e.fontFamily,onKeydown:t[11]||(t[11]=function(t){return e.onFontFamilyChange(t)}),onChange:t[12]||(t[12]=function(t){return e.onFontFamilyChange(t)})},null,40,Ce)])])])):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("span",null,[Object(r["createElementVNode"])("label",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{id:"showIntro",type:"checkbox",name:"showIntro","onUpdate:modelValue":t[13]||(t[13]=function(t){return e.showIntro=t}),onKeydown:t[14]||(t[14]=function(t){return e.updateCode()}),onChange:t[15]||(t[15]=function(t){return e.updateCode()})},null,544),[[r["vModelCheckbox"],e.showIntro]]),Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_ShowIntro")),1)])])]),Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutPreview")),1),Object(r["createElementVNode"])("iframe",{id:"previewIframe",style:{border:"1px solid #333",height:"200px",width:"600px"},src:e.iframeUrl,class:Object(r["normalizeClass"])({withBg:e.withBg})},null,10,ke)]),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",_e,[Object(r["createElementVNode"])("div",Pe,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutHtmlCode")),1),Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("label",Me,[Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"radio",id:"codeType1",name:"codeType",value:"tracker","onUpdate:modelValue":t[16]||(t[16]=function(t){return e.codeType=t}),onKeydown:t[17]||(t[17]=function(t){return e.updateCode()}),onChange:t[18]||(t[18]=function(t){return e.updateCode()})},null,544),[[r["vModelRadio"],e.codeType]]),Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutUseTracker")),1)])]),Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("label",we,[Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"radio",id:"codeType2",name:"codeType",value:"selfContained","onUpdate:modelValue":t[19]||(t[19]=function(t){return e.codeType=t}),onKeydown:t[20]||(t[20]=function(t){return e.updateCode()}),onChange:t[21]||(t[21]=function(t){return e.updateCode()})},null,544),[[r["vModelRadio"],e.codeType]]),Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutUseStandalone")),1)])]),"selfContained"===e.codeType?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ze,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"select",name:"language",modelValue:e.language,"onUpdate:modelValue":t[22]||(t[22]=function(t){return e.language=t}),title:e.translate("General_Language"),options:e.languageOptions,onKeydown:t[23]||(t[23]=function(t){return e.updateCode()}),onChange:t[24]||(t[24]=function(t){return e.updateCode()})},null,8,["modelValue","title","options"])])])):Object(r["createCommentVNode"])("",!0)]),Object(r["createElementVNode"])("div",Ae,[Object(r["createElementVNode"])("div",{class:"form-help",innerHTML:e.$sanitize(e.codeTypeHelp)},null,8,Te)])])]),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("pre",Ie,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.codeBox)+"\n      ",1)],512),[[c,{}]])]),Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.optOutExplanationIntro)},null,8,Le),Object(r["createElementVNode"])("div",Be,[Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTest")),1)]),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestBody")),1),Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("ul",null,[Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestStep1")),1),Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestStep2")),1),Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestStep3")),1),Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestStep4")),1)])])]),Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_BuildYourOwn")),1),Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.optOutCustomOptOutLink)},null,8,xe)])],64)}function Re(e){var t=parseInt(e,16),n=t>>16&255,a=t>>8&255,o=255&t;return n>=225&&a>=225&&o>=225}var Ue=window,He=Ue.$,qe=Object(r["defineComponent"])({props:{currentLanguageCode:{type:String,required:!0},languageOptions:{type:Object,required:!0},matomoUrl:String},components:{Field:ae["Field"]},directives:{CopyToClipboard:te["CopyToClipboard"]},data:function(){return{fontSizeUnit:"px",backgroundColor:"#FFFFFF",fontColor:"#000000",fontSize:"12",fontFamily:"Arial",showIntro:!0,applyStyling:!1,codeType:"tracker",code:"",language:this.currentLanguageCode}},created:function(){this.onFontColorChange=Object(te["debounce"])(this.onFontColorChange,50),this.onBgColorChange=Object(te["debounce"])(this.onBgColorChange,50),this.onFontSizeChange=Object(te["debounce"])(this.onFontSizeChange,50),this.onFontSizeUnitChange=Object(te["debounce"])(this.onFontSizeUnitChange,50),this.onFontFamilyChange=Object(te["debounce"])(this.onFontFamilyChange,50),this.matomoUrl&&this.updateCode()},methods:{onFontColorChange:function(e){this.fontColor=e.target.value,this.updateCode()},onBgColorChange:function(e){this.backgroundColor=e.target.value,this.updateCode()},onFontSizeChange:function(e){this.fontSize=e.target.value,this.updateCode()},onFontSizeUnitChange:function(e){this.fontSizeUnit=e.target.value,this.updateCode()},onFontFamilyChange:function(e){this.fontFamily=e.target.value,this.updateCode()},updateCode:function(){var e=this,t="CoreAdminHome.getOptOutJSEmbedCode";"selfContained"===this.codeType&&(t="CoreAdminHome.getOptOutSelfContainedEmbedCode"),te["AjaxHelper"].fetch({method:t,backgroundColor:this.backgroundColor.substr(1),fontColor:this.fontColor.substr(1),fontSize:this.fontSizeWithUnit,fontFamily:this.fontFamily,showIntro:!0===this.showIntro?1:0,applyStyling:!0===this.applyStyling?1:0,matomoUrl:this.matomoUrl,language:"selfContained"===this.codeType?this.language:"auto"}).then((function(t){e.code=t.value||""}))}},watch:{codeBox:function(){var e=this.$refs.pre,t=He(e).queue("fx").length>0;t||He(e).effect("highlight",{},1500)}},computed:{fontSizeWithUnit:function(){return this.fontSize?"".concat(this.fontSize).concat(this.fontSizeUnit):""},withBg:function(){return!!this.matomoUrl&&""===this.backgroundColor&&""!==this.fontColor&&Re(this.fontColor.slice(1))},codeBox:function(){return this.matomoUrl?this.code:""},iframeUrl:function(){var e=te["MatomoUrl"].stringify({module:"CoreAdminHome",action:"optOut",language:this.language,backgroundColor:this.backgroundColor.substr(1),fontColor:this.fontColor.substr(1),fontSize:this.fontSizeWithUnit,fontFamily:this.fontFamily,applyStyling:!0===this.applyStyling?1:0,showIntro:!0===this.showIntro?1:0});return"".concat(this.matomoUrl,"index.php?").concat(e)},readThisToLearnMore:function(){return Object(te["translate"])("General_ReadThisToLearnMore",Object(te["externalLink"])("https://matomo.org/faq/how-to/faq_25918/"),"</a>")},optOutExplanationIntro:function(){return Object(te["translate"])("CoreAdminHome_OptOutExplanationIntro",'<a href="'.concat(this.iframeUrl,'" rel="noreferrer noopener" target="_blank">'),"</a>")},optOutCustomOptOutLink:function(){var e="https://developer.matomo.org/guides/tracking-javascript-guide#optional-creating-a-custom-opt-out-form";return Object(te["translate"])("CoreAdminHome_OptOutCustomOptOutLink",Object(te["externalLink"])(e),"</a>")},codeTypeHelp:function(){return Object(te["translate"])("PrivacyManager_OptOutCodeTypeExplanation")}}});qe.render=Fe;var Ge=qe,$e={class:"anonymizeLogData"},Ke={class:"form-group row"},We={class:"col s12 input-field"},Ye={for:"anonymizeSite",class:"siteSelectorLabel"},Je={class:"sites_autocomplete"},Qe={class:"form-group row"},Xe={class:"col s6 input-field"},Ze={for:"anonymizeStartDate",class:"active"},et=["value"],tt={class:"col s6 input-field"},nt={for:"anonymizeEndDate",class:"active"},at=["value"],ot={name:"anonymizeIp"},rt={name:"anonymizeLocation"},it={name:"anonymizeTheUserId"},lt={class:"form-group row"},ct={class:"col s12 m6"},st={for:"visit_columns"},dt={class:"innerFormField",name:"visit_columns"},ut=["onClick","title"],mt={class:"col s12 m6"},bt={class:"form-help"},pt={class:"inline-help"},gt={class:"form-group row"},Ot={class:"col s12"},jt={class:"form-group row"},vt={class:"col s12 m6"},yt={for:"action_columns"},ht={class:"innerFormField",name:"action_columns"},ft=["onClick","title"],Vt={class:"col s12 m6"},Dt={class:"form-help"},Nt={class:"inline-help"},Et=Object(r["createElementVNode"])("span",{class:"icon-info"},null,-1);function St(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("SiteSelector"),c=Object(r["resolveComponent"])("Field"),s=Object(r["resolveComponent"])("SaveButton"),d=Object(r["resolveComponent"])("PasswordConfirmation");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",$e,[Object(r["createElementVNode"])("div",Ke,[Object(r["createElementVNode"])("div",We,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",Ye,Object(r["toDisplayString"])(e.translate("PrivacyManager_AnonymizeSites")),1),Object(r["createElementVNode"])("div",Je,[Object(r["createVNode"])(l,{id:"anonymizeSite",modelValue:e.site,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.site=t}),"show-all-sites-item":!0,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["modelValue"])])])])]),Object(r["createElementVNode"])("div",Qe,[Object(r["createElementVNode"])("div",Xe,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",Ze,Object(r["toDisplayString"])(e.translate("PrivacyManager_AnonymizeRowDataFrom")),1),Object(r["createElementVNode"])("input",{type:"text",id:"anonymizeStartDate",class:"anonymizeStartDate",ref:"anonymizeStartDate",name:"anonymizeStartDate",value:e.startDate,onKeydown:t[1]||(t[1]=function(t){return e.onKeydownStartDate(t)}),onChange:t[2]||(t[2]=function(t){return e.onKeydownStartDate(t)})},null,40,et)])]),Object(r["createElementVNode"])("div",tt,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",nt,Object(r["toDisplayString"])(e.translate("PrivacyManager_AnonymizeRowDataTo")),1),Object(r["createElementVNode"])("input",{type:"text",class:"anonymizeEndDate",id:"anonymizeEndDate",ref:"anonymizeEndDate",name:"anonymizeEndDate",value:e.endDate,onKeydown:t[3]||(t[3]=function(t){return e.onKeydownEndDate(t)}),onChange:t[4]||(t[4]=function(t){return e.onKeydownEndDate(t)})},null,40,at)])])]),Object(r["createElementVNode"])("div",ot,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeIp",title:e.translate("PrivacyManager_AnonymizeIp"),modelValue:e.anonymizeIp,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.anonymizeIp=t}),introduction:e.translate("General_Visit"),"inline-help":e.translate("PrivacyManager_AnonymizeIpHelp")},null,8,["title","modelValue","introduction","inline-help"])]),Object(r["createElementVNode"])("div",rt,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeLocation",title:e.translate("PrivacyManager_AnonymizeLocation"),modelValue:e.anonymizeLocation,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.anonymizeLocation=t}),"inline-help":e.translate("PrivacyManager_AnonymizeLocationHelp")},null,8,["title","modelValue","inline-help"])]),Object(r["createElementVNode"])("div",it,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeTheUserId",title:e.translate("PrivacyManager_AnonymizeUserId"),modelValue:e.anonymizeUserId,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.anonymizeUserId=t}),"inline-help":e.translate("PrivacyManager_AnonymizeUserIdHelp")},null,8,["title","modelValue","inline-help"])]),Object(r["createElementVNode"])("div",lt,[Object(r["createElementVNode"])("div",ct,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",st,Object(r["toDisplayString"])(e.translate("PrivacyManager_UnsetVisitColumns")),1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.selectedVisitColumns,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])("selectedVisitColumns selectedVisitColumns".concat(n," multiple valign-wrapper")),key:n},[Object(r["createElementVNode"])("div",dt,[Object(r["createVNode"])(c,{uicontrol:"select",name:"visit_columns","model-value":t.column,"onUpdate:modelValue":function(n){t.column=n,e.onVisitColumnChange()},"full-width":!0,options:e.availableVisitColumns},null,8,["model-value","onUpdate:modelValue","options"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-minus valign",onClick:function(t){return e.removeVisitColumn(n)},title:e.translate("General_Remove")},null,8,ut),[[r["vShow"],n+1!==e.selectedVisitColumns.length]])],2)})),128))])]),Object(r["createElementVNode"])("div",mt,[Object(r["createElementVNode"])("div",bt,[Object(r["createElementVNode"])("span",pt,Object(r["toDisplayString"])(e.translate("PrivacyManager_UnsetVisitColumnsHelp")),1)])])]),Object(r["createElementVNode"])("div",gt,[Object(r["createElementVNode"])("div",Ot,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("General_Action")),1)])]),Object(r["createElementVNode"])("div",jt,[Object(r["createElementVNode"])("div",vt,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",yt,Object(r["toDisplayString"])(e.translate("PrivacyManager_UnsetActionColumns")),1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.selectedActionColumns,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])("selectedActionColumns selectedActionColumns".concat(n," multiple valign-wrapper")),key:n},[Object(r["createElementVNode"])("div",ht,[Object(r["createVNode"])(c,{uicontrol:"select",name:"action_columns","model-value":t.column,"onUpdate:modelValue":function(n){t.column=n,e.onActionColumnChange()},"full-width":!0,options:e.availableActionColumns},null,8,["model-value","onUpdate:modelValue","options"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-minus valign",onClick:function(t){return e.removeActionColumn(n)},title:e.translate("General_Remove")},null,8,ft),[[r["vShow"],n+1!==e.selectedActionColumns.length]])],2)})),128))])]),Object(r["createElementVNode"])("div",Vt,[Object(r["createElementVNode"])("div",Dt,[Object(r["createElementVNode"])("span",Nt,Object(r["toDisplayString"])(e.translate("PrivacyManager_UnsetActionColumnsHelp")),1)])])]),Object(r["createElementVNode"])("p",null,[Et,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_AnonymizeProcessInfo")),1)]),Object(r["createVNode"])(s,{class:"anonymizePastData",onConfirm:t[8]||(t[8]=function(t){return e.showPasswordConfirmModal=!0}),disabled:e.isAnonymizePastDataDisabled,value:e.translate("PrivacyManager_AnonymizeDataNow")},null,8,["disabled","value"]),Object(r["createVNode"])(d,{modelValue:e.showPasswordConfirmModal,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.showPasswordConfirmModal=t}),onConfirmed:e.scheduleAnonymization},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_AnonymizeDataConfirm")),1)]})),_:1},8,["modelValue","onConfirmed"])])}function Ct(e){return e<10?"0".concat(e):e}var kt=Object(r["defineComponent"])({components:{PasswordConfirmation:ae["PasswordConfirmation"],SiteSelector:te["SiteSelector"],Field:ae["Field"],SaveButton:ae["SaveButton"]},data:function(){var e=new Date,t="".concat(e.getFullYear(),"-").concat(Ct(e.getMonth()+1),"-").concat(Ct(e.getDay()+1));return{isLoading:!1,isDeleting:!1,anonymizeIp:!1,anonymizeLocation:!1,anonymizeUserId:!1,site:{id:"all",name:"All Websites"},availableVisitColumns:[],availableActionColumns:[],selectedVisitColumns:[{column:""}],selectedActionColumns:[{column:""}],startDate:t,endDate:t,showPasswordConfirmModal:!1}},created:function(){var e=this;this.onKeydownStartDate=Object(te["debounce"])(this.onKeydownStartDate,50),this.onKeydownEndDate=Object(te["debounce"])(this.onKeydownEndDate,50),te["AjaxHelper"].fetch({method:"PrivacyManager.getAvailableVisitColumnsToAnonymize"}).then((function(t){e.availableVisitColumns=[],t.forEach((function(t){e.availableVisitColumns.push({key:t.column_name,value:t.column_name})}))})),te["AjaxHelper"].fetch({method:"PrivacyManager.getAvailableLinkVisitActionColumnsToAnonymize"}).then((function(t){e.availableActionColumns=[],t.forEach((function(t){e.availableActionColumns.push({key:t.column_name,value:t.column_name})}))})),setTimeout((function(){var t=te["Matomo"].getBaseDatePickerOptions(null),n=te["Matomo"].getBaseDatePickerOptions(null);$(e.$refs.anonymizeStartDate).datepicker(t),$(e.$refs.anonymizeEndDate).datepicker(n)}))},methods:{onVisitColumnChange:function(){var e=this.selectedVisitColumns.every((function(e){return!(null===e||void 0===e||!e.column)}));e&&this.addVisitColumn()},addVisitColumn:function(){this.selectedVisitColumns.push({column:""})},removeVisitColumn:function(e){if(e>-1){var t=this.selectedVisitColumns.length-1;t===e?this.selectedVisitColumns[e]={column:""}:this.selectedVisitColumns.splice(e,1)}},onActionColumnChange:function(){var e=this.selectedActionColumns.every((function(e){return!(null===e||void 0===e||!e.column)}));e&&this.addActionColumn()},addActionColumn:function(){this.selectedActionColumns.push({column:""})},removeActionColumn:function(e){if(e>-1){var t=this.selectedActionColumns.length-1;t===e?this.selectedActionColumns[e]={column:""}:this.selectedActionColumns.splice(e,1)}},scheduleAnonymization:function(e){var t="".concat(this.startDate,",").concat(this.endDate);this.startDate===this.endDate&&(t=this.startDate);var n={date:t};n.idSites=this.site.id,n.anonymizeIp=this.anonymizeIp?"1":"0",n.anonymizeLocation=this.anonymizeLocation?"1":"0",n.anonymizeUserId=this.anonymizeUserId?"1":"0",n.unsetVisitColumns=this.selectedVisitColumns.filter((function(e){return!(null===e||void 0===e||!e.column)})).map((function(e){return e.column})),n.unsetLinkVisitActionColumns=this.selectedActionColumns.filter((function(e){return!(null===e||void 0===e||!e.column)})).map((function(e){return e.column})),n.passwordConfirmation=e,te["AjaxHelper"].post({method:"PrivacyManager.anonymizeSomeRawData"},n).then((function(){window.location.reload(!0)}))},onKeydownStartDate:function(e){this.startDate=e.target.value},onKeydownEndDate:function(e){this.endDate=e.target.value}},computed:{isAnonymizePastDataDisabled:function(){return!this.anonymizeIp&&!this.anonymizeLocation&&!this.selectedVisitColumns&&!this.selectedActionColumns}}});kt.render=St;var _t=kt;function Pt(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("SaveButton"),s=Object(r["resolveDirective"])("form");return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"radio",name:"doNotTrack",modelValue:e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.enabled=t}),options:e.doNotTrackOptions,"inline-help":e.translate("PrivacyManager_DoNotTrack_Description")},null,8,["modelValue","options","inline-help"])]),Object(r["createVNode"])(c,{onConfirm:t[1]||(t[1]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])],512)),[[s]])}var Mt=Object(r["defineComponent"])({props:{dntSupport:Boolean,doNotTrackOptions:{type:Array,required:!0}},components:{Field:ae["Field"],SaveButton:ae["SaveButton"]},directives:{Form:ae["Form"]},data:function(){return{isLoading:!1,enabled:this.dntSupport?1:0}},methods:{save:function(){var e=this;this.isLoading=!0;var t="deactivateDoNotTrack";this.enabled&&"0"!==this.enabled&&(t="activateDoNotTrack"),te["AjaxHelper"].post({module:"API",method:"PrivacyManager.".concat(t)}).then((function(){var e=te["NotificationsStore"].show({message:Object(te["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"transient"});te["NotificationsStore"].scrollToNotification(e)})).finally((function(){e.isLoading=!1}))}}});Mt.render=Pt;var wt=Mt;function zt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function At(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Tt(e,t,n){return t&&At(e.prototype,t),n&&At(e,n),e}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Lt=function(){function e(){var t=this;zt(this,e),It(this,"privateState",Object(r["reactive"])({settings:{},showEstimate:!1,loadingEstimation:!1,estimation:"",isModified:!1})),It(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),It(this,"enableDeleteReports",Object(r["computed"])((function(){return t.state.value.settings.enableDeleteReports}))),It(this,"enableDeleteLogs",Object(r["computed"])((function(){return t.state.value.settings.enableDeleteLogs}))),It(this,"currentRequest",void 0)}return Tt(e,[{key:"updateSettings",value:function(e){this.initSettings(e),this.privateState.isModified=!0}},{key:"initSettings",value:function(e){this.privateState.settings=Object.assign(Object.assign({},this.privateState.settings),e),this.reloadDbStats()}},{key:"savePurgeDataSettings",value:function(e,t,n){return this.privateState.isModified=!1,te["AjaxHelper"].post({module:"API",method:e},Object.assign(Object.assign({},t),{},{enableDeleteLogs:t.enableDeleteLogs?"1":"0",enableDeleteReports:t.enableDeleteReports?"1":"0",passwordConfirmation:n})).then((function(){var e=te["NotificationsStore"].show({message:Object(te["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"toast"});te["NotificationsStore"].scrollToNotification(e)}))}},{key:"isEitherDeleteSectionEnabled",value:function(){return this.state.value.settings.enableDeleteLogs||this.state.value.settings.enableDeleteReports}},{key:"isManualEstimationLinkShowing",value:function(){return window.$("#getPurgeEstimateLink").length>0}},{key:"reloadDbStats",value:function(e){var t=this;if(this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=void 0),e||this.isEitherDeleteSectionEnabled()&&!this.isManualEstimationLinkShowing()){this.privateState.loadingEstimation=!0,this.privateState.estimation="",this.privateState.showEstimate=!1;var n=this.privateState.settings,a=Object.assign(Object.assign({},n),{},{enableDeleteLogs:n.enableDeleteLogs?"1":"0",enableDeleteReports:n.enableDeleteReports?"1":"0"});!0===e&&(a.forceEstimate=1),this.currentRequest=new AbortController,te["AjaxHelper"].post({module:"PrivacyManager",action:"getDatabaseSize",format:"html"},a,{abortController:this.currentRequest,format:"html"}).then((function(e){t.privateState.estimation=e,t.privateState.showEstimate=!0,t.privateState.loadingEstimation=!1})).finally((function(){t.currentRequest=void 0,t.privateState.loadingEstimation=!1}))}}}]),e}(),Bt=new Lt,xt={id:"formDeleteSettings"},Ft={id:"deleteLogSettingEnabled"},Rt={class:"alert alert-warning deleteOldLogsWarning",style:{width:"50%"}},Ut=["href"],Ht={id:"deleteLogSettings"},qt={key:0},Gt={key:1};function $t(e,t,n,a,o,i){var l=this,c=Object(r["resolveComponent"])("Field"),s=Object(r["resolveComponent"])("SaveButton"),d=Object(r["resolveComponent"])("PasswordConfirmation"),u=Object(r["resolveDirective"])("form");return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",xt,[Object(r["createElementVNode"])("div",Ft,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteEnable","model-value":e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.enabled=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_UseDeleteLog"),"inline-help":e.translate("PrivacyManager_DeleteRawDataInfo")},null,8,["model-value","title","inline-help"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Rt,[Object(r["createElementVNode"])("a",{href:e.externalRawLink("https://matomo.org/faq/general/faq_125"),rel:"noreferrer noopener",target:"_blank"},Object(r["toDisplayString"])(e.translate("General_ClickHere")),9,Ut)],512),[[r["vShow"],e.enabled]])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Ht,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"text",name:"deleteOlderThan","model-value":e.deleteOlderThan,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.deleteOlderThan=t,e.reloadDbStats()}),title:e.deleteOlderThanTitle,"inline-help":e.translate("PrivacyManager_LeastDaysInput","1")},null,8,["model-value","title","inline-help"])])],512),[[r["vShow"],e.enabled]]),Object(r["createVNode"])(s,{onConfirm:t[2]||(t[2]=function(e){return l.showPasswordConfirmModal=!0}),saving:e.isLoading},null,8,["saving"]),Object(r["createVNode"])(d,{modelValue:e.showPasswordConfirmModal,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.showPasswordConfirmModal=t}),onConfirmed:e.saveSettings},{default:Object(r["withCtx"])((function(){return[e.enabled&&!e.enableDeleteReports?(Object(r["openBlock"])(),Object(r["createElementBlock"])("h2",qt,Object(r["toDisplayString"])(e.translate("PrivacyManager_DeleteLogsConfirm")),1)):Object(r["createCommentVNode"])("",!0),e.enabled&&e.enableDeleteReports?(Object(r["openBlock"])(),Object(r["createElementBlock"])("h2",Gt,Object(r["toDisplayString"])(e.translate("PrivacyManager_DeleteBothConfirm")),1)):Object(r["createCommentVNode"])("",!0)]})),_:1},8,["modelValue","onConfirmed"])],512)),[[u]])}var Kt=Object(r["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{PasswordConfirmation:ae["PasswordConfirmation"],Field:ae["Field"],SaveButton:ae["SaveButton"]},directives:{Form:ae["Form"]},data:function(){return{isLoading:!1,enabled:1===parseInt(this.deleteData.config.delete_logs_enable,10),deleteOlderThan:this.deleteData.config.delete_logs_older_than,showPasswordConfirmModal:!1}},created:function(){var e=this;setTimeout((function(){Bt.initSettings(e.settings)}))},methods:{saveSettings:function(e){var t=this,n="PrivacyManager.setDeleteLogsSettings";this.isLoading=!0,Bt.savePurgeDataSettings(n,this.settings,e).finally((function(){t.isLoading=!1}))},reloadDbStats:function(){Bt.updateSettings(this.settings)}},computed:{settings:function(){return{enableDeleteLogs:!!this.enabled,deleteLogsOlderThan:this.deleteOlderThan}},deleteOlderThanTitle:function(){return"".concat(Object(te["translate"])("PrivacyManager_DeleteLogsOlderThan")," (").concat(Object(te["translate"])("Intl_PeriodDays"),")")},enableDeleteReports:function(){return!!Bt.enableDeleteReports.value}}});Kt.render=$t;var Wt=Kt,Yt={id:"formDeleteSettings"},Jt={id:"deleteReportsSettingEnabled"},Qt={class:"alert alert-warning",style:{width:"50%"}},Xt=Object(r["createElementVNode"])("br",null,null,-1),Zt=Object(r["createElementVNode"])("br",null,null,-1),en={id:"deleteReportsSettings"},tn={key:0},nn={key:1};function an(e,t,n,a,o,i){var l=this,c=Object(r["resolveComponent"])("Field"),s=Object(r["resolveComponent"])("SaveButton"),d=Object(r["resolveComponent"])("PasswordConfirmation"),u=Object(r["resolveDirective"])("form");return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Yt,[Object(r["createElementVNode"])("div",Jt,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteReportsEnable","model-value":e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.enabled=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_UseDeleteReports"),"inline-help":e.translate("PrivacyManager_DeleteAggregateReportsDetailedInfo")},null,8,["model-value","title","inline-help"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Qt,[Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_DeleteReportsInfo2",e.deleteOldLogsText)),1),Xt,Zt,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_DeleteReportsInfo3",e.deleteOldLogsText)),1)])],512),[[r["vShow"],e.enabled]])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",en,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"text",name:"deleteReportsOlderThan","model-value":e.deleteOlderThan,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.deleteOlderThan=t,e.reloadDbStats()}),title:e.deleteReportsOlderThanTitle,"inline-help":e.translate("PrivacyManager_LeastMonthsInput","1")},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteReportsKeepBasic","model-value":e.keepBasic,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.keepBasic=t,e.reloadDbStats()}),title:e.deleteReportsKeepBasicTitle,"inline-help":e.translate("PrivacyManager_KeepBasicMetricsReportsDetailedInfo")},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_KeepDataFor")),1),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteReportsKeepDay","model-value":e.keepDataForDay,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.keepDataForDay=t,e.reloadDbStats()}),title:e.translate("General_DailyReports")},null,8,["model-value","title"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteReportsKeepWeek","model-value":e.keepDataForWeek,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.keepDataForWeek=t,e.reloadDbStats()}),title:e.translate("General_WeeklyReports")},null,8,["model-value","title"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteReportsKeepMonth","model-value":e.keepDataForMonth,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.keepDataForMonth=t,e.reloadDbStats()}),title:"".concat(e.translate("General_MonthlyReports")," (").concat(e.translate("General_Recommended"),")")},null,8,["model-value","title"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteReportsKeepYear","model-value":e.keepDataForYear,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.keepDataForYear=t,e.reloadDbStats()}),title:"".concat(e.translate("General_YearlyReports")," (").concat(e.translate("General_Recommended"),")")},null,8,["model-value","title"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteReportsKeepRange","model-value":e.keepDataForRange,"onUpdate:modelValue":t[7]||(t[7]=function(t){e.keepDataForRange=t,e.reloadDbStats()}),title:e.translate("General_RangeReports")},null,8,["model-value","title"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"checkbox",name:"deleteReportsKeepSegments","model-value":e.keepDataForSegments,"onUpdate:modelValue":t[8]||(t[8]=function(t){e.keepDataForSegments=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_KeepReportSegments")},null,8,["model-value","title"])])])],512),[[r["vShow"],e.enabled]]),Object(r["createVNode"])(s,{onConfirm:t[9]||(t[9]=function(e){return l.showPasswordConfirmModal=!0}),saving:e.isLoading},null,8,["saving"]),Object(r["createVNode"])(d,{modelValue:e.showPasswordConfirmModal,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.showPasswordConfirmModal=t}),onConfirmed:e.saveSettings},{default:Object(r["withCtx"])((function(){return[e.enabled&&!e.enableDeleteLogs?(Object(r["openBlock"])(),Object(r["createElementBlock"])("h2",tn,Object(r["toDisplayString"])(e.translate("PrivacyManager_DeleteReportsConfirm")),1)):Object(r["createCommentVNode"])("",!0),e.enabled&&e.enableDeleteLogs?(Object(r["openBlock"])(),Object(r["createElementBlock"])("h2",nn,Object(r["toDisplayString"])(e.translate("PrivacyManager_DeleteBothConfirm")),1)):Object(r["createCommentVNode"])("",!0)]})),_:1},8,["modelValue","onConfirmed"])],512)),[[u]])}function on(e){return e?"1":"0"}var rn=Object(r["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{Field:ae["Field"],SaveButton:ae["SaveButton"],PasswordConfirmation:ae["PasswordConfirmation"]},directives:{Form:ae["Form"]},data:function(){return{isLoading:!1,enabled:1===parseInt(this.deleteData.config.delete_reports_enable,10),deleteOlderThan:this.deleteData.config.delete_reports_older_than,keepBasic:1===parseInt(this.deleteData.config.delete_reports_keep_basic_metrics,10),keepDataForDay:1===parseInt(this.deleteData.config.delete_reports_keep_day_reports,10),keepDataForWeek:1===parseInt(this.deleteData.config.delete_reports_keep_week_reports,10),keepDataForMonth:1===parseInt(this.deleteData.config.delete_reports_keep_month_reports,10),keepDataForYear:1===parseInt(this.deleteData.config.delete_reports_keep_year_reports,10),keepDataForRange:1===parseInt(this.deleteData.config.delete_reports_keep_range_reports,10),keepDataForSegments:1===parseInt(this.deleteData.config.delete_reports_keep_segment_reports,10),showPasswordConfirmModal:!1}},created:function(){var e=this;setTimeout((function(){Bt.initSettings(e.settings)}))},methods:{saveSettings:function(e){var t=this,n="PrivacyManager.setDeleteReportsSettings";this.isLoading=!0,Bt.savePurgeDataSettings(n,this.settings,e).finally((function(){t.isLoading=!1}))},reloadDbStats:function(){Bt.updateSettings(this.settings)}},computed:{settings:function(){return{enableDeleteReports:this.enabled,deleteReportsOlderThan:this.deleteOlderThan,keepBasic:on(this.keepBasic),keepDay:on(this.keepDataForDay),keepWeek:on(this.keepDataForWeek),keepMonth:on(this.keepDataForMonth),keepYear:on(this.keepDataForYear),keepRange:on(this.keepDataForRange),keepSegments:on(this.keepDataForSegments)}},deleteOldLogsText:function(){return Object(te["translate"])("PrivacyManager_UseDeleteLog")},deleteReportsOlderThanTitle:function(){var e=Object(te["translate"])("PrivacyManager_DeleteReportsOlderThan");return"".concat(e," (").concat(Object(te["translate"])("Intl_PeriodMonths"),")")},deleteReportsKeepBasicTitle:function(){var e=Object(te["translate"])("PrivacyManager_KeepBasicMetrics");return"".concat(e," (").concat(Object(te["translate"])("General_Recommended"),")")},enableDeleteLogs:function(){return!!Bt.enableDeleteLogs.value}}});rn.render=an;var ln=rn,cn={id:"formDeleteSettings"},sn={id:"deleteSchedulingSettings"},dn={id:"deleteSchedulingSettingsInlineHelp",class:"inline-help-node"},un={key:0},mn=Object(r["createElementVNode"])("br",null,null,-1),bn=Object(r["createElementVNode"])("br",null,null,-1),pn=Object(r["createElementVNode"])("br",null,null,-1),gn=Object(r["createElementVNode"])("br",null,null,-1),On={key:0,id:"deleteDataEstimateSect",class:"form-group row"},jn={class:"col s12",id:"databaseSizeHeadline"},vn={class:"col s12 m6"},yn=["innerHTML"],hn=Object(r["createTextVNode"])(""),fn={class:"col s12 m6"},Vn={key:0,class:"form-help"},Dn={class:"ui-confirm",id:"saveSettingsBeforePurge"},Nn=["value"];function En(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("ActivityIndicator"),c=Object(r["resolveComponent"])("Field"),s=Object(r["resolveComponent"])("SaveButton"),d=Object(r["resolveComponent"])("PasswordConfirmation"),u=Object(r["resolveComponent"])("ContentBlock"),m=Object(r["resolveDirective"])("form");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",cn,[Object(r["withDirectives"])(Object(r["createVNode"])(u,{id:"scheduleSettingsHeadline","content-title":e.translate("PrivacyManager_DeleteSchedulingSettings")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",sn,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"select",name:"deleteLowestInterval",title:e.translate("PrivacyManager_DeleteDataInterval"),modelValue:e.deleteLowestInterval,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.deleteLowestInterval=t}),options:e.scheduleDeletionOptions},{"inline-help":Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",dn,[e.deleteData.lastRun?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",un,[Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_LastDelete"))+":",1),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.deleteData.lastRunPretty)+" ",1),mn,bn])):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_NextDelete"))+":",1),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.deleteData.nextRunPretty)+" ",1),pn,gn,Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{id:"purgeDataNowLink",href:"#",onClick:t[0]||(t[0]=Object(r["withModifiers"])((function(t){return e.executeDataPurge()}),["prevent"]))},Object(r["toDisplayString"])(e.translate("PrivacyManager_PurgeNow")),513),[[r["vShow"],e.showPurgeNowLink]]),Object(r["createVNode"])(l,{"loading-message":e.translate("PrivacyManager_PurgingData"),loading:e.loadingDataPurge},null,8,["loading-message","loading"]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{id:"db-purged-message"},Object(r["toDisplayString"])(e.translate("PrivacyManager_DBPurged")),513),[[r["vShow"],e.dataWasPurged]])])]})),_:1},8,["title","modelValue","options"])])]),"1"===e.deleteData.config.enable_database_size_estimate||1===e.deleteData.config.enable_database_size_estimate?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",On,[Object(r["createElementVNode"])("h3",jn,Object(r["toDisplayString"])(e.translate("PrivacyManager_ReportsDataSavedEstimate")),1),Object(r["createElementVNode"])("div",vn,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{id:"deleteDataEstimate",innerHTML:e.$sanitize(e.estimation)},null,8,yn),[[r["vShow"],e.showEstimate]]),hn,Object(r["createVNode"])(l,{loading:e.loadingEstimation},null,8,["loading"])]),Object(r["createElementVNode"])("div",fn,["1"!==e.deleteData.config.enable_auto_database_size_estimate&&1!==e.deleteData.config.enable_auto_database_size_estimate?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Vn,[Object(r["createElementVNode"])("a",{id:"getPurgeEstimateLink",href:"#",onClick:t[2]||(t[2]=Object(r["withModifiers"])((function(t){return e.getPurgeEstimate()}),["prevent"]))},Object(r["toDisplayString"])(e.translate("PrivacyManager_GetPurgeEstimate")),1)])):Object(r["createCommentVNode"])("",!0)])])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(s,{onConfirm:t[3]||(t[3]=function(t){return e.showPasswordConfirmModal=!0}),saving:e.isLoading},null,8,["saving"]),Object(r["createVNode"])(d,{modelValue:e.showPasswordConfirmModal,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.showPasswordConfirmModal=t}),onConfirmed:e.save},null,8,["modelValue","onConfirmed"]),Object(r["createVNode"])(d,{modelValue:e.showPasswordConfirmModalForPurge,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.showPasswordConfirmModalForPurge=t}),onConfirmed:e.executePurgeNow},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_PurgeNowConfirm")),1)]})),_:1},8,["modelValue","onConfirmed"])]})),_:1},8,["content-title"]),[[r["vShow"],e.isEitherDeleteSectionEnabled]])],512),[[m]]),Object(r["createElementVNode"])("div",Dn,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_SaveSettingsBeforePurge")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Ok")},null,8,Nn)])],64)}var Sn=Object(r["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{ContentBlock:te["ContentBlock"],ActivityIndicator:te["ActivityIndicator"],Field:ae["Field"],SaveButton:ae["SaveButton"],PasswordConfirmation:ae["PasswordConfirmation"]},directives:{Form:ae["Form"]},data:function(){return{isLoading:!1,loadingDataPurge:!1,dataWasPurged:!1,showPurgeNowLink:!0,deleteLowestInterval:this.deleteData.config.delete_logs_schedule_lowest_interval,showPasswordConfirmModal:!1,showPasswordConfirmModalForPurge:!1}},methods:{save:function(e){var t="PrivacyManager.setScheduleReportDeletionSettings";Bt.savePurgeDataSettings(t,{deleteLowestInterval:this.deleteLowestInterval},e)},executeDataPurge:function(){Bt.state.value.isModified?te["Matomo"].helper.modalConfirm("#saveSettingsBeforePurge",{yes:function(){return null}}):this.showPasswordConfirmModalForPurge=!0},getPurgeEstimate:function(){return Bt.reloadDbStats(!0)},executePurgeNow:function(e){var t=this;return this.loadingDataPurge=!0,this.showPurgeNowLink=!1,te["AjaxHelper"].post({module:"API",method:"PrivacyManager.executeDataPurge"},{passwordConfirmation:e}).then((function(){Bt.reloadDbStats(),t.dataWasPurged=!0,setTimeout((function(){t.dataWasPurged=!1,t.showPurgeNowLink=!0}),2e3)})).catch((function(){t.showPurgeNowLink=!0})).finally((function(){t.loadingDataPurge=!1}))}},computed:{showEstimate:function(){return Bt.state.value.showEstimate},isEitherDeleteSectionEnabled:function(){return Bt.isEitherDeleteSectionEnabled()},estimation:function(){return Bt.state.value.estimation},loadingEstimation:function(){return Bt.state.value.loadingEstimation}}});Sn.render=En;var Cn=Sn,kn=["innerHTML"],_n=["innerHTML"],Pn=["innerHTML"],Mn=Object(r["createElementVNode"])("br",null,null,-1),wn=Object(r["createElementVNode"])("br",null,null,-1),zn=["innerHTML"],An=Object(r["createElementVNode"])("br",null,null,-1),Tn=Object(r["createElementVNode"])("br",null,null,-1),In=["innerHTML"],Ln=["innerHTML"],Bn=Object(r["createElementVNode"])("p",null,null,-1),xn=["innerHTML"];function Fn(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("ContentBlock"),c=Object(r["resolveDirective"])("content-intro");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_AskingForConsent")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_ConsentExplanation")),1)],512),[[c]]),e.consentManagerName?(Object(r["openBlock"])(),Object(r["createBlock"])(l,{key:0,"content-title":e.translate("PrivacyManager_ConsentManager"),class:"privacyAskingForConsent"},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.consentManagerDetectedText)},null,8,kn),e.consentManagerIsConnected?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(e.translate("PrivacyManager_ConsentManagerConnected",e.consentManagerName))},null,8,_n)):Object(r["createCommentVNode"])("",!0)]})),_:1},8,["content-title"])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(l,{"content-title":e.translate("PrivacyManager_WhenDoINeedConsent"),class:"privacyAskingForConsent"},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.whenConsentIsNeeded1)},null,8,Pn),Mn,wn,Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.whenConsentIsNeeded2)},null,8,zn),An,Tn,Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.whenConsentIsNeeded3)},null,8,In)])]})),_:1},8,["content-title"]),Object(r["createVNode"])(l,{"content-title":e.translate("PrivacyManager_HowDoIAskForConsent"),class:"privacyAskingForConsent"},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_HowDoIAskForConsentIntro")),1),Object(r["createElementVNode"])("ul",{innerHTML:e.$sanitize(e.consentManagersList)},null,8,Ln),Bn,Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.howDoIAskForConsentOthers)},null,8,xn)]})),_:1},8,["content-title"])])}function Rn(e,t){return $n(e)||Gn(e,t)||Hn(e,t)||Un()}function Un(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hn(e,t){if(e){if("string"===typeof e)return qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qn(e,t):void 0}}function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Gn(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,o,r=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(a=n.next()).done);i=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,o=c}finally{try{i||null==n["return"]||n["return"]()}finally{if(l)throw o}}return r}}function $n(e){if(Array.isArray(e))return e}var Kn=Object(r["defineComponent"])({props:{consentManagerName:{type:String,required:!0},consentManagerUrl:{type:String,required:!0},consentManagerIsConnected:{type:Boolean,required:!0},consentManagers:{type:Object,required:!0}},components:{ContentBlock:te["ContentBlock"]},directives:{ContentIntro:te["ContentIntro"]},computed:{whenConsentIsNeeded1:function(){return Object(te["translate"])("PrivacyManager_WhenConsentIsNeededPart1",Object(te["externalLink"])("https://matomo.org/faq/new-to-piwik/what-is-gdpr/"),"</a>")},whenConsentIsNeeded2:function(){var e="https://matomo.org/blog/2018/04/lawful-basis-for-processing-personal-data-under-gdpr-with-matomo/";return Object(te["translate"])("PrivacyManager_WhenConsentIsNeededPart2",Object(te["externalLink"])(e),"</a>")},whenConsentIsNeeded3:function(){return Object(te["translate"])("PrivacyManager_WhenConsentIsNeededPart3",Object(te["externalLink"])("https://matomo.org/faq/how-to/faq_35661/"),"</a>")},howDoIAskForConsentOthers:function(){return Object(te["translate"])("PrivacyManager_HowDoIAskForConsentOutro",Object(te["externalLink"])("https://developer.matomo.org/guides/tracking-consent"),"</a>")},consentManagersList:function(){var e="";return Object.entries(this.consentManagers).forEach((function(t){var n=Rn(t,2),a=n[0],o=n[1],r=Object(te["externalRawLink"])(o);e+="<li>"+'  <a href="'.concat(r,'"')+'     target="_blank" rel="noreferrer noopener">'+"    ".concat(a," ").concat(Object(te["translate"])("PrivacyManager_ConsentManager"))+"  </a></li>"})),e},consentManagerDetectedText:function(){return Object(te["translate"])("PrivacyManager_ConsentManagerDetected",this.consentManagerName,'<a href="'.concat(this.consentManagerUrl,'" target="_blank" rel="noreferrer noopener">'),"</a>")}}});Kn.render=Fn;var Wn=Kn,Yn={class:"gdprOverview"},Jn=Object(r["createElementVNode"])("br",null,null,-1),Qn=Object(r["createElementVNode"])("br",null,null,-1),Xn=Object(r["createElementVNode"])("br",null,null,-1),Zn=Object(r["createElementVNode"])("br",null,null,-1),ea=["innerHTML"],ta=["innerHTML"],na=["innerHTML"],aa=["innerHTML"],oa=["innerHTML"],ra=["innerHTML"],ia=["innerHTML"],la=["innerHTML"],ca=["innerHTML"],sa=["innerHTML"],da=["innerHTML"],ua=["innerHTML"],ma=["innerHTML"],ba=["innerHTML"],pa=["innerHTML"],ga=["innerHTML"],Oa=Object(r["createElementVNode"])("br",null,null,-1);function ja(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("VueEntryContainer"),c=Object(r["resolveComponent"])("ContentBlock"),s=Object(r["resolveDirective"])("content-intro");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Yn,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_GdprOverview")),1),Object(r["createElementVNode"])("p",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_GdprOverviewIntro1"))+" ",1),Jn,Qn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_GdprOverviewIntro2")),1)])],512),[[s]]),Object(r["createVNode"])(l,{html:e.afterGDPROverviewIntroContent},null,8,["html"]),Object(r["createVNode"])(c,{"content-title":e.translate("PrivacyManager_GdprChecklists")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_GdprChecklistDesc1"))+" ",1),Xn,Zn,Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.gdprChecklistDesc2)},null,8,ea)])]})),_:1},8,["content-title"]),Object(r["createVNode"])(c,{"content-title":e.translate("PrivacyManager_IndividualsRights")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_IndividualsRightsIntro")),1),Object(r["createElementVNode"])("ol",null,[Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_IndividualsRightsInform")),1),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsAccess"))},null,8,ta),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsErasure"))},null,8,na),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsRectification"))},null,8,aa),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsPortability"))},null,8,oa),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsObject","usersOptOut"))},null,8,ra),Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_IndividualsRightsChildren")),1)])]})),_:1},8,["content-title"]),Object(r["createVNode"])(c,{"content-title":e.translate("PrivacyManager_AwarenessDocumentation")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_AwarenessDocumentationIntro")),1),Object(r["createElementVNode"])("ol",null,[Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_AwarenessDocumentationDesc1")),1),Object(r["createElementVNode"])("li",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_AwarenessDocumentationDesc2")),1),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.awarenessDocumentationDesc3)},null,8,ia),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.awarenessDocumentationDesc4)},null,8,la)])]})),_:1},8,["content-title"]),Object(r["createVNode"])(c,{"content-title":e.translate("PrivacyManager_SecurityProcedures")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_SecurityProceduresIntro")),1),Object(r["createElementVNode"])("ol",null,[Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.securityProceduresDesc1)},null,8,ca),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.securityProceduresDesc2)},null,8,sa),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.securityProceduresDesc3)},null,8,da),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.securityProceduresDesc4)},null,8,ua)])]})),_:1},8,["content-title"]),Object(r["createVNode"])(c,{"content-title":e.translate("PrivacyManager_DataRetention")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_DataRetentionInMatomo")),1),Object(r["createElementVNode"])("ul",null,[e.deleteLogsEnable?(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:0,innerHTML:e.$sanitize(e.translate("PrivacyManager_RawDataRemovedAfter","<strong>".concat(e.rawDataRetention,"</strong>")))},null,8,ma)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:1,innerHTML:e.$sanitize(e.translate("PrivacyManager_RawDataNeverRemoved"))},null,8,ba)),e.deleteReportsEnable?(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:2,innerHTML:e.$sanitize(e.translate("PrivacyManager_ReportsRemovedAfter","<strong>".concat(e.reportRetention,"</strong>")))},null,8,pa)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:3,innerHTML:e.$sanitize(e.translate("PrivacyManager_ReportsNeverRemoved"))},null,8,ga))]),Object(r["createElementVNode"])("p",null,[Oa,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_DataRetentionOverall")),1)])]})),_:1},8,["content-title"])])}function va(e,t){return Object(te["translate"])("PrivacyManager_".concat(e),Object(te["externalLink"])(t),"</a>")}var ya=Object(r["defineComponent"])({props:{afterGDPROverviewIntroContent:String,deleteLogsEnable:Boolean,deleteReportsEnable:Boolean,rawDataRetention:null,reportRetention:null},components:{ContentBlock:te["ContentBlock"],VueEntryContainer:te["VueEntryContainer"]},directives:{ContentIntro:te["ContentIntro"]},methods:{rightsLinkText:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gdprTools",n="?".concat(te["MatomoUrl"].stringify({module:"PrivacyManager",action:t}));return Object(te["translate"])("PrivacyManager_".concat(e),'<a target="_blank" rel="noreferrer noopener" href="'.concat(n,'">'),"</a>")}},computed:{gdprChecklistDesc2:function(){return va("GdprChecklistDesc2","https://matomo.org/docs/gdpr")},awarenessDocumentationDesc3:function(){return va("AwarenessDocumentationDesc3","https://matomo.org/faq/general/faq_18254/")},awarenessDocumentationDesc4:function(){return va("AwarenessDocumentationDesc4","https://matomo.org/blog/2018/04/gdpr-how-to-fill-in-the-information-asset-register-when-using-matomo/")},securityProceduresDesc1:function(){return va("SecurityProceduresDesc1","https://matomo.org/docs/security/")},securityProceduresDesc2:function(){return va("SecurityProceduresDesc2","https://ico.org.uk/for-organisations/guide-to-the-general-data-protection-regulation-gdpr/international-transfers/")},securityProceduresDesc3:function(){return va("SecurityProceduresDesc3","https://ico.org.uk/for-organisations/guide-to-the-general-data-protection-regulation-gdpr/personal-data-breaches/")},securityProceduresDesc4:function(){return va("SecurityProceduresDesc4","https://www.cnil.fr/en/guidelines-dpia")}}});ya.render=ja;var ha=ya,fa={key:0},Va=Object(r["createElementVNode"])("br",null,null,-1),Da={key:1},Na=Object(r["createElementVNode"])("br",null,null,-1),Ea={key:2},Sa={key:3},Ca={key:0},ka=["title"],_a={key:1},Pa=["title"],Ma={key:2},wa=["title"];function za(e,t,n,a,o,i){var l=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_PreviousRawDataAnonymizations")),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_Requester")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_AffectedIDSites")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_AffectedDate")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_Anonymize")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_VisitColumns")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_LinkVisitActionColumns")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1)])]),Object(r["createElementVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.anonymizations,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:n},[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.requester),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.sites.join(", ")),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.date_start)+" - "+Object(r["toDisplayString"])(t.date_end),1),Object(r["createElementVNode"])("td",null,[t.anonymize_ip?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",fa,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_IPAddress")),1),Va])):Object(r["createCommentVNode"])("",!0),t.anonymize_location?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Da,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Overlay_Location")),1),Na])):Object(r["createCommentVNode"])("",!0),t.anonymize_userid?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ea,Object(r["toDisplayString"])(e.translate("General_UserId")),1)):Object(r["createCommentVNode"])("",!0),t.anonymize_ip||t.anonymize_location||t.anonymize_userid?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Sa,"-"))]),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.unset_visit_columns.join(", ")),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.unset_link_visit_action_columns.join(", ")),1),Object(r["createElementVNode"])("td",null,[t.job_start_date?t.job_start_date&&!t.job_finish_date?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",_a,[Object(r["createElementVNode"])("span",{class:"icon-info",style:{cursor:"help"},title:"".concat(e.translate("PrivacyManager_ScheduledDate",t.scheduled_date||""),".\n").concat(e.translate("PrivacyManager_JobStartDate",t.job_start_date),".\n").concat(e.translate("PrivacyManager_CurrentOutput",t.output))},null,8,Pa),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_InProgress")),1)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ma,[Object(r["createElementVNode"])("span",{class:"icon-info",style:{cursor:"help"},title:"".concat(e.translate("PrivacyManager_ScheduledDate",t.scheduled_date||""),".\n").concat(e.translate("PrivacyManager_JobStartDate",t.job_start_date),".\n").concat(e.translate("PrivacyManager_JobFinishDate",t.job_finish_date),".\n").concat(e.translate("PrivacyManager_Output",t.output))},null,8,wa),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_Done")),1)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ca,[Object(r["createElementVNode"])("span",{class:"icon-info",style:{cursor:"help"},title:"".concat(e.translate("PrivacyManager_ScheduledDate",t.scheduled_date||""))},null,8,ka),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_Scheduled")),1)]))])])})),128))])],512),[[l]])])}var Aa=Object(r["defineComponent"])({props:{anonymizations:{type:Array,required:!0}},directives:{ContentTable:te["ContentTable"]}});Aa.render=za;var Ta=Aa,Ia=["innerHTML"],La=["innerHTML"],Ba={key:0},xa=Object(r["createElementVNode"])("a",{name:"anonymizeHistoricalData",id:"anonymizeHistoricalData"},null,-1),Fa={key:1},Ra=Object(r["createElementVNode"])("br",null,null,-1);function Ua(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("EnrichedHeadline"),c=Object(r["resolveComponent"])("AnonymizeIp"),s=Object(r["resolveComponent"])("ContentBlock"),d=Object(r["resolveComponent"])("DeleteOldLogs"),u=Object(r["resolveComponent"])("DeleteOldReports"),m=Object(r["resolveComponent"])("ScheduleReportDeletion"),b=Object(r["resolveComponent"])("AnonymizeLogData"),p=Object(r["resolveComponent"])("PreviousAnonymizations"),g=Object(r["resolveDirective"])("content-intro");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("h2",null,[Object(r["createVNode"])(l,{"help-url":e.externalRawLink("https://matomo.org/docs/privacy/")},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_AnonymizeData")),1)]})),_:1},8,["help-url"])]),Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.teaserHeader),style:{"margin-right":"3.5px"}},null,8,Ia),Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.seeAlsoOurOfficialGuide)},null,8,La)])],512),[[g]]),Object(r["createVNode"])(s,{id:"anonymizeIPAnchor","content-title":e.translate("PrivacyManager_UseAnonymizeTrackingData")},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(c,{"anonymize-ip-enabled":e.anonymizeIpEnabled,"anonymize-user-id":e.anonymizeUserId,"mask-length":e.maskLength,"use-anonymized-ip-for-visit-enrichment":e.useAnonymizedIpForVisitEnrichment,"anonymize-order-id":e.anonymizeOrderId,"force-cookieless-tracking":e.forceCookielessTracking,"anonymize-referrer":e.anonymizeReferrer,"mask-length-options":e.maskLengthOptions,"use-anonymized-ip-for-visit-enrichment-options":e.useAnonymizedIpForVisitEnrichmentOptions,"tracker-file-name":e.trackerFileName,"tracker-writable":e.trackerWritable,"referrer-anonymization-options":e.referrerAnonymizationOptions,"randomize-config-id":e.randomizeConfigId,"config-randomisation-feature-flag":e.configRandomisationFeatureFlag},null,8,["anonymize-ip-enabled","anonymize-user-id","mask-length","use-anonymized-ip-for-visit-enrichment","anonymize-order-id","force-cookieless-tracking","anonymize-referrer","mask-length-options","use-anonymized-ip-for-visit-enrichment-options","tracker-file-name","tracker-writable","referrer-anonymization-options","randomize-config-id","config-randomisation-feature-flag"])]})),_:1},8,["content-title"]),e.isDataPurgeSettingsEnabled?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Ba,[Object(r["createVNode"])(s,{id:"deleteLogsAnchor","content-title":e.translate("PrivacyManager_DeleteOldRawData")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_DeleteDataDescription")),1),Object(r["createVNode"])(d,{"is-data-purge-settings-enabled":e.isDataPurgeSettingsEnabled,"delete-data":e.deleteData,"schedule-deletion-options":e.scheduleDeletionOptions},null,8,["is-data-purge-settings-enabled","delete-data","schedule-deletion-options"])]})),_:1},8,["content-title"]),Object(r["createVNode"])(s,{id:"deleteReportsAnchor","content-title":e.translate("PrivacyManager_DeleteOldAggregatedReports")},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,{"is-data-purge-settings-enabled":e.isDataPurgeSettingsEnabled,"delete-data":e.deleteData,"schedule-deletion-options":e.scheduleDeletionOptions},null,8,["is-data-purge-settings-enabled","delete-data","schedule-deletion-options"])]})),_:1},8,["content-title"]),Object(r["createVNode"])(m,{"is-data-purge-settings-enabled":e.isDataPurgeSettingsEnabled,"delete-data":e.deleteData,"schedule-deletion-options":e.scheduleDeletionOptions},null,8,["is-data-purge-settings-enabled","delete-data","schedule-deletion-options"])])):Object(r["createCommentVNode"])("",!0),xa,Object(r["createVNode"])(s,{"content-title":e.translate("PrivacyManager_AnonymizePreviousData"),class:"logDataAnonymizer"},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_AnonymizePreviousDataDescription")),1),e.isSuperUser?(Object(r["openBlock"])(),Object(r["createBlock"])(b,{key:0})):(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",Fa,Object(r["toDisplayString"])(e.translate("PrivacyManager_AnonymizePreviousDataOnlySuperUser")),1)),Ra,Object(r["createVNode"])(p,{anonymizations:e.anonymizations},null,8,["anonymizations"])]})),_:1},8,["content-title"])])}var Ha=Object(r["defineComponent"])({props:{anonymizeIpEnabled:Boolean,anonymizeUserId:Boolean,maskLength:{type:Number,required:!0},useAnonymizedIpForVisitEnrichment:[Boolean,String,Number],anonymizeOrderId:Boolean,forceCookielessTracking:Boolean,anonymizeReferrer:String,maskLengthOptions:{type:Array,required:!0},useAnonymizedIpForVisitEnrichmentOptions:{type:Array,required:!0},trackerFileName:{type:String,required:!0},trackerWritable:{type:Boolean,required:!0},referrerAnonymizationOptions:{type:Object,required:!0},isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0},anonymizations:{type:Array,required:!0},isSuperUser:Boolean,randomizeConfigId:Boolean,configRandomisationFeatureFlag:Boolean},components:{AnonymizeIp:je,EnrichedHeadline:te["EnrichedHeadline"],ContentBlock:te["ContentBlock"],DeleteOldLogs:Wt,DeleteOldReports:ln,ScheduleReportDeletion:Cn,AnonymizeLogData:_t,PreviousAnonymizations:Ta},directives:{ContentIntro:te["ContentIntro"]},computed:{teaserHeader:function(){return Object(te["translate"])("PrivacyManager_TeaserHeader",'<a href="#anonymizeIPAnchor">',"</a>",'<a href="#deleteLogsAnchor">',"</a>",'<a href="#anonymizeHistoricalData">',"</a>")},seeAlsoOurOfficialGuide:function(){return Object(te["translate"])("PrivacyManager_SeeAlsoOurOfficialGuidePrivacy",Object(te["externalLink"])("https://matomo.org/privacy/"),"</a>")}}});Ha.render=Ua;var qa=Ha,Ga={key:0},$a=Object(r["createElementVNode"])("br",null,null,-1),Ka={key:1};function Wa(e,t,n,a,o,i){var l=Object(r["resolveComponent"])("OptOutCustomizer"),c=Object(r["resolveComponent"])("ContentBlock"),s=Object(r["resolveComponent"])("Alert"),d=Object(r["resolveComponent"])("DoNotTrackPreference");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createVNode"])(c,{"content-title":e.translate("PrivacyManager_TrackingOptOut")},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.prefaceComponentsResolved,(function(e,t){return Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])(e),{key:t})})),128)),Object(r["createVNode"])(l,{"matomo-url":e.matomoUrl,language:e.language,"language-options":e.languageOptions},null,8,["matomo-url","language","language-options"])]})),_:1},8,["content-title"]),e.isSuperUser?(Object(r["openBlock"])(),Object(r["createBlock"])(c,{key:0,id:"DNT","content-title":e.translate("PrivacyManager_DoNotTrack_SupportDNTPreference")},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{severity:"warning"},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_Deprecated")),1)]})),_:1}),Object(r["createElementVNode"])("p",null,[e.dntSupport?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ga,[Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_Enabled")),1),$a,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_EnabledMoreInfo")),1)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ka,Object(r["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_Disabled"))+" "+Object(r["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_DisabledMoreInfo")),1))]),Object(r["createVNode"])(d,{"dnt-support":e.dntSupport,"do-not-track-options":e.doNotTrackOptions},null,8,["dnt-support","do-not-track-options"])]})),_:1},8,["content-title"])):Object(r["createCommentVNode"])("",!0)])}var Ya=Object(r["defineComponent"])({props:{language:{type:String,required:!0},matomoUrl:String,isSuperUser:Boolean,dntSupport:Boolean,doNotTrackOptions:{type:Array,required:!0},languageOptions:{type:Object,required:!0}},components:{Alert:te["Alert"],ContentBlock:te["ContentBlock"],DoNotTrackPreference:wt,OptOutCustomizer:Ge},data:function(){return{prefaceComponents:[]}},computed:{prefaceComponentsResolved:function(){return Object(r["markRaw"])(this.prefaceComponents.map((function(e){return Object(r["markRaw"])(Object(te["useExternalPluginComponent"])(e.plugin,e.component))})))}},created:function(){var e=[];te["Matomo"].postEvent("PrivacyManager.UsersOptOut.preface",e),this.prefaceComponents=e}});Ya.render=Wa;var Ja=Ya;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["MobileMessaging"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["MobileMessaging"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/MobileMessaging/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ReportParameters",(function(){return N})),n.d(t,"ManageSmsProvider",(function(){return q})),n.d(t,"SmsProviderCredentials",(function(){return H})),n.d(t,"DelegateMobileMessagingSettings",(function(){return I})),n.d(t,"ManageMobilePhoneNumbers",(function(){return je})),n.d(t,"SelectPhoneNumbers",(function(){return f})),n.d(t,"AdminPage",(function(){return Ae})),"undefined"!==typeof window){var o=window.document.currentScript,r=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var i=n("8bbf"),a={key:0};function l(e,t,n,o,r,l){var c=Object(i["resolveComponent"])("SelectPhoneNumbers");return e.report&&"mobile"===e.report.type?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",a,[Object(i["createVNode"])(c,{"phone-numbers":e.phoneNumbers,"with-introduction":!0,"model-value":e.report.phoneNumbers,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("change","phoneNumbers",t)})},null,8,["phone-numbers","model-value"])])):Object(i["createCommentVNode"])("",!0)}var c={class:"mobile"},s={id:"mobilePhoneNumbersHelp",class:"inline-help-node"},d=Object(i["createElementVNode"])("span",{class:"icon-info",style:{"margin-right":"3.5px"}},null,-1),u={key:0,style:{"margin-right":"3.5px"}},m={key:1,style:{"margin-right":"3.5px"}},b=["href"];function p(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("Field");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",c,[Object(i["createVNode"])(l,{uicontrol:"checkbox","var-type":"array",name:"phoneNumbers","model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t)}),introduction:e.withIntroduction?e.translate("ScheduledReports_SendReportTo"):void 0,title:e.translate("MobileMessaging_PhoneNumbers"),disabled:0===e.phoneNumbers.length,options:e.phoneNumbers},{"inline-help":Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",s,[d,0===e.phoneNumbers.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",u,Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_NoPhoneNumbers")),1)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",m,Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_AdditionalPhoneNumbers")),1)),Object(i["createElementVNode"])("a",{href:e.linkTo({module:"MobileMessaging",action:"index",updated:null})},Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_MobileMessagingSettingsLink")),9,b)])]})),_:1},8,["model-value","introduction","title","disabled","options"])])}var g=n("19dc"),v=n("a5a2"),h=Object(i["defineComponent"])({props:{modelValue:Array,phoneNumbers:{type:[Array,Object],required:!0},withIntroduction:Boolean},emits:["update:modelValue"],components:{Field:v["Field"]},methods:{linkTo:function(e){return"?".concat(g["MatomoUrl"].stringify(Object.assign(Object.assign({},g["MatomoUrl"].urlParsed.value),e)))}}});h.render=p;var f=h,j="mobile",O=Object(i["defineComponent"])({props:{report:{type:Object,required:!0},phoneNumbers:{type:[Array,Object],required:!0}},components:{SelectPhoneNumbers:f},emits:["change"],created:function(){var e=window,t=e.resetReportParametersFunctions,n=e.updateReportParametersFunctions,o=e.getReportParametersFunctions;t[j]||(t[j]=function(e){e.phoneNumbers=[],e.formatmobile="sms"}),n[j]||(n[j]=function(e){null!==e&&void 0!==e&&e.parameters&&(e.parameters&&e.parameters.phoneNumbers&&(e.phoneNumbers=e.parameters.phoneNumbers),e.formatmobile="sms")}),o[j]||(o[j]=function(e){var t=e.phoneNumbers;return{phoneNumbers:t||[""]}})}});O.render=l;var N=O,M=Object(i["createElementVNode"])("div",{id:"ajaxErrorManageSmsProviderSettings"},null,-1),S={key:0},y={key:0},C=Object(i["createElementVNode"])("br",null,null,-1),P={key:1},V=Object(i["createElementVNode"])("br",null,null,-1),A=["innerHTML"],E={key:1},_={id:"accountForm"},k=["innerHTML"];function B(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("ActivityIndicator"),c=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SmsProviderCredentials"),d=Object(i["resolveComponent"])("SaveButton"),u=Object(i["resolveDirective"])("form");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createVNode"])(l,{loading:e.isDeletingAccount},null,8,["loading"]),M,e.credentialSupplied?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",S,[e.credentialError?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",y,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_CredentialInvalid",e.provider)),1),C,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.credentialError),1)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",P,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_CredentialProvided",e.provider))+" "+Object(i["toDisplayString"])(e.creditLeft),1)),V,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.updateOrDeleteAccountText),onClick:t[0]||(t[0]=function(t){return e.onUpdateOrDeleteClick(t)})},null,8,A)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",E,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PleaseSignUp")),1)),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",_,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(c,{uicontrol:"select",name:"smsProviders",modelValue:e.smsProvider,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.smsProvider=t}),title:e.translate("MobileMessaging_Settings_SMSProvider"),options:e.smsProviderOptions,value:e.provider},null,8,["modelValue","title","options","value"])]),Object(i["createVNode"])(s,{provider:e.smsProvider,modelValue:e.credentials,"onUpdate:modelValue":[t[2]||(t[2]=function(t){return e.credentials=t}),t[3]||(t[3]=function(t){e.credentials=t})],"model-value":e.credentials},null,8,["provider","modelValue","model-value"]),Object(i["createVNode"])(d,{id:"apiAccountSubmit",disabled:!e.isUpdateAccountPossible,saving:e.isUpdatingAccount,onConfirm:t[4]||(t[4]=function(t){return e.updateAccount()})},null,8,["disabled","saving"]),Object(i["createElementVNode"])("div",{class:"providerDescription",innerHTML:e.$sanitize(e.currentProviderDescription)},null,8,k)],512),[[i["vShow"],!e.credentialSupplied||e.showAccountForm],[u]])])}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w={key:0};function U(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("Field");return e.fields?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",w,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.fields,(function(t){var n;return Object(i["openBlock"])(),Object(i["createBlock"])(l,{key:t.name,uicontrol:t.type,name:t.name,"model-value":null===(n=e.modelValue)||void 0===n?void 0:n[t.name],"onUpdate:modelValue":function(n){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},x({},t.name,n)))},title:e.translate(t.title)},null,8,["uicontrol","name","model-value","onUpdate:modelValue","title"])})),128))])):Object(i["createCommentVNode"])("",!0)}var D=Object(i["reactive"])({}),F=Object(i["defineComponent"])({props:{provider:{type:String,required:!0},modelValue:Object},emits:["update:modelValue"],components:{Field:v["Field"]},watch:{provider:function(){this.$emit("update:modelValue",null),this.getCredentialFields()}},created:function(){this.getCredentialFields()},methods:{getCredentialFields:function(){var e=this;D[this.provider]?this.$emit("update:modelValue",Object.fromEntries(D[this.provider].map((function(e){return[e.name,null]})))):g["AjaxHelper"].fetch({module:"MobileMessaging",action:"getCredentialFields",provider:this.provider}).then((function(t){e.$emit("update:modelValue",Object.fromEntries(t.map((function(e){return[e.name,null]})))),D[e.provider]=t}))}},computed:{fields:function(){return D[this.provider]}}});F.render=U;var H=F,T=Object(i["defineComponent"])({props:{credentialSupplied:Boolean,credentialError:String,provider:String,creditLeft:[Number,String],smsProviderOptions:{type:Object,required:!0},smsProviders:{type:Object,required:!0}},components:{ActivityIndicator:g["ActivityIndicator"],Field:v["Field"],SaveButton:v["SaveButton"],SmsProviderCredentials:H},directives:{Form:v["Form"]},data:function(){return{isDeletingAccount:!1,isUpdatingAccount:!1,showAccountForm:!1,credentials:null,smsProvider:this.provider}},methods:{deleteApiAccount:function(){var e=this;this.isDeletingAccount=!0,g["AjaxHelper"].fetch({method:"MobileMessaging.deleteSMSAPICredential"},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){g["Matomo"].helper.redirect()})).finally((function(){e.isDeletingAccount=!1}))},showUpdateAccount:function(){this.showAccountForm=!0},updateAccount:function(){var e=this;this.isUpdateAccountPossible&&(this.isUpdatingAccount=!0,g["AjaxHelper"].post({method:"MobileMessaging.setSMSAPICredential"},{provider:this.smsProvider,credentials:this.credentials},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){g["Matomo"].helper.redirect()})).finally((function(){e.isUpdatingAccount=!1})))},deleteAccount:function(){var e=this;g["Matomo"].helper.modalConfirm("#confirmDeleteAccount",{yes:function(){e.isDeletingAccount=!0,g["AjaxHelper"].fetch({method:"MobileMessaging.deleteSMSAPICredential"},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){e.isDeletingAccount=!1,g["Matomo"].helper.redirect()})).finally((function(){e.isDeletingAccount=!1}))}})},onUpdateOrDeleteClick:function(e){var t=e.target;"displayAccountForm"===t.id?this.showUpdateAccount():"deleteAccount"===t.id&&this.deleteAccount()}},computed:{isUpdateAccountPossible:function(){return!!this.smsProvider&&null!==this.credentials&&Object.values(this.credentials).every((function(e){return!!e}))},updateOrDeleteAccountText:function(){return Object(g["translate"])("MobileMessaging_Settings_UpdateOrDeleteAccount",'<a id="displayAccountForm">',"</a>",'<a id="deleteAccount">',"</a>")},currentProviderDescription:function(){return this.smsProvider&&this.smsProviders?this.smsProviders[this.smsProvider]:""}}});T.render=B;var q=T;function L(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"radio",name:"delegatedManagement",title:e.translate("MobileMessaging_Settings_LetUsersManageAPICredential"),modelValue:e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.enabled=t}),"full-width":!0,options:e.delegateManagementOptions},null,8,["title","modelValue","options"])]),Object(i["createVNode"])(c,{onConfirm:t[1]||(t[1]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])])}var R=Object(i["defineComponent"])({props:{delegateManagementOptions:{type:Array,required:!0},delegatedManagement:[Number,Boolean]},components:{Field:v["Field"],SaveButton:v["SaveButton"]},data:function(){return{isLoading:!1,enabled:this.delegatedManagement?1:0}},methods:{save:function(){var e=this;this.isLoading=!0,g["AjaxHelper"].post({method:"MobileMessaging.setDelegatedManagement"},{delegatedManagement:this.enabled&&"0"!==this.enabled?"true":"false"}).then((function(){var e=g["NotificationsStore"].show({message:Object(g["translate"])("CoreAdminHome_SettingsSaveSuccess"),id:"mobileMessagingSettings",type:"transient",context:"success"});g["NotificationsStore"].scrollToNotification(e),g["Matomo"].helper.redirect()})).finally((function(){e.isLoading=!1}))}}});R.render=L;var I=R,$={key:0},G={class:"row"},Y={class:"col s12"},z={class:"form-group row"},J={class:"col s12 m6"},K={class:"col s12 m6 form-help"},Q={class:"form-group row addPhoneNumber"},W={class:"col s12 m6"},X={class:"countryCode left"},Z=Object(i["createElementVNode"])("span",{class:"countryCodeSymbol"},"+",-1),ee={class:"phoneNumber left"},te={class:"addNumber left valign-wrapper"},ne={class:"col s12 m6 form-help"},oe={id:"ajaxErrorManagePhoneNumber",ref:"errorContainer"},re=Object(i["createElementVNode"])("div",{id:"notificationManagePhoneNumber"},null,-1),ie={key:1,class:"row"},ae={class:"col s12"},le={class:"col s12 m6"},ce={class:"phoneNumber"},se=["onUpdate:modelValue","placeholder"],de={key:0,class:"form-help col s12 m6"},ue=["onClick"],me=Object(i["createTextVNode"])("  "),be={class:"ui-confirm",id:"confirmDeletePhoneNumber"},pe=["innerHTML"],ge=["value"],ve=["value"];function he(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveComponent"])("Alert"),d=Object(i["resolveComponent"])("ActivityIndicator");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_Help")),1),e.isSuperUser?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",$,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DelegatedPhoneNumbersOnlyUsedByYou")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",G,[Object(i["createElementVNode"])("h3",Y,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_Add")),1)]),Object(i["createElementVNode"])("div",z,[Object(i["createElementVNode"])("div",J,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"select",name:"countryCodeSelect",title:e.translate("MobileMessaging_Settings_SelectCountry"),modelValue:e.countryCallingCode,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.countryCallingCode=t}),"full-width":!0,options:e.countries},null,8,["title","modelValue","options"])])]),Object(i["createElementVNode"])("div",K,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_CountryCode_Help")),1)]),Object(i["createElementVNode"])("div",Q,[Object(i["createElementVNode"])("div",W,[Object(i["createElementVNode"])("div",X,[Z,Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"text",name:"countryCallingCode",title:e.translate("MobileMessaging_Settings_CountryCode"),modelValue:e.countryCallingCode,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.countryCallingCode=t}),"full-width":!0,maxlength:4},null,8,["title","modelValue"])])]),Object(i["createElementVNode"])("div",ee,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"text",name:"newPhoneNumber",modelValue:e.newPhoneNumber,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.newPhoneNumber=t}),title:e.translate("MobileMessaging_Settings_PhoneNumber"),"full-width":!0,maxlength:80},null,8,["modelValue","title"])])]),Object(i["createElementVNode"])("div",te,[Object(i["createVNode"])(c,{class:"valign",disabled:!e.canAddNumber||e.isUpdatingPhoneNumbers,onConfirm:t[3]||(t[3]=function(t){return e.addPhoneNumber()}),value:e.translate("General_Add")},null,8,["disabled","value"])]),Object(i["withDirectives"])(Object(i["createVNode"])(s,{severity:"warning",id:"suspiciousPhoneNumber"},{default:Object(i["withCtx"])((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_SuspiciousPhoneNumber","54184032")),1)]})),_:1},512),[[i["vShow"],e.showSuspiciousPhoneNumber]])]),Object(i["createElementVNode"])("div",ne,Object(i["toDisplayString"])(e.strHelpAddPhone),1)]),Object(i["createElementVNode"])("div",oe,null,512),re,Object.keys(e.phoneNumbers||{}).length>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ie,[Object(i["createElementVNode"])("h3",ae,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_ManagePhoneNumbers")),1)])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(d,{loading:e.isUpdatingPhoneNumbers},null,8,["loading"]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.phoneNumbers||[],(function(t,n,o){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"form-group row",key:o},[Object(i["createElementVNode"])("div",le,[Object(i["createElementVNode"])("span",ce,Object(i["toDisplayString"])(n),1),t.verified?Object(i["createCommentVNode"])("",!0):Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("input",{key:0,type:"text",class:"verificationCode","onUpdate:modelValue":function(t){return e.validationCode[o]=t},placeholder:e.translate("MobileMessaging_Settings_EnterActivationCode"),style:{"margin-right":"3.5px"}},null,8,se)),[[i["vModelText"],e.validationCode[o]]]),t.verified?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:1,disabled:!e.validationCode[o]||e.isUpdatingPhoneNumbers,onConfirm:function(t){return e.validateActivationCode(n,o)},value:e.translate("MobileMessaging_Settings_ValidatePhoneNumber")},null,8,["disabled","onConfirm","value"])),Object(i["createVNode"])(c,{disabled:e.isUpdatingPhoneNumbers,onConfirm:function(t){return e.removePhoneNumber(n)},value:e.translate("General_Remove"),style:{"margin-left":"3.5px"}},null,8,["disabled","onConfirm","value"])]),t.verified?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",de,[Object(i["createElementVNode"])("div",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_VerificationCodeJustSent"))+" ",1),Object(i["createElementVNode"])("a",{onClick:function(t){return e.resendVerificationCode(n,o)}},Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_ResendVerification")),9,ue)]),me]))])})),128))]),Object(i["createElementVNode"])("div",be,[Object(i["createElementVNode"])("h2",{innerHTML:e.$sanitize(e.removeNumberConfirmation)},null,8,pe),Object(i["createElementVNode"])("input",{type:"button",role:"yes",value:e.translate("General_Yes")},null,8,ge),Object(i["createElementVNode"])("input",{type:"button",role:"no",value:e.translate("General_No")},null,8,ve)])],64)}var fe=Object(i["defineComponent"])({props:{isSuperUser:Boolean,defaultCallingCode:String,countries:{type:Array,required:!0},strHelpAddPhone:{type:String,required:!0}},components:{Field:v["Field"],SaveButton:v["SaveButton"],Alert:g["Alert"],ActivityIndicator:g["ActivityIndicator"]},data:function(){return{isUpdatingPhoneNumbers:!1,phoneNumbers:{},countryCallingCode:this.defaultCallingCode||"",newPhoneNumber:"",validationCode:{},numberToRemove:""}},mounted:function(){this.updatePhoneNumbers()},methods:{validateActivationCode:function(e,t){var n=this;if(this.validationCode[t]){var o=this.validationCode[t];this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.validatePhoneNumber"},{phoneNumber:e,verificationCode:o},{errorElement:"#ajaxErrorManagePhoneNumber"}).then((function(e){var t;if(e&&e.value){var o=Object(g["translate"])("MobileMessaging_Settings_PhoneActivated");t=g["NotificationsStore"].show({message:o,placeat:"#notificationManagePhoneNumber",context:"success",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"}),n.updatePhoneNumbers()}else{var r=Object(g["translate"])("MobileMessaging_Settings_InvalidActivationCode");t=g["NotificationsStore"].show({message:r,placeat:"#notificationManagePhoneNumber",context:"error",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"})}g["NotificationsStore"].scrollToNotification(t)})).finally((function(){n.validationCode[t]="",n.isUpdatingPhoneNumbers=!1}))}},resendVerificationCode:function(e){var t=this;this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.resendVerificationCode"},{phoneNumber:e},{errorElement:"#ajaxErrorManagePhoneNumber"}).then((function(){var e=Object(g["translate"])("MobileMessaging_Settings_NewVerificationCodeSent"),n=g["NotificationsStore"].show({message:e,placeat:"#notificationManagePhoneNumber",context:"success",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"});g["NotificationsStore"].scrollToNotification(n),t.updatePhoneNumbers()})).finally((function(){t.isUpdatingPhoneNumbers=!1}))},updatePhoneNumbers:function(){var e=this;this.isUpdatingPhoneNumbers=!0,g["AjaxHelper"].post({method:"MobileMessaging.getPhoneNumbers"},{}).then((function(t){e.phoneNumbers=t,e.isUpdatingPhoneNumbers=!1}))},removePhoneNumber:function(e){var t=this;e&&(this.numberToRemove=e,this.clearNotifcationsAndErrorsContainer(),g["Matomo"].helper.modalConfirm("#confirmDeletePhoneNumber",{yes:function(){t.isUpdatingPhoneNumbers=!0,g["AjaxHelper"].post({method:"MobileMessaging.removePhoneNumber"},{phoneNumber:e},{errorElement:"#ajaxErrorManagePhoneNumber"}).then((function(){t.updatePhoneNumbers()})).finally((function(){t.isUpdatingPhoneNumbers=!1,t.numberToRemove=""}))}}))},addPhoneNumber:function(){var e=this,t="+".concat(this.countryCallingCode).concat(this.newPhoneNumber);this.canAddNumber&&t.length>1&&(this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.addPhoneNumber"},{phoneNumber:t},{errorElement:"#ajaxErrorManagePhoneNumber"}).then((function(){e.updatePhoneNumbers(),e.countryCallingCode="",e.newPhoneNumber=""})).finally((function(){e.isUpdatingPhoneNumbers=!1})))},clearNotifcationsAndErrorsContainer:function(){this.$refs.errorContainer.innerHTML="",g["NotificationsStore"].remove("MobileMessaging_ValidatePhoneNumber")}},computed:{showSuspiciousPhoneNumber:function(){return 0===this.newPhoneNumber.trim().lastIndexOf("0",0)},canAddNumber:function(){return!!this.newPhoneNumber&&""!==this.newPhoneNumber},removeNumberConfirmation:function(){return Object(g["translate"])("MobileMessaging_ConfirmRemovePhoneNumber",this.numberToRemove)}}});fe.render=he;var je=fe,Oe={class:"manageMobileMessagingSettings"},Ne={key:0},Me={key:0},Se={class:"ui-confirm",id:"confirmDeleteAccount"},ye=["value"],Ce=["value"];function Pe(e,t,n,o,r,a){var l=Object(i["resolveComponent"])("DelegateMobileMessagingSettings"),c=Object(i["resolveComponent"])("ContentBlock"),s=Object(i["resolveComponent"])("ManageSmsProvider"),d=Object(i["resolveComponent"])("ManageMobilePhoneNumbers");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Oe,[e.isSuperUser?(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:0,"content-title":e.translate("MobileMessaging_SettingsMenu")},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(l,{"delegate-management-options":e.delegateManagementOptions,"delegated-management":e.delegatedManagement},null,8,["delegate-management-options","delegated-management"])]})),_:1},8,["content-title"])):Object(i["createCommentVNode"])("",!0),e.accountManagedByCurrentUser?(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:1,"content-title":e.translate("MobileMessaging_Settings_SMSProvider"),feature:"true"},{default:Object(i["withCtx"])((function(){return[e.isSuperUser&&e.delegatedManagement?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",Ne,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DelegatedSmsProviderOnlyAppliesToYou")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(s,{"credential-supplied":e.credentialSupplied,"credential-error":e.credentialError,provider:e.provider,"credit-left":e.creditLeft,"sms-provider-options":e.smsProviderOptions,"sms-providers":e.smsProviders},null,8,["credential-supplied","credential-error","provider","credit-left","sms-provider-options","sms-providers"])]})),_:1},8,["content-title"])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(c,{"content-title":e.translate("MobileMessaging_PhoneNumbers")},{default:Object(i["withCtx"])((function(){return[e.credentialSupplied?(Object(i["openBlock"])(),Object(i["createBlock"])(d,{key:1,"is-super-user":e.isSuperUser,"default-calling-code":e.defaultCallingCode,countries:e.countries,"str-help-add-phone":e.strHelpAddPhone,"phone-numbers":e.phoneNumbers},null,8,["is-super-user","default-calling-code","countries","str-help-add-phone","phone-numbers"])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",Me,Object(i["toDisplayString"])(e.accountManagedByCurrentUser?e.translate("MobileMessaging_Settings_CredentialNotProvided"):e.translate("MobileMessaging_Settings_CredentialNotProvidedByAdmin")),1))]})),_:1},8,["content-title"]),Object(i["createElementVNode"])("div",Se,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DeleteAccountConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ye),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Ce)])])}var Ve=Object(i["defineComponent"])({props:{delegateManagementOptions:{type:Array,required:!0},delegatedManagement:[Number,Boolean],isSuperUser:Boolean,defaultCallingCode:String,countries:{type:Array,required:!0},strHelpAddPhone:{type:String,required:!0},phoneNumbers:Object,accountManagedByCurrentUser:Boolean,credentialSupplied:Boolean,credentialError:String,provider:String,creditLeft:[Number,String],smsProviderOptions:{type:Object,required:!0},smsProviders:{type:Object,required:!0}},components:{ContentBlock:g["ContentBlock"],DelegateMobileMessagingSettings:I,ManageMobilePhoneNumbers:je,ManageSmsProvider:q}});Ve.render=Pe;var Ae=Ve;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["Morpheus"]=t(require("CoreHome"),require("vue")):e["Morpheus"]=t(e["CoreHome"],e["Vue"])})("undefined"!==typeof self?self:this,(function(e,t){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var c=t[o]={i:o,l:!1,exports:{}};return e[o].call(c.exports,c,c.exports,n),c.l=!0,c.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)n.d(o,c,function(t){return e[t]}.bind(null,c));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Morpheus/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"Demo",(function(){return k})),"undefined"!==typeof window){var o=window.document.currentScript,c=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);c&&(n.p=c[1])}var r=n("8bbf"),i=Object(r["createElementVNode"])("h2",null,"Icons",-1),l={id:"icons",class:"demo icons"},p={class:"row"},u=Object(r["createElementVNode"])("div",{class:"demo-code"},[Object(r["createElementVNode"])("pre",null,'<span class="icon-ok"></span>')],-1);function d(e,t,n,o,c,d){var s=Object(r["resolveComponent"])("DemoCodePair");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.demoSnippets,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:e.id,snippet:e},null,8,["snippet"])})),128)),i,Object(r["createElementVNode"])("div",l,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.icons,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:t},[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(t),1),Object(r["createElementVNode"])("div",p,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"col s4 icon",key:t},[Object(r["createElementVNode"])("span",{class:Object(r["normalizeClass"])("icon-".concat(e))},null,2),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e),1)])})),128))])])})),128))]),u])}var s={key:0},a={key:1,class:"demo"},b={key:2,class:"demo-code"},m={key:3};function j(e,t,n,o,c,i){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{style:Object(r["normalizeStyle"])({"margin-top":e.snippet.noMargin?"-16px":void 0})},[e.snippet.title?(Object(r["openBlock"])(),Object(r["createElementBlock"])("h2",s,Object(r["toDisplayString"])(e.snippet.title),1)):Object(r["createCommentVNode"])("",!0),e.snippet.vue_embed?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",a,[(Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])(e.vueEmbedComponent)))])):Object(r["createCommentVNode"])("",!0),e.snippet.code?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",b,[Object(r["createElementVNode"])("pre",null,Object(r["toDisplayString"])(e.processedSnippetCode),1)])):Object(r["createCommentVNode"])("",!0),e.snippet.desc?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",m,Object(r["toDisplayString"])(e.snippet.desc),1)):Object(r["createCommentVNode"])("",!0)],4)}var f=n("19dc"),O=Object(r["defineComponent"])({props:{snippet:{type:Object,required:!0}},computed:{vueEmbedComponent:function(){var e=this.snippet,t={};(e.components||[]).forEach((function(e){t[e.component]=Object(f["useExternalPluginComponent"])(e.plugin,e.component)}));var n={};(e.directives||[]).forEach((function(e){n[e.directive]=window[e.plugin][e.directive]}));var o=this.snippet.data||{};return Object(r["markRaw"])({template:this.snippet.vue_embed,components:t,directives:n,data:function(){return o}})},processedSnippetCode:function(){var e=this.snippet,t=e.code.indexOf("%vue_embed%"),n=e.code.lastIndexOf("\n",t),o=e.code.substring(n+1,t);return e.code.replaceAll("%vue_embed%",e.vue_embed.replaceAll("\n","\n".concat(o)))}}});O.render=j;var v=O,y=Object(r["defineComponent"])({props:{demoSnippets:{type:Array,required:!0},icons:{type:Object,required:!0}},components:{DemoCodePair:v}});y.render=d;var k=y;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["Marketplace"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["Marketplace"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var l=t[a]={i:a,l:!1,exports:{}};return e[a].call(l.exports,l,l.exports,n),l.l=!0,l.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(a,l,function(t){return e[t]}.bind(null,l));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Marketplace/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"Marketplace",(function(){return Pn})),n.d(t,"ManageLicenseKey",(function(){return Fn})),n.d(t,"GetNewPlugins",(function(){return Xn})),n.d(t,"GetNewPluginsAdmin",(function(){return da})),n.d(t,"GetPremiumFeatures",(function(){return Ea})),n.d(t,"MissingReqsNotice",(function(){return gn})),n.d(t,"OverviewIntro",(function(){return Da})),n.d(t,"SubscriptionOverview",(function(){return il})),n.d(t,"RichMenuButton",(function(){return bl})),n.d(t,"PluginList",(function(){return Tn})),"undefined"!==typeof window){var a=window.document.currentScript,l=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);l&&(n.p=l[1])}var r=n("8bbf"),i={class:"row marketplaceActions",ref:"root"},o={class:"col s12 m6 l4"},c={class:"col s12 m6 l4"},s={key:0,class:"col s12 m12 l4 "},u={class:"plugin-search"},d=Object(r["createElementVNode"])("span",{class:"icon-search"},null,-1),p=["alt"];function m(e,t,n,a,l,m){var b,g=this,O=Object(r["resolveComponent"])("Field"),j=Object(r["resolveComponent"])("PluginList"),h=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createElementVNode"])("div",i,[Object(r["createElementVNode"])("div",o,[Object(r["createVNode"])(O,{uicontrol:"select",name:"plugin_type","model-value":e.pluginTypeFilter,"onUpdate:modelValue":e.updateType,title:e.translate("Marketplace_Show"),"full-width":!0,options:e.pluginTypeOptions},null,8,["model-value","onUpdate:modelValue","title","options"])]),Object(r["createElementVNode"])("div",c,[Object(r["createVNode"])(O,{uicontrol:"select",name:"plugin_sort","model-value":e.pluginSort,"onUpdate:modelValue":e.updateSort,title:e.translate("Marketplace_Sort"),"full-width":!0,options:e.pluginSortOptions},null,8,["model-value","onUpdate:modelValue","title","options"])]),(null===(b=e.pluginsToShow)||void 0===b?void 0:b.length)>20||e.searchQuery?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",s,[Object(r["createElementVNode"])("div",u,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(O,{uicontrol:"text",name:"query",title:e.queryInputTitle,"full-width":!0,"model-value":e.searchQuery,"onUpdate:modelValue":e.updateQuery},null,8,["title","model-value","onUpdate:modelValue"])]),d])])):Object(r["createCommentVNode"])("",!0)],512),!e.loading&&e.pluginsToShow.length>0?(Object(r["openBlock"])(),Object(r["createBlock"])(j,{key:0,"plugins-to-show":e.pluginsToShow,"current-user-email":e.currentUserEmail,"is-auto-update-possible":e.isAutoUpdatePossible,"is-super-user":e.isSuperUser,"is-multi-server-environment":e.isMultiServerEnvironment,"has-some-admin-access":e.hasSomeAdminAccess,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-valid-consumer":e.isValidConsumer,"deactivate-nonce":e.deactivateNonce,"activate-nonce":e.activateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,"num-users":e.numUsers,onTriggerUpdate:t[0]||(t[0]=function(e){return g.updateMarketplace()}),onStartTrialStart:t[1]||(t[1]=function(e){return g.$emit("startTrialStart")}),onStartTrialStop:t[2]||(t[2]=function(e){return g.$emit("startTrialStop")})},null,8,["plugins-to-show","current-user-email","is-auto-update-possible","is-super-user","is-multi-server-environment","has-some-admin-access","is-plugins-admin-enabled","is-valid-consumer","deactivate-nonce","activate-nonce","install-nonce","update-nonce","num-users"])):Object(r["createCommentVNode"])("",!0),e.loading||0!=e.pluginsToShow.length?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(h,{key:1},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate(e.showThemes?"Marketplace_NoThemesFound":"Marketplace_NoPluginsFound")),1)]})),_:1})),e.loading?(Object(r["openBlock"])(),Object(r["createBlock"])(h,{key:2},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif",alt:e.translate("General_LoadingData")},null,8,p),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.loadingMessage),1)]})),_:1})):Object(r["createCommentVNode"])("",!0)],64)}var b=n("19dc"),g=n("a5a2"),O={key:0,class:"pluginListContainer row"},j=["onClick"],h={class:"card"},k={class:"card-content"},v=["src"],y={class:"content-container"},f={class:"card-content-top"},N={key:0,class:"matomo-badge matomo-badge-top",src:"plugins/Marketplace/images/matomo-badge.png","aria-label":"Matomo plugin",alt:""},V={class:"price"},S=["onClick"],E=Object(r["createElementVNode"])("div",{class:"card-focus"},null,-1),B={class:"card-title"},M=Object(r["createElementVNode"])("span",{class:"card-title-chevron"},"",-1),T={class:"card-description"},w={class:"card-content-bottom"},C={key:0,class:"downloads"},P={class:"owner"},D={key:0},A={key:1},_={class:"cta-container"},L={key:1,class:"matomo-badge matomo-badge-bottom",src:"plugins/Marketplace/images/matomo-badge.png","aria-label":"Matomo plugin",alt:""};function U(e,t,n,a,l,i){var o=this,c=Object(r["resolveComponent"])("RequestTrial"),s=Object(r["resolveComponent"])("StartFreeTrial"),u=Object(r["resolveComponent"])("PluginDetailsModal"),d=Object(r["resolveComponent"])("CTAContainer");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createVNode"])(c,{modelValue:e.showRequestTrialForPlugin,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.showRequestTrialForPlugin=t}),onTrialRequested:t[1]||(t[1]=function(e){return o.$emit("triggerUpdate")})},null,8,["modelValue"]),Object(r["createVNode"])(s,{"current-user-email":e.currentUserEmail,"is-valid-consumer":e.isValidConsumer,modelValue:e.showStartFreeTrialForPlugin,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.showStartFreeTrialForPlugin=t}),onTrialStarted:t[3]||(t[3]=function(e){o.$emit("triggerUpdate")}),onStartTrialStart:t[4]||(t[4]=function(e){o.$emit("startTrialStart")}),onStartTrialStop:t[5]||(t[5]=function(e){o.$emit("startTrialStop")})},null,8,["current-user-email","is-valid-consumer","modelValue"]),Object(r["createVNode"])(u,{modelValue:e.showPluginDetailsForPlugin,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.showPluginDetailsForPlugin=t}),"is-super-user":e.isSuperUser,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-multi-server-environment":e.isMultiServerEnvironment,"is-valid-consumer":e.isValidConsumer,"is-auto-update-possible":e.isAutoUpdatePossible,"has-some-admin-access":e.hasSomeAdminAccess,"deactivate-nonce":e.deactivateNonce,"activate-nonce":e.activateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,"num-users":e.numUsers,onRequestTrial:t[7]||(t[7]=function(e){return o.requestTrial(e)}),onStartFreeTrial:t[8]||(t[8]=function(e){return o.startFreeTrial(e)})},null,8,["modelValue","is-super-user","is-plugins-admin-enabled","is-multi-server-environment","is-valid-consumer","is-auto-update-possible","has-some-admin-access","deactivate-nonce","activate-nonce","install-nonce","update-nonce","num-users"]),e.pluginsToShow.length>0?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",O,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.pluginsToShow,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"col s12 m6 l4",key:t.name},[Object(r["createElementVNode"])("div",{class:Object(r["normalizeClass"])("card-holder ".concat(t.numDownloads>0?"card-with-downloads":"")),onClick:function(n){return e.clickCard(n,t)}},[Object(r["createElementVNode"])("div",h,[Object(r["createElementVNode"])("div",k,[Object(r["createElementVNode"])("img",{src:"".concat(t.coverImage,"?w=880&h=480"),alt:"",class:"cover-image"},null,8,v),Object(r["createElementVNode"])("div",y,[Object(r["createElementVNode"])("div",f,["piwik"==t.owner||"matomo-org"==t.owner?(Object(r["openBlock"])(),Object(r["createElementBlock"])("img",N)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("div",V,[t.priceFrom?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_PriceFromPerPeriod",t.priceFrom.prettyPrice,t.priceFrom.period)),1)],64)):t.isFree?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:1},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_Free")),1)],64)):Object(r["createCommentVNode"])("",!0)]),Object(r["createElementVNode"])("a",{onClick:Object(r["withModifiers"])((function(n){return e.clickCard(n,t)}),["prevent"]),class:"card-title-link",href:"#",tabindex:"7"},[E,Object(r["createElementVNode"])("h2",B,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.displayName),1),M])],8,S),Object(r["createElementVNode"])("div",T,Object(r["toDisplayString"])(t.description),1)]),Object(r["createElementVNode"])("div",w,[t.numDownloads>0?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",C,Object(r["toDisplayString"])(t.numDownloadsPretty)+" "+Object(r["toDisplayString"])(e.translate("General_Downloads").toLowerCase()),1)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("div",P,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_CreatedBy"))+" ",1),"piwik"===t.owner||"matomo-org"===t.owner?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",D," Matomo")):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",A,Object(r["toDisplayString"])(t.owner),1))]),Object(r["createElementVNode"])("div",_,[Object(r["createVNode"])(d,{"is-super-user":e.isSuperUser,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-multi-server-environment":e.isMultiServerEnvironment,"is-valid-consumer":e.isValidConsumer,"is-auto-update-possible":e.isAutoUpdatePossible,"activate-nonce":e.activateNonce,"deactivate-nonce":e.deactivateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,plugin:t,"in-modal":!1,onOpenDetailsModal:function(e){return o.openDetailsModal(t)},onRequestTrial:function(e){return o.requestTrial(t)},onStartFreeTrial:function(e){return o.startFreeTrial(t)}},null,8,["is-super-user","is-plugins-admin-enabled","is-multi-server-environment","is-valid-consumer","is-auto-update-possible","activate-nonce","deactivate-nonce","install-nonce","update-nonce","plugin","onOpenDetailsModal","onRequestTrial","onStartFreeTrial"])]),"piwik"==t.owner||"matomo-org"==t.owner?(Object(r["openBlock"])(),Object(r["createElementBlock"])("img",L)):Object(r["createCommentVNode"])("",!0)])])])])],10,j)])})),128))])):Object(r["createCommentVNode"])("",!0)],64)}var q={key:0,class:"alert alert-danger alert-no-background"},x={key:0,style:{"white-space":"nowrap"}},F=Object(r["createTextVNode"])("("),R=Object(r["createTextVNode"])(")"),I=["href"],H={key:2,class:"alert alert-danger alert-no-background"},$={key:0,style:{"white-space":"nowrap"}},K=Object(r["createTextVNode"])("("),z=Object(r["createTextVNode"])(")"),G=["href"],Q={key:1,class:"alert alert-warning alert-no-background"},W={key:0,style:{"white-space":"nowrap"}},J=Object(r["createTextVNode"])("("),Y=Object(r["createTextVNode"])(")"),Z={key:4,class:"alert alert-success alert-no-background"},X=Object(r["createTextVNode"])(" ("),ee=Object(r["createTextVNode"])(") "),te=Object(r["createTextVNode"])(" ("),ne=["href"],ae=Object(r["createTextVNode"])(" - "),le=["href"],re=Object(r["createTextVNode"])(") "),ie=["title"],oe=["title","href"],ce={key:8,class:"alert alert-warning alert-no-background"},se={key:0,style:{"white-space":"nowrap"}},ue=Object(r["createTextVNode"])("("),de=Object(r["createTextVNode"])(")"),pe=["href"],me=["title"],be=["title"];function ge(e,t,n,a,l,i){var o=this,c=Object(r["resolveComponent"])("MoreDetailsAction"),s=Object(r["resolveComponent"])("DownloadButton");return e.isSuperUser?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[e.plugin.isMissingLicense?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",q,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_LicenseMissing"))+" ",1),e.inModal?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",x,[F,Object(r["createVNode"])(c,{onAction:t[0]||(t[0]=function(t){return e.$emit("openDetailsModal")})}),R]))])):e.inModal&&e.plugin.hasExceededLicense&&e.plugin.consumer.loginUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:1,class:"btn btn-block",tabindex:"7",target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink(e.plugin.consumer.loginUrl)},Object(r["toDisplayString"])(e.translate("Marketplace_UpgradeSubscription")),9,I)):e.plugin.hasExceededLicense?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",H,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_LicenseExceeded"))+" ",1),e.inModal?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",$,[K,Object(r["createVNode"])(c,{onAction:t[1]||(t[1]=function(t){return e.$emit("openDetailsModal")})}),z]))])):e.plugin.canBeUpdated&&0==e.plugin.missingRequirements.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:3},[e.isAutoUpdatePossible&&e.isPluginsAdminEnabled?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,tabindex:"7",class:"btn btn-block",href:e.linkToUpdate(e.plugin.name)},Object(r["toDisplayString"])(e.translate("CoreUpdater_UpdateTitle")),9,G)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Q,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_CannotUpdate"))+" ",1),!e.inModal||0===e.plugin.missingRequirements.length&&e.plugin.isDownloadable&&!e.isAutoUpdatePossible?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",W,[J,e.inModal?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(c,{key:0,onAction:t[2]||(t[2]=function(t){return e.$emit("openDetailsModal")})})),Object(r["createVNode"])(s,{plugin:e.plugin,"show-or":!e.inModal,"is-auto-update-possible":e.isAutoUpdatePossible},null,8,["plugin","show-or","is-auto-update-possible"]),Y])):Object(r["createCommentVNode"])("",!0)]))],64)):e.plugin.isInstalled?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Z,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("General_Installed"))+" ",1),e.plugin.missingRequirements.length>0||!e.isAutoUpdatePossible?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[X,Object(r["createVNode"])(s,{plugin:e.plugin,"show-or":!1,"is-auto-update-possible":e.isAutoUpdatePossible},null,8,["plugin","is-auto-update-possible"]),ee],64)):e.plugin.isInvalid||e.isMultiServerEnvironment||!e.isPluginsAdminEnabled?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:1},[te,e.plugin.isActivated?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,tabindex:"7",href:e.linkToDeactivate(e.plugin.name)},Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Deactivate")),9,ne)):e.plugin.missingRequirements.length>0?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:1},[ae],64)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:2,tabindex:"7",href:e.linkToActivate(e.plugin.name)},Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Activate")),9,le)),re],64))])):e.plugin.isEligibleForFreeTrial&&!e.inModal&&e.isPluginsAdminEnabled?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:5,class:"btn btn-block purchaseable",title:e.translate("Marketplace_StartFreeTrial")},Object(r["toDisplayString"])(e.translate("Marketplace_StartFreeTrial")),9,ie)):e.plugin.isEligibleForFreeTrial&&e.inModal?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:6,class:"btn btn-block addToCartLink",target:"_blank",title:e.translate("Marketplace_ClickToCompletePurchase"),rel:"noreferrer noopener",href:e.shopVariationUrl},Object(r["toDisplayString"])(e.translate("Marketplace_AddToCart")),9,oe)):e.inModal||e.plugin.isDownloadable||!(e.plugin.isPaid||e.plugin.missingRequirements.length>0)&&e.isAutoUpdatePossible?e.plugin.missingRequirements.length>0||!e.isAutoUpdatePossible?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ce,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_CannotInstall"))+" ",1),!e.inModal||0===e.plugin.missingRequirements.length&&e.plugin.isDownloadable&&!e.isAutoUpdatePossible?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",se,[ue,e.inModal?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(c,{key:0,onAction:t[4]||(t[4]=function(t){return e.$emit("openDetailsModal")})})),Object(r["createVNode"])(s,{plugin:e.plugin,"show-or":!e.inModal,"is-auto-update-possible":e.isAutoUpdatePossible},null,8,["plugin","show-or","is-auto-update-possible"]),de])):Object(r["createCommentVNode"])("",!0)])):e.isPluginsAdminEnabled&&e.plugin.hasDownloadLink?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:9,tabindex:"7",href:e.linkToInstall(e.plugin.name),class:"btn btn-block"},Object(r["toDisplayString"])(e.translate("Marketplace_ActionInstall")),9,pe)):(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:10},[e.inModal?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(c,{key:0,"show-as-button":!0,label:e.translate("General_MoreDetails"),onAction:t[5]||(t[5]=function(t){return e.$emit("openDetailsModal")})},null,8,["label"]))],64)):(Object(r["openBlock"])(),Object(r["createBlock"])(c,{key:7,"show-as-button":!0,label:e.translate("General_MoreDetails"),onAction:t[3]||(t[3]=function(t){return e.$emit("openDetailsModal")})},null,8,["label"]))],64)):e.plugin.isTrialRequested?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:1,tabindex:"7",class:"btn btn-block purchaseable disabled",href:"",title:e.translate("Marketplace_TrialRequested")},Object(r["toDisplayString"])(e.translate("Marketplace_TrialRequested")),9,me)):e.plugin.canTrialBeRequested&&!e.plugin.isMissingLicense?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:2,tabindex:"7",class:"btn btn-block purchaseable",href:"",onClick:t[6]||(t[6]=Object(r["withModifiers"])((function(e){o.$emit("requestTrial")}),["prevent"])),title:e.translate("Marketplace_RequestTrial")},Object(r["toDisplayString"])(e.translate("Marketplace_RequestTrial")),9,be)):(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:3},[e.inModal?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(c,{key:0,"show-as-button":!0,label:e.translate("General_MoreDetails"),onAction:t[7]||(t[7]=function(t){return e.$emit("openDetailsModal")})},null,8,["label"]))],64))}var Oe={key:0,onclick:"$(this).css('display', 'none')"},je=["href"];function he(e,t,n,a,l,i){return 0===e.plugin.missingRequirements.length&&e.plugin.isDownloadable&&!e.isAutoUpdatePossible?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Oe,[e.showOr?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Object(r["createTextVNode"])(""+Object(r["toDisplayString"])(e.translate("General_Or"))+"",1)],64)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("a",{tabindex:"7",class:"plugin-details download",href:e.linkTo({module:"Marketplace",action:"download",pluginName:e.plugin.name,nonce:e.plugin.downloadNonce})},Object(r["toDisplayString"])(e.translate("General_Download")),9,je)])):Object(r["createCommentVNode"])("",!0)}var ke=Object(r["defineComponent"])({props:{plugin:{type:Object,required:!0},showOr:{type:Boolean,default:!1},isAutoUpdatePossible:{type:Boolean,required:!0}},methods:{linkTo:function(e){return"?".concat(b["MatomoUrl"].stringify(Object.assign(Object.assign({},b["MatomoUrl"].urlParsed.value),e)))}}});ke.render=he;var ve=ke,ye=["title"];function fe(e,t,n,a,l,i){return Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{tabindex:"7",class:Object(r["normalizeClass"])({"btn btn-block":e.showAsButton}),href:"",title:e.translate("General_MoreDetails"),onClick:t[0]||(t[0]=Object(r["withModifiers"])((function(t){return e.$emit("action")}),["prevent"])),onKeyup:t[1]||(t[1]=Object(r["withKeys"])((function(t){return e.$emit("action")}),["enter"]))},Object(r["toDisplayString"])(e.label?e.label:e.translate("General_Help")),43,ye)}var Ne=Object(r["defineComponent"])({props:{showAsButton:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1}},emits:["action"]});Ne.render=fe;var Ve=Ne,Se=Object(r["defineComponent"])({props:{plugin:{type:Object,required:!0},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},installNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},isAutoUpdatePossible:{type:Boolean,required:!0},isValidConsumer:{type:Boolean,required:!0},isMultiServerEnvironment:{type:Boolean,required:!0},isPluginsAdminEnabled:{type:Boolean,required:!0},isSuperUser:{type:Boolean,required:!0},inModal:{type:Boolean,required:!0},shopVariationUrl:{type:String,required:!1,default:""}},emits:["openDetailsModal","requestTrial","startFreeTrial"],components:{MoreDetailsAction:Ve,DownloadButton:ve},methods:{linkToActivate:function(e){return this.linkTo({module:"CorePluginsAdmin",action:"activate",redirectTo:"referrer",nonce:this.activateNonce,pluginName:e})},linkToDeactivate:function(e){return this.linkTo({module:"CorePluginsAdmin",action:"deactivate",redirectTo:"referrer",nonce:this.deactivateNonce,pluginName:e})},linkToInstall:function(e){return this.linkTo({module:"Marketplace",action:"installPlugin",nonce:this.installNonce,pluginName:e})},linkToUpdate:function(e){return this.linkTo({module:"Marketplace",action:"updatePlugin",nonce:this.updateNonce,pluginName:e})},linkTo:function(e){return"?".concat(b["MatomoUrl"].stringify(Object.assign(Object.assign({},b["MatomoUrl"].urlParsed.value),e)))}}});Se.render=ge;var Ee=Se,Be={class:"ui-confirm",ref:"confirm"},Me=["value"],Te=["value"];function we(e,t,n,a,l,i){var o;return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Be,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("Marketplace_RequestTrialConfirmTitle",null===(o=e.plugin)||void 0===o?void 0:o.displayName)),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("Marketplace_RequestTrialConfirmEmailWarning")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Me),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Te)],512)}var Ce=Object(r["defineComponent"])({props:{modelValue:{type:Object,default:function(){return{}}}},emits:["update:modelValue","trialRequested"],watch:{modelValue:function(e){var t=this;e&&b["Matomo"].helper.modalConfirm(this.$refs.confirm,{yes:function(){t.requestTrial(e)}},{onCloseEnd:function(){t.$emit("update:modelValue",null)}})}},computed:{plugin:function(){return this.modelValue}},methods:{requestTrial:function(e){var t=this;b["AjaxHelper"].post({module:"API",method:"Marketplace.requestTrial"},{pluginName:e.name}).then((function(){var n=b["NotificationsStore"].show({message:Object(b["translate"])("Marketplace_RequestTrialSubmitted",e.displayName),context:"success",id:"requestTrialSuccess",placeat:"#notificationContainer",type:"transient"});b["NotificationsStore"].scrollToNotification(n),t.$emit("trialRequested")}))}}});Ce.render=we;var Pe=Ce,De={class:"modal",id:"startFreeTrial"},Ae={key:0,class:"btn-close modal-close"},_e=Object(r["createElementVNode"])("i",{class:"icon-close"},null,-1),Le=[_e],Ue={key:1,class:"modal-content trial-start-in-progress"},qe={class:"Piwik_Popover_Loading"},xe={class:"Piwik_Popover_Loading_Name"},Fe={key:2,class:"modal-content trial-start-error"},Re={class:"modal-text"},Ie={key:3,class:"modal-content trial-start-no-license"},He={class:"modal-text"},$e=["innerHTML"],Ke=["innerHTML"],ze=["disabled"],Ge=["innerHTML"];function Qe(e,t,n,a,l,i){var o=Object(r["resolveComponent"])("Field");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",De,[e.trialStartInProgress?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",Ae,Le)),e.trialStartInProgress?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Ue,[Object(r["createElementVNode"])("div",qe,[Object(r["createElementVNode"])("div",xe,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("Marketplace_TrialStartInProgressTitle")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("Marketplace_TrialStartInProgressText")),1)])])])):e.trialStartError?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Fe,[Object(r["createElementVNode"])("div",Re,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("Marketplace_TrialStartErrorTitle")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.trialStartError),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("Marketplace_TrialStartErrorSupport")),1)])])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Ie,[Object(r["createElementVNode"])("div",He,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("Marketplace_TrialStartNoLicenseTitle")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("Marketplace_TrialStartNoLicenseText")),1),Object(r["createVNode"])(o,{uicontrol:"text",name:"email",modelValue:e.createAccountEmail,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.createAccountEmail=t}),"full-width":!0,title:e.translate("UsersManager_Email")},null,8,["modelValue","title"]),e.createAccountError?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:0,class:"alert alert-danger",innerHTML:e.$sanitize(e.createAccountError)},null,8,$e)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("p",{class:"trial-start-legal-hint",innerHTML:e.$sanitize(e.trialStartNoLicenseLegalHintText)},null,8,Ke),Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("button",{class:"btn",disabled:!e.createAccountEmail,onClick:t[1]||(t[1]=function(t){return e.createAccountAndStartFreeTrial()})},Object(r["toDisplayString"])(e.translate("Marketplace_TrialStartNoLicenseCreateAccount")),9,ze)]),Object(r["createElementVNode"])("p",{class:"add-existing-license",innerHTML:e.$sanitize(e.trialStartNoLicenseAddHereText)},null,8,Ge)])]))])}var We=window,Je=We.$,Ye=Object(r["defineComponent"])({components:{Field:g["Field"]},props:{modelValue:{type:Object,default:function(){return{}}},currentUserEmail:String,isValidConsumer:Boolean},data:function(){return{createAccountEmail:this.currentUserEmail||"",createAccountError:null,trialStartError:null,loadingModalCloseCallback:void 0,trialStartInProgress:!1,trialStartSuccessNotificationMessage:"",trialStartSuccessNotificationTitle:""}},emits:["update:modelValue","trialStarted","startTrialStart","startTrialStop"],watch:{modelValue:function(e){e&&(this.isValidConsumer?(this.trialStartSuccessNotificationMessage=Object(b["translate"])("CorePluginsAdmin_PluginFreeTrialStarted","<strong>","</strong>",this.plugin.displayName),this.startFreeTrial()):(this.trialStartSuccessNotificationTitle=Object(b["translate"])("CorePluginsAdmin_PluginFreeTrialStartedAccountCreatedTitle"),this.trialStartSuccessNotificationMessage=Object(b["translate"])("CorePluginsAdmin_PluginFreeTrialStartedAccountCreatedMessage",this.plugin.displayName),this.showLicenseDialog(!1)))}},computed:{plugin:function(){return this.modelValue},trialStartNoLicenseAddHereText:function(){var e="?".concat(b["MatomoUrl"].stringify({module:"Marketplace",action:"manageLicenseKey"}));return Object(b["translate"])("Marketplace_TrialStartNoLicenseAddHere",'<a href="'.concat(e,'">'),"</a>")},trialStartNoLicenseLegalHintText:function(){return Object(b["translate"])("Marketplace_TrialStartNoLicenseLegalHint",Object(b["externalLink"])("https://shop.matomo.org/terms-conditions/"),"</a>",Object(b["externalLink"])("https://matomo.org/privacy-policy/"),"</a>")}},methods:{closeModal:function(){Je("#startFreeTrial").modal("close")},createAccountAndStartFreeTrial:function(){var e=this;this.createAccountEmail&&(this.showLoadingModal(!0),b["AjaxHelper"].post({module:"API",method:"Marketplace.createAccount"},{email:this.createAccountEmail},{createErrorNotification:!1}).then((function(){e.startFreeTrial()})).catch((function(t){t.message.startsWith("Marketplace_CreateAccountError")?(e.showErrorModal(Object(b["translate"])(t.message)),e.trialStartInProgress=!1,e.$emit("update:modelValue",null)):(e.createAccountError=t.message,e.trialStartInProgress=!1,e.showLicenseDialog(!0))})))},showLicenseDialog:function(e){var t=this,n=function(e){var n=e.keyCode?e.keyCode:e.which;13===n&&(t.closeModal(),t.createAccountAndStartFreeTrial())},a={dismissible:!0,onOpenEnd:function(){var e=".modal.open #email";Je(e).focus(),Je(e).off("keypress").keypress(n)},onCloseEnd:function(){t.createAccountError=null,t.trialStartInProgress||t.$emit("update:modelValue",null)}};e&&(a.inDuration=0),Je("#startFreeTrial").modal(a).modal("open")},showErrorModal:function(e){var t=this;this.trialStartError||(this.trialStartError=e,Je("#startFreeTrial").modal({dismissible:!0,inDuration:0,onCloseEnd:function(){t.trialStartError=null}}).modal("open"))},showLoadingModal:function(e){var t=this;this.trialStartInProgress||(this.trialStartInProgress=!0,this.loadingModalCloseCallback=void 0,Je("#startFreeTrial").modal({dismissible:!1,inDuration:e?0:void 0,onCloseEnd:function(){t.loadingModalCloseCallback&&(t.loadingModalCloseCallback(),t.loadingModalCloseCallback=void 0)}}).modal("open"))},startFreeTrial:function(){var e=this;this.showLoadingModal(!1),this.$emit("startTrialStart"),b["AjaxHelper"].post({module:"API",method:"Marketplace.startFreeTrial"},{pluginName:this.plugin.name},{createErrorNotification:!1}).then((function(){e.loadingModalCloseCallback=e.startFreeTrialSuccess,e.closeModal()})).catch((function(t){e.showErrorModal(b["Matomo"].helper.htmlDecode(t.message)),e.trialStartInProgress=!1,e.$emit("startTrialStop")})).finally((function(){e.$emit("update:modelValue",null)}))},startFreeTrialSuccess:function(){var e=b["NotificationsStore"].show({message:this.trialStartSuccessNotificationMessage,title:this.trialStartSuccessNotificationTitle,context:"success",id:"startTrialSuccess",placeat:"#notificationContainer",type:"transient"});b["NotificationsStore"].scrollToNotification(e),this.trialStartInProgress=!1,this.$emit("trialStarted")}}});Ye.render=Qe;var Ze=Ye,Xe={ref:"root",class:"modal",id:"pluginDetailsModal"},et={class:"modal-content__header"},tt=Object(r["createElementVNode"])("span",{class:"btn-close modal-close"},[Object(r["createElementVNode"])("i",{class:"icon-close"})],-1),nt={key:0,class:"plugin-metadata-part1"},at=Object(r["createElementVNode"])("h3",{class:"sr-only"},"Plugin details  part 1",-1),lt={key:0,class:"pair"},rt=Object(r["createElementVNode"])("img",{class:"star-icon reviews-icon",src:"plugins/Marketplace/images/star.svg",alt:""},null,-1),it={key:1,class:"pair"},ot={key:2,class:"pair"},ct={key:3,class:"pair"},st={key:4,class:"pair"},ut={class:"plugin-description"},dt={key:1,class:"alert alert-warning"},pt={key:2,class:"alert alert-warning"},mt={key:3,class:"alert alert-danger"},bt={key:4,class:"alert alert-warning"},gt=["innerHTML"],Ot=["innerHTML"],jt=["innerHTML"],ht=["innerHTML"],kt={class:"plugin-metadata-part2"},vt=Object(r["createElementVNode"])("hr",null,null,-1),yt=Object(r["createElementVNode"])("h3",{class:"sr-only"},"Plugin details  part 2",-1),ft={key:0,class:"pair"},Nt={key:1,class:"pair"},Vt={class:"pair"},St=["href"],Et=["href"],Bt={key:2},Mt={key:3},Tt={class:"pair"},wt=["href"],Ct=Object(r["createTextVNode"])(", "),Pt=["href"],Dt=Object(r["createTextVNode"])(", "),At=["href"],_t={key:0,class:"pair"},Lt={key:1,class:"pair"},Ut=["href"],qt={key:1},xt=["innerHTML"],Ft={key:0},Rt=["href"],It={key:1},Ht=["href"],$t=["innerHTML"],Kt={key:0,class:"plugin-screenshots"},zt=Object(r["createElementVNode"])("hr",null,null,-1),Gt={class:"thumbnails"},Qt=["src"],Wt={key:1,class:"plugin-documentation"},Jt=Object(r["createElementVNode"])("hr",null,null,-1),Yt=["innerHTML"],Zt={key:2,class:"plugin-faq"},Xt=Object(r["createElementVNode"])("hr",null,null,-1),en=["innerHTML"],tn={key:3,class:"plugin-reviews",id:"reviews"},nn=Object(r["createElementVNode"])("hr",null,null,-1),an=["id","src"],ln={key:0,class:"matomo-badge matomo-badge-modal",src:"plugins/Marketplace/images/matomo-badge.png","aria-label":"Matomo plugin",alt:""},rn={class:"cta-container cta-container-modal"},on={key:0,class:"free-trial"},cn={class:"free-trial-lead-in"},sn=["title"],un=["value","title"],dn={key:1,class:"matomo-badge matomo-badge-modal",src:"plugins/Marketplace/images/matomo-badge.png","aria-label":"Matomo plugin",alt:""};function pn(e,t,n,a,l,i){var o,c,s,u,d,p,m=this,b=Object(r["resolveComponent"])("MissingReqsNotice"),g=Object(r["resolveComponent"])("CTAContainer");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Xe,[e.isLoading?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:0,class:Object(r["normalizeClass"])(["modal-content",{"modal-content--simple-header":!e.hasHeaderMetadata}])},[Object(r["createElementVNode"])("div",et,[tt,Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.plugin&&e.plugin.displayName?e.plugin.displayName:"Plugin details"),1),e.hasHeaderMetadata?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",nt,[at,Object(r["createElementVNode"])("dl",null,[e.showReviews?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",lt,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("Marketplace_Reviews")),1),Object(r["createElementVNode"])("dd",null,[rt,Object(r["createElementVNode"])("a",{onClick:t[0]||(t[0]=function(t){return e.scrollElementIntoView("#reviews")})},Object(r["toDisplayString"])(e.pluginReviews.averageRating),1)])])):Object(r["createCommentVNode"])("",!0),e.plugin.isBundle?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",it,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Version")),1),Object(r["createElementVNode"])("dd",null,Object(r["toDisplayString"])(e.plugin.latestVersion),1)])),e.plugin.numDownloads>0?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ot,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("General_Downloads")),1),Object(r["createElementVNode"])("dd",null,Object(r["toDisplayString"])(e.plugin.numDownloadsPretty),1)])):Object(r["createCommentVNode"])("",!0),e.plugin.lastUpdated&&!e.plugin.isBundle?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ct,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("Marketplace_LastUpdated")),1),Object(r["createElementVNode"])("dd",null,Object(r["toDisplayString"])(e.plugin.lastUpdated),1)])):Object(r["createCommentVNode"])("",!0),e.plugin.isBundle?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",st,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("Marketplace_Developer")),1),Object(r["createElementVNode"])("dd",null,Object(r["toDisplayString"])(e.pluginOwner),1)]))])])):Object(r["createCommentVNode"])("",!0)]),Object(r["createElementVNode"])("div",{class:Object(r["normalizeClass"])(["modal-content__main",{"modal-content__main--with-free-trial":e.showFreeTrialDropdown}])},[Object(r["createElementVNode"])("div",ut,[e.showMissingRequirementsNoticeIfApplicable?(Object(r["openBlock"])(),Object(r["createBlock"])(b,{key:0,plugin:e.plugin},null,8,["plugin"])):Object(r["createCommentVNode"])("",!0),e.isMultiServerEnvironment?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",dt,Object(r["toDisplayString"])(e.translate("Marketplace_MultiServerEnvironmentWarning")),1)):e.isAutoUpdatePossible?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",pt,Object(r["toDisplayString"])(e.translate("Marketplace_AutoUpdateDisabledWarning","'[General]enable_auto_update=1'","'config/config.ini.php'")),1)),e.showMissingLicenseDescription?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",mt,Object(r["toDisplayString"])(e.translate("Marketplace_PluginLicenseMissingDescription")),1)):e.showExceededLicenseDescription?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",bt,Object(r["toDisplayString"])(e.translate("Marketplace_PluginLicenseExceededDescription")),1)):"Pending"!==e.plugin.licenseStatus||e.isMultiServerEnvironment?"Cancelled"!==e.plugin.licenseStatus||e.isMultiServerEnvironment?e.plugin.hasDownloadLink||e.isMultiServerEnvironment||!e.plugin.licenseStatus&&e.plugin.isPaid?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:7,class:"alert alert-warning",innerHTML:e.$sanitize(e.getDownloadLinkMissingHelpText(e.plugin.displayName))},null,8,jt)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:6,class:"alert alert-warning",innerHTML:e.$sanitize(e.getCancelledLicenseHelpText(e.plugin.displayName))},null,8,Ot)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:5,class:"alert alert-warning",innerHTML:e.$sanitize(e.getPendingLicenseHelpText(e.plugin.displayName))},null,8,gt)),Object(r["createElementVNode"])("div",{innerHTML:e.$sanitize(e.pluginDescription)},null,8,ht)]),Object(r["createElementVNode"])("div",kt,[vt,yt,Object(r["createElementVNode"])("dl",null,[e.plugin.isBundle?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ft,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Version")),1),Object(r["createElementVNode"])("dd",null,Object(r["toDisplayString"])(e.plugin.latestVersion),1)])),e.pluginKeywords?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Nt,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("Marketplace_PluginKeywords")),1),Object(r["createElementVNode"])("dd",null,Object(r["toDisplayString"])(e.pluginKeywords.join(", ")),1)])):Object(r["createCommentVNode"])("",!0),e.plugin.isBundle?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:2},[Object(r["createElementVNode"])("div",Vt,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("Marketplace_Authors")),1),Object(r["createElementVNode"])("dd",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.pluginAuthors,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:"author-".concat(n)},[t.homepage?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,target:"_blank",rel:"noreferrer noopener",href:t.homepage},Object(r["toDisplayString"])(t.name),9,St)):t.email&&e.isValidEmail(t.email)?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:1,href:"mailto:".concat(encodeURIComponent(t.email))},Object(r["toDisplayString"])(t.name),9,Et)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Bt,Object(r["toDisplayString"])(t.name),1)),n<e.pluginAuthors.length-1?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Mt,", ")):Object(r["createCommentVNode"])("",!0)],64)})),128))])]),Object(r["createElementVNode"])("div",Tt,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Websites")),1),Object(r["createElementVNode"])("dd",null,[e.plugin.homepage?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,target:"_blank",rel:"noreferrer noopener",href:e.plugin.homepage},Object(r["toDisplayString"])(e.translate("Marketplace_PluginWebsite")),9,wt)):Object(r["createCommentVNode"])("",!0),e.pluginChangelogUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:1},[e.plugin.homepage?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Ct],64)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink(e.pluginChangelogUrl)},Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Changelog")),9,Pt)],64)):Object(r["createCommentVNode"])("",!0),e.plugin.repositoryUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:2},[e.plugin.homepage||e.pluginChangelogUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Dt],64)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink(e.plugin.repositoryUrl)},"GitHub",8,At)],64)):Object(r["createCommentVNode"])("",!0)])]),e.pluginActivity&&e.pluginActivity.numCommits?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",_t,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Activity")),1),Object(r["createElementVNode"])("dd",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.plugin.activity.numCommits)+" commits ",1),(null===(o=e.pluginActivity)||void 0===o?void 0:o.numContributors)>1?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(" "+e.translate("Marketplace_ByXDevelopers",e.pluginActivity.numContributors)),1)],64)):Object(r["createCommentVNode"])("",!0),null!==(c=e.pluginActivity)&&void 0!==c&&c.lastCommitDate?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:1},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(" "+e.translate("Marketplace_LastCommitTime",e.pluginActivity.lastCommitDate)),1)],64)):Object(r["createCommentVNode"])("",!0)])])):Object(r["createCommentVNode"])("",!0),e.showLicenseName?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Lt,[Object(r["createElementVNode"])("dt",null,Object(r["toDisplayString"])(e.translate("Marketplace_License")),1),Object(r["createElementVNode"])("dd",null,[null!==(s=e.pluginLatestVersion.license)&&void 0!==s&&s.url?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,rel:"noreferrer noopener",href:null===(u=e.pluginLatestVersion.license)||void 0===u?void 0:u.url,target:"_blank"},Object(r["toDisplayString"])(null===(d=e.pluginLatestVersion.license)||void 0===d?void 0:d.name),9,Ut)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",qt,Object(r["toDisplayString"])(null===(p=e.pluginLatestVersion.license)||void 0===p?void 0:p.name),1))])])):Object(r["createCommentVNode"])("",!0),e.pluginSupport.length?(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],{key:2},Object(r["renderList"])(e.pluginSupport,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"pair",key:"support-".concat(n)},[t.name&&t.value?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Object(r["createElementVNode"])("dt",{innerHTML:e.$sanitize(t.name)},null,8,xt),m.isValidHttpUrl(t.value)?(Object(r["openBlock"])(),Object(r["createElementBlock"])("dd",Ft,[Object(r["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink(e.$sanitize(t.value))},Object(r["toDisplayString"])(e.$sanitize(t.value)),9,Rt)])):m.isValidEmail(t.value)?(Object(r["openBlock"])(),Object(r["createElementBlock"])("dd",It,[Object(r["createElementVNode"])("a",{href:"mailto:".concat(encodeURIComponent(t.value))},Object(r["toDisplayString"])(e.$sanitize(t.value)),9,Ht)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("dd",{key:2,innerHTML:e.$sanitize(t.value)},null,8,$t))],64)):Object(r["createCommentVNode"])("",!0)])})),128)):Object(r["createCommentVNode"])("",!0)],64))])]),e.pluginScreenshots.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Kt,[zt,Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("Marketplace_Screenshots")),1),Object(r["createElementVNode"])("div",Gt,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.pluginScreenshots,(function(e){return Object(r["openBlock"])(),Object(r["createElementBlock"])("figure",{key:"screenshot-".concat(e)},[Object(r["createElementVNode"])("img",{src:"".concat(e,"?w=800"),width:"800",alt:""},null,8,Qt),Object(r["createElementVNode"])("figcaption",null,Object(r["toDisplayString"])(m.getScreenshotBaseName(e)),1)])})),128))])])):Object(r["createCommentVNode"])("",!0),e.pluginDocumentation?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Wt,[Jt,Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("General_Documentation")),1),Object(r["createElementVNode"])("div",{innerHTML:e.$sanitize(e.pluginDocumentation)},null,8,Yt)])):Object(r["createCommentVNode"])("",!0),e.pluginFaq?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Zt,[Xt,Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("General_Faq")),1),Object(r["createElementVNode"])("div",{innerHTML:e.$sanitize(e.pluginFaq)},null,8,en)])):Object(r["createCommentVNode"])("",!0),e.showReviews?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",tn,[nn,Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("Marketplace_Reviews")),1),Object(r["createElementVNode"])("iframe",{class:"reviewIframe",style:Object(r["normalizeStyle"])(e.pluginReviews.height?"height: ".concat(e.pluginReviews.height,"px;"):""),id:e.pluginReviews.embedUrl.replace(/[\W_]+/g," "),src:e.pluginReviews.embedUrl},null,12,an)])):Object(r["createCommentVNode"])("",!0)],2),Object(r["createElementVNode"])("div",{class:Object(r["normalizeClass"])(["modal-content__footer",{"modal-content__footer--with-free-trial":e.showFreeTrialDropdown}])},[e.showFreeTrialDropdown&&e.isMatomoPlugin?(Object(r["openBlock"])(),Object(r["createElementBlock"])("img",ln)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("div",rn,[e.showFreeTrialDropdown?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",on,[Object(r["createElementVNode"])("div",cn,Object(r["toDisplayString"])(e.translate("Marketplace_TryFreeTrialTitle")),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("select",{class:"free-trial-dropdown",title:"".concat(e.translate("Marketplace_ShownPriceIsExclTax")," ").concat(e.translate("Marketplace_CurrentNumPiwikUsers",e.numUsers)),"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.selectedPluginShopVariationUrl=t}),onChange:t[2]||(t[2]=function(){return e.changeSelectedPluginShopVariationUrl&&e.changeSelectedPluginShopVariationUrl.apply(e,arguments)})},[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.plugin.shop.variations,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("option",{key:"var-".concat(n),value:t.addToCartUrl,title:"".concat(e.translate("Marketplace_PriceExclTax",t.price,t.currency)," ").concat(e.translate("Marketplace_CurrentNumPiwikUsers",e.numUsers))},Object(r["toDisplayString"])(t.name)+" - "+Object(r["toDisplayString"])(t.prettyPrice)+" / "+Object(r["toDisplayString"])(t.period),9,un)})),128))],40,sn),[[r["vModelSelect"],e.selectedPluginShopVariationUrl]])])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(g,{"is-super-user":e.isSuperUser,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-multi-server-environment":e.isMultiServerEnvironment,"is-valid-consumer":e.isValidConsumer,"is-auto-update-possible":e.isAutoUpdatePossible,"activate-nonce":e.activateNonce,"deactivate-nonce":e.deactivateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,plugin:e.plugin,"in-modal":!0,"shop-variation-url":e.selectedShopVariationUrl,onRequestTrial:t[3]||(t[3]=function(t){return e.emitTrialEvent("requestTrial")}),onStartFreeTrial:t[4]||(t[4]=function(t){return e.emitTrialEvent("startFreeTrial")})},null,8,["is-super-user","is-plugins-admin-enabled","is-multi-server-environment","is-valid-consumer","is-auto-update-possible","activate-nonce","deactivate-nonce","install-nonce","update-nonce","plugin","shop-variation-url"])]),!e.showFreeTrialDropdown&&e.isMatomoPlugin?(Object(r["openBlock"])(),Object(r["createElementBlock"])("img",dn)):Object(r["createCommentVNode"])("",!0)],2)],2))],512)}function mn(e,t,n,a,l,i){return Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.plugin.missingRequirements||[],(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:n,class:"alert alert-danger"},Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_MissingRequirementsNotice",e.requirement(t.requirement),t.actualVersion,t.requiredVersion)),1)})),128)}var bn=Object(r["defineComponent"])({props:{plugin:{type:Object,required:!0}},methods:{requirement:function(e){return"php"===e?"PHP":"".concat(e[0].toUpperCase()).concat(e.substr(1))}}});bn.render=mn;var gn=bn,On=window,jn=On.$,hn=Object(r["defineComponent"])({components:{MissingReqsNotice:gn,CTAContainer:Ee},props:{modelValue:{type:Object,default:function(){return{}}},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},installNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},isAutoUpdatePossible:{type:Boolean,required:!0},isValidConsumer:{type:Boolean,required:!0},isMultiServerEnvironment:{type:Boolean,required:!0},isPluginsAdminEnabled:{type:Boolean,required:!0},isSuperUser:{type:Boolean,required:!0},hasSomeAdminAccess:{type:Boolean,required:!0},numUsers:{type:Number,required:!0}},data:function(){return{isLoading:!0,currentPluginShopVariationUrl:""}},emits:["requestTrial","startFreeTrial","update:modelValue"],watch:{modelValue:function(e){e&&this.showPluginDetailsDialog()},isLoading:function(e){!1===e&&(this.applyExternalTarget(),this.applyIframeResize())}},computed:{plugin:function(){return this.modelValue},pluginLatestVersion:function(){var e=this.plugin.versions||[{}];return e[e.length-1]},pluginReadmeHtml:function(){var e;return(null===(e=this.pluginLatestVersion)||void 0===e?void 0:e.readmeHtml)||{}},pluginDescription:function(){var e;return(null===(e=this.pluginReadmeHtml)||void 0===e?void 0:e.description)||""},pluginDocumentation:function(){var e;return(null===(e=this.pluginReadmeHtml)||void 0===e?void 0:e.documentation)||""},pluginFaq:function(){var e;return(null===(e=this.pluginReadmeHtml)||void 0===e?void 0:e.faq)||""},pluginShop:function(){return this.plugin.shop},pluginShopVariations:function(){var e;return(null===(e=this.pluginShop)||void 0===e?void 0:e.variations)||[]},pluginReviews:function(){var e;return(null===(e=this.pluginShop)||void 0===e?void 0:e.reviews)||{}},pluginKeywords:function(){var e;return(null===(e=this.plugin)||void 0===e?void 0:e.keywords)||[]},pluginAuthors:function(){var e=this.plugin.authors||[];return e.filter((function(e){return e.name}))},pluginActivity:function(){return this.plugin.activity||{}},pluginChangelogUrl:function(){return this.plugin.changelog.url||""},pluginSupport:function(){return this.plugin.support||[]},isMatomoPlugin:function(){return["piwik","matomo-org"].includes(this.plugin.owner)},pluginOwner:function(){return this.isMatomoPlugin?"Matomo":this.plugin.owner},showReviews:function(){return this.pluginReviews&&this.pluginReviews.embedUrl&&this.pluginReviews.averageRating},showMissingLicenseDescription:function(){return this.hasSomeAdminAccess&&this.plugin.isMissingLicense},showExceededLicenseDescription:function(){return this.hasSomeAdminAccess&&this.plugin.hasExceededLicense},showMissingRequirementsNoticeIfApplicable:function(){return this.isSuperUser&&(this.plugin.isDownloadable||this.plugin.isInstalled)},showLicenseName:function(){var e,t=(null===(e=this.pluginLatestVersion)||void 0===e?void 0:e.license)||{};return!!t.name},showFreeTrialDropdown:function(){return this.isSuperUser&&!this.plugin.isMissingLicense&&!this.plugin.isInstalled&&!this.plugin.hasExceededLicense&&this.plugin.isEligibleForFreeTrial},pluginScreenshots:function(){return this.plugin.screenshots||[]},hasHeaderMetadata:function(){return this.showReviews||!this.plugin.isBundle||(this.plugin.numDownloads||0)>0||this.plugin.lastUpdated&&!this.plugin.isBundle},pluginShopVariationsPretty:function(){return this.pluginShopVariations.map((function(e){return"".concat(e.name," - ").concat(e.prettyPrice," / ").concat(e.period)}))},pluginShopRecommendedVariation:function(){var e=this.pluginShopVariations.filter((function(e){return e.recommended})),t=this.pluginShopVariations.length?this.pluginShopVariations[0]:null;return e.length?e[0]:t},selectedPluginShopVariationUrl:function(){var e;return this.currentPluginShopVariationUrl?this.currentPluginShopVariationUrl:(null===(e=this.pluginShopRecommendedVariation)||void 0===e?void 0:e.addToCartUrl)||""},selectedShopVariationUrl:function(){return this.selectedPluginShopVariationUrl||""}},methods:{changeSelectedPluginShopVariationUrl:function(e){e&&(this.currentPluginShopVariationUrl=e.target.value)},applyExternalTarget:function(){var e=this;setTimeout((function(){var t=e.$refs.root;jn(".modal-content__main a",t).each((function(e,t){var n=jn(t).attr("href");n&&0===n.indexOf("http")&&jn(t).attr("target","_blank")}))}))},scrollElementIntoView:function(e){var t=this;setTimeout((function(){var n=t.$refs.root,a=jn(e,n);a.length&&a[0]&&a[0].scrollIntoView&&a[0].scrollIntoView({block:"nearest",behavior:"smooth"})}))},isValidEmail:function(e){return e.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},isValidHttpUrl:function(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(n){return!1}},getProtocolAndDomain:function(e){var t=new URL(e);return"".concat(t.protocol,"//").concat(t.hostname)},applyIframeResize:function(){var e=this;setTimeout((function(){var t=window,n=t.iFrameResize;e.pluginReviews&&jn((function(){for(var t=jn("#pluginDetailsModal iframe.reviewIframe"),a=0;a<t.length;a+=1)n({checkOrigin:[e.getProtocolAndDomain(e.pluginReviews.embedUrl)]},t[a])}))}))},getScreenshotBaseName:function(e){var t=e.split("/").pop()||"";return t.substring(0,t.lastIndexOf(".")).split("_").join(" ")},emitTrialEvent:function(e){var t=this,n=this.plugin;jn("#pluginDetailsModal").modal("close"),setTimeout((function(){t.$emit(e,n)}),250)},showPluginDetailsDialog:function(){var e=this;jn("#pluginDetailsModal").modal({dismissible:!0,onCloseEnd:function(){b["MatomoUrl"].updateHash(Object.assign(Object.assign({},b["MatomoUrl"].hashParsed.value),{},{showPlugin:null})),e.$emit("update:modelValue",null),e.isLoading=!0}}).modal("open"),setTimeout((function(){e.isLoading=!1}),10)},getPendingLicenseHelpText:function(e){return Object(b["translate"])("Marketplace_PluginLicenseStatusPending",e,Object(b["externalLink"])("https://shop.matomo.org/my-account/"),"</a>")},getCancelledLicenseHelpText:function(e){return Object(b["translate"])("Marketplace_PluginLicenseStatusCancelled",e,Object(b["externalLink"])("https://shop.matomo.org/my-account/"),"</a>")},getDownloadLinkMissingHelpText:function(e){return Object(b["translate"])("Marketplace_PluginDownloadLinkMissingDescription",e,Object(b["externalLink"])("https://matomo.org/faq/plugins/faq_21/"),"</a>")}}});hn.render=pn;var kn=hn;function vn(e,t){return Sn(e)||Vn(e,t)||fn(e,t)||yn()}function yn(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fn(e,t){if(e){if("string"===typeof e)return Nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nn(e,t):void 0}}function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Vn(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,l,r=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done);i=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){o=!0,l=c}finally{try{i||null==n["return"]||n["return"]()}finally{if(o)throw l}}return r}}function Sn(e){if(Array.isArray(e))return e}var En=window,Bn=En.$,Mn=Object(r["defineComponent"])({props:{currentUserEmail:String,pluginsToShow:{type:Array,required:!0},isAutoUpdatePossible:{type:Boolean,required:!0},isSuperUser:{type:Boolean,required:!0},isValidConsumer:{type:Boolean,required:!0},isMultiServerEnvironment:{type:Boolean,required:!0},isPluginsAdminEnabled:{type:Boolean,required:!0},hasSomeAdminAccess:{type:Boolean,required:!0},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},installNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},numUsers:{type:Number,required:!0}},data:function(){return{showRequestTrialForPlugin:null,showStartFreeTrialForPlugin:null,showPluginDetailsForPlugin:null}},components:{PluginDetailsModal:kn,CTAContainer:Ee,RequestTrial:Pe,StartFreeTrial:Ze},emits:["triggerUpdate","startTrialStart","startTrialStop"],watch:{pluginsToShow:function(e,t){e&&e!==t&&(this.shrinkDescriptionIfMultilineTitle(),this.parseShowPluginParameter())}},mounted:function(){var e=this;Bn(window).resize((function(){e.shrinkDescriptionIfMultilineTitle()})),Object(r["watch"])((function(){return b["MatomoUrl"].hashParsed.value.showPlugin}),(function(t,n){t&&t!==n&&e.parseShowPluginParameter()})),this.parseShowPluginParameter()},methods:{parseShowPluginParameter:function(){var e=b["MatomoUrl"].hashParsed.value,t=e.showPlugin,n=e.pluginType,a=e.query;if(t){var l=this.pluginsToShow.filter((function(e){return e.name===t}));if(1===l.length){var r=vn(l,1),i=r[0];this.openDetailsModal(i),this.scrollPluginCardIntoView(i)}else""===n&&""===a||b["MatomoUrl"].updateHash(Object.assign(Object.assign({},b["MatomoUrl"].hashParsed.value),{},{pluginType:"plugins",query:null}))}},shrinkDescriptionIfMultilineTitle:function(){var e=Bn(".marketplace .card-holder");e&&e.length&&e.each((function(e,t){var n=Bn(t),a=n.find(".card-title"),l=n.find(".card-content-bottom .alert"),r=n.hasClass("card-with-downloads"),i=1;if(a.length){var o,c=+a.height(),s=+a.css("line-height").replace("px","");if(s)i=null!==(o=Math.ceil(c/s))&&void 0!==o?o:1}var u=0;if(l.length){var d,p=+l.height(),m=+l.css("line-height").replace("px","");if(m)u=null!==(d=Math.ceil(p/m))&&void 0!==d?d:1}var b=n.find(".card-description");if(b.length){var g=b[0],O=0;r?((i>=2||u>2||i+u>=4)&&(O=2),i+u>=5&&(O=1)):i+u>=5&&(O=2),O?g.setAttribute("data-clamp","".concat(O)):g.removeAttribute("data-clamp")}}))},clickCard:function(e,t){Bn(e.target).closest("a:not(.card-title-link)").length||(e.stopPropagation(),this.openDetailsModal(t))},openDetailsModal:function(e){this.showPluginDetailsForPlugin=e},scrollPluginCardIntoView:function(e){var t=Bn('.pluginListContainer .card-title:contains("'.concat(e.displayName,'")'));if(1===t.length){var n=t.parents(".card");1===n.length&&n[0].scrollIntoView&&n[0].scrollIntoView({block:"start",behavior:"smooth"})}},requestTrial:function(e){this.showRequestTrialForPlugin=e},startFreeTrial:function(e){this.showStartFreeTrialForPlugin=e}}});Mn.render=U;var Tn=Mn,wn=function(e){return"".concat(e[0].toLowerCase()).concat(e.substring(1))},Cn=Object(r["defineComponent"])({props:{pluginTypeOptions:{type:Object,required:!0},defaultSort:{type:String,required:!0},pluginSortOptions:{type:Object,required:!0},numAvailablePluginsByType:{type:Object,required:!0},currentUserEmail:String,isValidConsumer:Boolean,isSuperUser:Boolean,isAutoUpdatePossible:Boolean,isPluginsAdminEnabled:Boolean,isMultiServerEnvironment:Boolean,hasSomeAdminAccess:Boolean,installNonce:{type:String,required:!0},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},numUsers:{type:Number,required:!0}},components:{ContentBlock:b["ContentBlock"],PluginList:Tn,Field:g["Field"]},data:function(){return{loading:!1,fetchRequest:null,fetchRequestAbortController:null,pluginSort:this.defaultSort,pluginTypeFilter:"plugins",searchQuery:"",pluginsToShow:[]}},emits:["triggerUpdate","startTrialStart","startTrialStop"],mounted:function(){var e=this;b["Matomo"].postEvent("Marketplace.Marketplace.mounted",{element:this.$refs.root}),Object(r["watch"])((function(){return b["MatomoUrl"].hashParsed.value}),(function(){e.updateValuesFromHash(!1)})),this.updateValuesFromHash(!0)},unmounted:function(){b["Matomo"].postEvent("Marketplace.Marketplace.unmounted",{element:this.$refs.root})},methods:{updateValuesFromHash:function(e){var t=e,n=b["MatomoUrl"].hashParsed.value.query||"",a=b["MatomoUrl"].hashParsed.value.sort||"",l=b["MatomoUrl"].hashParsed.value.pluginType||"";(n||this.searchQuery)&&(t=t||n!==this.searchQuery,this.searchQuery=n),a&&(t=t||a!==this.pluginSort,this.pluginSort=a),l&&(t=t||l!==this.pluginTypeFilter,this.pluginTypeFilter=l),t&&this.fetchPlugins()},updateQuery:function(e){b["MatomoUrl"].updateHash(Object.assign(Object.assign({},b["MatomoUrl"].hashParsed.value),{},{query:e}))},updateType:function(e){b["MatomoUrl"].updateHash(Object.assign(Object.assign({},b["MatomoUrl"].hashParsed.value),{},{pluginType:e}))},updateSort:function(e){b["MatomoUrl"].updateHash(Object.assign(Object.assign({},b["MatomoUrl"].hashParsed.value),{},{sort:e}))},updateMarketplace:function(){var e=this;this.fetchPlugins((function(){return e.$emit("triggerUpdate")}))},fetchPlugins:function(e){var t=this;this.loading=!0,this.pluginsToShow=[],this.fetchRequestAbortController&&(this.fetchRequestAbortController.abort(),this.fetchRequestAbortController=null),this.fetchRequestAbortController=new AbortController,this.fetchRequest=b["AjaxHelper"].post({module:"Marketplace",action:"searchPlugins",format:"JSON"},{query:this.searchQuery,sort:this.pluginSort,themesOnly:this.showThemes,purchaseType:"premium"===this.pluginTypeFilter?"paid":""},{withTokenInUrl:!0,abortController:this.fetchRequestAbortController}).then((function(n){t.pluginsToShow=n,"function"===typeof e&&e()})).finally((function(){t.loading=!1,t.fetchRequestAbortController=null}))}},computed:{queryInputTitle:function(){var e=wn(Object(b["translate"])("General_Plugins")),t=this.numAvailablePluginsByType[this.pluginTypeFilter]||0;return"".concat(Object(b["translate"])("General_Search")," ").concat(t," ").concat(e,"...")},loadingMessage:function(){return Object(b["translate"])("Mobile_LoadingReport",Object(b["translate"])(this.showThemes?"CorePluginsAdmin_Themes":"General_Plugins"))},showThemes:function(){return"themes"===this.pluginTypeFilter}}});Cn.render=m;var Pn=Cn,Dn=["innerHTML"],An={class:"manage-license-key-input"},_n={class:"ui-confirm",id:"confirmRemoveLicense",ref:"confirmRemoveLicense"},Ln=["value"],Un=["value"];function qn(e,t,n,a,l,i){var o=Object(r["resolveComponent"])("InstallAllPaidPluginsButton"),c=Object(r["resolveComponent"])("Field"),s=Object(r["resolveComponent"])("SaveButton"),u=Object(r["resolveComponent"])("ActivityIndicator"),d=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createVNode"])(d,{"content-title":e.translate("Marketplace_LicenseKey"),class:"manage-license-key"},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",{class:"manage-license-key-intro",innerHTML:e.$sanitize(e.manageLicenseKeyIntro)},null,8,Dn),Object(r["createVNode"])(o,{disabled:e.isUpdating},null,8,["disabled"]),Object(r["createElementVNode"])("div",An,[Object(r["createVNode"])(c,{uicontrol:"text",name:"license_key",modelValue:e.licenseKey,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.licenseKey=t}),placeholder:e.licenseKeyPlaceholder,"full-width":!0},null,8,["modelValue","placeholder"])]),Object(r["createVNode"])(s,{onConfirm:t[1]||(t[1]=function(t){return e.updateLicense()}),value:e.saveButtonText,disabled:!e.licenseKey||e.isUpdating,id:"submit_license_key"},null,8,["value","disabled"]),e.hasValidLicense?(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:0,id:"remove_license_key",onConfirm:t[2]||(t[2]=function(t){return e.removeLicense()}),disabled:e.isUpdating,value:e.translate("General_Remove")},null,8,["disabled","value"])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(u,{loading:e.isUpdating},null,8,["loading"])]})),_:1},8,["content-title"]),Object(r["createElementVNode"])("div",_n,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("Marketplace_ConfirmRemoveLicense")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Ln),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Un)],512)],64)}var xn=Object(r["defineComponent"])({props:{hasValidLicenseKey:Boolean},components:{Field:g["Field"],ContentBlock:b["ContentBlock"],SaveButton:g["SaveButton"],ActivityIndicator:b["ActivityIndicator"],InstallAllPaidPluginsButton:g["InstallAllPaidPluginsButton"]},data:function(){return{licenseKey:"",hasValidLicense:this.hasValidLicenseKey,isUpdating:!1}},methods:{updateLicenseKey:function(e,t,n){var a=this;b["NotificationsStore"].remove("ManageLicenseKeySuccess"),b["AjaxHelper"].post({module:"API",method:"Marketplace.".concat(e),format:"JSON"},{licenseKey:this.licenseKey},{withTokenInUrl:!0}).then((function(t){a.isUpdating=!1,t&&t.value&&(b["NotificationsStore"].show({id:"ManageLicenseKeySuccess",message:n,context:"success",type:"toast"}),a.hasValidLicense="deleteLicenseKey"!==e,a.licenseKey="")}),(function(){a.isUpdating=!1}))},removeLicense:function(){var e=this;b["Matomo"].helper.modalConfirm(this.$refs.confirmRemoveLicense,{yes:function(){e.isUpdating=!0,e.updateLicenseKey("deleteLicenseKey","",Object(b["translate"])("Marketplace_LicenseKeyDeletedSuccess"))}})},updateLicense:function(){this.isUpdating=!0,this.updateLicenseKey("saveLicenseKey",this.licenseKey,Object(b["translate"])("Marketplace_LicenseKeyActivatedSuccess"))}},computed:{manageLicenseKeyIntro:function(){var e="?".concat(b["MatomoUrl"].stringify(Object.assign(Object.assign({},b["MatomoUrl"].urlParsed.value),{},{module:"Marketplace",action:"overview"})));return Object(b["translate"])("Marketplace_ManageLicenseKeyIntro",'<a href="'.concat(e,'">'),"</a>",Object(b["externalLink"])("https://shop.matomo.org/my-account"),"</a>")},licenseKeyPlaceholder:function(){return this.hasValidLicense?Object(b["translate"])("Marketplace_LicenseKeyIsValidShort"):Object(b["translate"])("Marketplace_LicenseKey")},saveButtonText:function(){return this.hasValidLicense?Object(b["translate"])("CoreUpdater_UpdateTitle"):Object(b["translate"])("Marketplace_ActivateLicenseKey")}}});xn.render=qn;var Fn=xn,Rn={class:"getNewPlugins"},In={class:"row"},Hn={class:"pluginName"},$n=Object(r["createElementVNode"])("br",null,null,-1),Kn={key:0},zn=Object(r["createElementVNode"])("br",null,null,-1),Gn=Object(r["createElementVNode"])("br",null,null,-1),Qn=[zn,Gn],Wn={class:"widgetBody"},Jn=["href"];function Yn(e,t,n,a,l,i){var o=Object(r["resolveDirective"])("plugin-name");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Rn,[Object(r["createElementVNode"])("div",In,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.plugins,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"col s12",key:t.name},[Object(r["withDirectives"])(Object(r["createElementVNode"])("h3",Hn,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.displayName),1)],512),[[o,{pluginName:t.name}]]),Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.description)+" ",1),$n,Object(r["withDirectives"])(Object(r["createElementVNode"])("a",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("General_MoreDetails")),1)],512),[[o,{pluginName:t.name}]])]),n<e.plugins.length-1?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Kn,Qn)):Object(r["createCommentVNode"])("",!0)])})),128))]),Object(r["createElementVNode"])("div",Wn,[Object(r["createElementVNode"])("a",{href:e.overviewLink},Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_ViewAllMarketplacePlugins")),9,Jn)])])}var Zn=Object(r["defineComponent"])({props:{plugins:{type:Array,required:!0}},directives:{PluginName:g["PluginName"]},computed:{overviewLink:function(){return"?".concat(b["MatomoUrl"].stringify(Object.assign(Object.assign({},b["MatomoUrl"].urlParsed.value),{},{module:"Marketplace",action:"overview"})))}}});Zn.render=Yn;var Xn=Zn,ea={class:"getNewPlugins isAdminPage",ref:"root"},ta={class:"row"},na=["title"],aa=["title"],la={key:0},ra=Object(r["createElementVNode"])("br",null,null,-1),ia=["src"],oa={class:"widgetBody"},ca=["href"];function sa(e,t,n,a,l,i){var o=Object(r["resolveDirective"])("plugin-name");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ea,[Object(r["createElementVNode"])("div",ta,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.plugins,(function(e){var t;return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"col s12 m4",key:e.name},[Object(r["withDirectives"])(Object(r["createElementVNode"])("h3",{class:"pluginName",title:e.description},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.displayName),1)],8,na),[[o,{pluginName:e.name}]]),Object(r["createElementVNode"])("p",{class:"description",title:e.description},Object(r["toDisplayString"])(e.description),9,aa),null!==(t=e.screenshots)&&void 0!==t&&t.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",la,[ra,Object(r["withDirectives"])(Object(r["createElementVNode"])("img",{class:"screenshot",src:"".concat(e.screenshots[0],"?w=600"),style:{width:"100%"},alt:""},null,8,ia),[[o,{pluginName:e.name}]])])):Object(r["createCommentVNode"])("",!0)])})),128))]),Object(r["createElementVNode"])("div",oa,[Object(r["createElementVNode"])("a",{href:e.marketplaceOverviewLink},Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_ViewAllMarketplacePlugins")),9,ca)])],512)}var ua=Object(r["defineComponent"])({props:{plugins:{type:Array,required:!0}},directives:{PluginName:g["PluginName"]},computed:{marketplaceOverviewLink:function(){return"?".concat(b["MatomoUrl"].stringify({module:"Marketplace",action:"overview"}))}}});ua.render=sa;var da=ua,pa={class:"getNewPlugins getPremiumFeatures widgetBody"},ma={key:0,class:"col s12 m12"},ba=["innerHTML"],ga={style:{"margin-bottom":"28px",color:"#5bb75b"}},Oa=Object(r["createElementVNode"])("i",{class:"icon-heart red-text"},null,-1),ja={class:"pluginName"},ha={key:0,class:"pluginSubtitle"},ka={class:"pluginBody"},va=Object(r["createElementVNode"])("br",null,null,-1),ya={class:"pluginMoreDetails"},fa={class:"widgetBody"},Na=["href"];function Va(e,t,n,a,l,i){var o=Object(r["resolveDirective"])("plugin-name");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",pa,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.pluginRows,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"row",key:n},[0===n?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ma,[Object(r["createElementVNode"])("h3",{style:{"font-weight":"bold",color:"#5bb75b"},innerHTML:e.$sanitize(e.trialHintsText)},null,8,ba),Object(r["createElementVNode"])("h3",ga,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_SupportMatomoThankYou"))+" ",1),Oa])])):Object(r["createCommentVNode"])("",!0),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"col s12 m4",key:t.name},[Object(r["withDirectives"])(Object(r["createElementVNode"])("h3",ja,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.displayName),1)],512),[[o,{pluginName:t.name}]]),t.specialOffer?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",ha,[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(e.translate("Marketplace_SpecialOffer"))+":",1),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(t.specialOffer),1)])):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("span",ka,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.isBundle?"".concat(e.translate("Marketplace_SpecialOffer"),": "):"")+Object(r["toDisplayString"])(t.description)+" ",1),va,Object(r["withDirectives"])(Object(r["createElementVNode"])("a",ya,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("General_MoreDetails")),1)],512),[[o,{pluginName:t.name}]])])])})),128))])})),128)),Object(r["createElementVNode"])("div",fa,[Object(r["createElementVNode"])("a",{href:e.overviewLink},Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_ViewAllMarketplacePlugins")),9,Na)])])}var Sa=Object(r["defineComponent"])({props:{plugins:{type:Array,required:!0}},directives:{PluginName:g["PluginName"]},computed:{trialHintsText:function(){var e=Object(b["externalRawLink"])("https://shop.matomo.org/free-trial/"),t="color:#5bb75b;text-decoration: underline;";return Object(b["translate"])("Marketplace_TrialHints",'<a style="'.concat(t,'" href="').concat(e,'" target="_blank" rel="noreferrer noopener">'),"</a>")},pluginRows:function(){var e=[];return this.plugins.forEach((function(t,n){var a=Math.floor(n/3);e[a]=e[a]||[],e[a].push(t)})),e},overviewLink:function(){var e=b["MatomoUrl"].stringify({module:"Marketplace",action:"overview"}),t=b["MatomoUrl"].stringify({pluginType:"premium"});return"?".concat(e,"#?").concat(t)}}});Sa.render=Va;var Ea=Sa,Ba={class:"marketplaceIntro"},Ma={key:0},Ta={key:1},wa={key:0,class:"installAllPaidPlugins"};function Ca(e,t,n,a,l,i){var o=this,c=Object(r["resolveComponent"])("EnrichedHeadline"),s=Object(r["resolveComponent"])("InstallAllPaidPluginsButton"),u=Object(r["resolveComponent"])("Marketplace"),d=Object(r["resolveDirective"])("content-intro");return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createElementVNode"])("h2",null,[Object(r["createVNode"])(c,{"feature-name":e.translate("CorePluginsAdmin_Marketplace")},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_Marketplace")),1)]})),_:1},8,["feature-name"])]),Object(r["createElementVNode"])("div",Ba,[e.isSuperUser?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",Ta,Object(r["toDisplayString"])(e.translate("Marketplace_IntroSuperUser")),1)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",Ma,Object(r["toDisplayString"])(e.translate("Marketplace_Intro")),1))]),e.installAllPaidPluginsVisible?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",wa,[Object(r["createVNode"])(s,{disabled:e.installDisabled},null,8,["disabled"])])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(u,{"plugin-type-options":e.pluginTypeOptions,"default-sort":e.defaultSort,"plugin-sort-options":e.pluginSortOptions,"num-available-plugins-by-type":e.numAvailablePluginsByType,"current-user-email":e.currentUserEmail,"is-auto-update-possible":e.isAutoUpdatePossible,"is-super-user":e.isSuperUser,"is-multi-server-environment":e.isMultiServerEnvironment,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-valid-consumer":e.getIsValidConsumer,"deactivate-nonce":e.deactivateNonce,"activate-nonce":e.activateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,"has-some-admin-access":e.hasSomeAdminAccess,"num-users":e.numUsers,onTriggerUpdate:t[0]||(t[0]=function(e){return o.updateOverviewData()}),onStartTrialStart:t[1]||(t[1]=function(e){return o.disableInstallAllPlugins(!0)}),onStartTrialStop:t[2]||(t[2]=function(e){return o.disableInstallAllPlugins(!1)})},null,8,["plugin-type-options","default-sort","plugin-sort-options","num-available-plugins-by-type","current-user-email","is-auto-update-possible","is-super-user","is-multi-server-environment","is-plugins-admin-enabled","is-valid-consumer","deactivate-nonce","activate-nonce","install-nonce","update-nonce","has-some-admin-access","num-users"])],512)),[[d]])}var Pa=Object(r["defineComponent"])({props:{currentUserEmail:String,inReportingMenu:Boolean,isValidConsumer:Boolean,isSuperUser:Boolean,isAutoUpdatePossible:Boolean,isPluginsAdminEnabled:Boolean,isMultiServerEnvironment:Boolean,hasSomeAdminAccess:Boolean,installNonce:{type:String,required:!0},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},isPluginUploadEnabled:Boolean,uploadLimit:[String,Number],pluginTypeOptions:{type:Object,required:!0},defaultSort:{type:String,required:!0},pluginSortOptions:{type:Object,required:!0},numAvailablePluginsByType:{type:Object,required:!0},numUsers:{type:Number,required:!0}},components:{InstallAllPaidPluginsButton:g["InstallAllPaidPluginsButton"],EnrichedHeadline:b["EnrichedHeadline"],Marketplace:Pn},directives:{ContentIntro:b["ContentIntro"]},data:function(){return{updating:!1,fetchRequest:null,fetchRequestAbortController:null,updateData:null,installDisabled:!1,installLoading:!1}},computed:{getIsValidConsumer:function(){return this.updateData&&"undefined"!==typeof this.updateData.isValidConsumer?this.updateData.isValidConsumer:this.isValidConsumer},installAllPaidPluginsVisible:function(){return this.getIsValidConsumer&&this.isSuperUser&&this.isAutoUpdatePossible&&this.isPluginsAdminEnabled||this.installDisabled&&this.installLoading},showThemes:function(){return"themes"===b["MatomoUrl"].hashParsed.value.pluginType}},methods:{disableInstallAllPlugins:function(e){this.installDisabled=!0,this.installLoading=e},enableInstallAllPlugins:function(){this.installDisabled=!1,this.installLoading=!1},updateOverviewData:function(){var e=this;this.updating=!0,this.isSuperUser&&this.disableInstallAllPlugins(!0),this.fetchRequestAbortController&&(this.fetchRequestAbortController.abort(),this.fetchRequestAbortController=null),this.fetchRequestAbortController=new AbortController,this.fetchRequest=b["AjaxHelper"].post({module:"Marketplace",action:"updateOverview",format:"JSON"},{},{withTokenInUrl:!0,abortController:this.fetchRequestAbortController}).then((function(t){e.updateData=t})).finally((function(){e.updating=!1,e.fetchRequestAbortController=null,e.enableInstallAllPlugins()}))}}});Pa.render=Ca;var Da=Pa,Aa={key:0},_a=["href"],La=Object(r["createElementVNode"])("br",null,null,-1),Ua=Object(r["createElementVNode"])("br",null,null,-1),qa=["innerHTML"],xa=Object(r["createElementVNode"])("br",null,null,-1),Fa={class:"subscriptionName"},Ra=["href"],Ia={key:1},Ha={class:"subscriptionType"},$a=["title"],Ka={key:0,class:"icon-error"},za={key:1,class:"icon-warning"},Ga={key:2,class:"icon-error"},Qa={key:3,class:"icon-ok"},Wa=["title"],Ja=Object(r["createElementVNode"])("span",{class:"icon-error"},null,-1),Ya={key:0},Za={colspan:"6"},Xa={class:"tableActionBar"},el=["href"],tl=Object(r["createElementVNode"])("span",{class:"icon-table"},null,-1),nl={key:1},al=["innerHTML"];function ll(e,t,n,a,l,i){var o=Object(r["resolveComponent"])("ContentBlock"),c=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createBlock"])(o,{"content-title":e.translate("Marketplace_OverviewPluginSubscriptions"),class:"subscriptionOverview"},{default:Object(r["withCtx"])((function(){return[e.hasLicenseKey?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Aa,[Object(r["createElementVNode"])("p",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("Marketplace_PluginSubscriptionsList"))+" ",1),e.loginUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,target:"_blank",rel:"noreferrer noopener",href:e.loginUrl},Object(r["toDisplayString"])(e.translate("Marketplace_OverviewPluginSubscriptionsAllDetails")),9,_a)):Object(r["createCommentVNode"])("",!0),La,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("Marketplace_OverviewPluginSubscriptionsMissingInfo"))+" ",1),Ua,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("Marketplace_NoValidSubscriptionNoUpdates"))+" ",1),Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("Marketplace_CurrentNumPiwikUsers","<strong>".concat(e.numUsers,"</strong>")))},null,8,qa)]),xa,Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_Name")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("Marketplace_SubscriptionType")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("Marketplace_SubscriptionStartDate")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("Marketplace_SubscriptionEndDate")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("Marketplace_SubscriptionNextPaymentDate")),1)])]),Object(r["createElementVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.subscriptions||[],(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:n},[Object(r["createElementVNode"])("td",Fa,[t.plugin.htmlUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,href:t.plugin.htmlUrl,rel:"noreferrer noopener",target:"_blank"},Object(r["toDisplayString"])(t.plugin.displayName),9,Ra)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ia,Object(r["toDisplayString"])(t.plugin.displayName),1))]),Object(r["createElementVNode"])("td",Ha,Object(r["toDisplayString"])(t.productType),1),Object(r["createElementVNode"])("td",{class:"subscriptionStatus",title:e.getSubscriptionStatusTitle(t)},[t.isValid?t.isExpiredSoon?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",za)):""!==t.status&&"Active"!==t.status?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ga)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Qa)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ka)),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(t.status)+" ",1),t.isExceeded?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:4,class:"errorMessage",title:e.translate("Marketplace_LicenseExceededPossibleCause")},[Ja,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("Marketplace_Exceeded")),1)],8,Wa)):Object(r["createCommentVNode"])("",!0)],8,$a),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.start),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.isValid&&t.nextPayment?e.translate("Marketplace_LicenseRenewsNextPaymentDate"):t.end),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.nextPayment),1)])})),128)),e.subscriptions.length?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",Ya,[Object(r["createElementVNode"])("td",Za,Object(r["toDisplayString"])(e.translate("Marketplace_NoSubscriptionsFound")),1)]))])],512),[[c]]),Object(r["createElementVNode"])("div",Xa,[Object(r["createElementVNode"])("a",{href:e.marketplaceOverviewLink,class:""},[tl,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("Marketplace_BrowseMarketplace")),1)],8,el)])])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",nl,[Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.missingLicenseText)},null,8,al)]))]})),_:1},8,["content-title"])}var rl=Object(r["defineComponent"])({props:{loginUrl:{type:String,required:!0},numUsers:{type:Number,required:!0},hasLicenseKey:Boolean,subscriptions:{type:Array,required:!0}},components:{ContentBlock:b["ContentBlock"]},directives:{ContentTable:b["ContentTable"]},methods:{getSubscriptionStatusTitle:function(e){return e.isValid?e.isExpiredSoon?Object(b["translate"])("Marketplace_SubscriptionExpiresSoon"):void 0:Object(b["translate"])("Marketplace_SubscriptionInvalid")}},computed:{marketplaceOverviewLink:function(){return"?".concat(b["MatomoUrl"].stringify({module:"Marketplace",action:"overview"}))},licenseKeyLink:function(){return"?".concat(b["MatomoUrl"].stringify({module:"Marketplace",action:"manageLicenseKey"}))},missingLicenseText:function(){return Object(b["translate"])("Marketplace_OverviewPluginSubscriptionsMissingLicenseMessage",'<a href="'.concat(this.licenseKeyLink,'">'),"</a>",'<a href="'.concat(this.marketplaceOverviewLink,'">'),"</a>")}}});rl.render=ll;var il=rl,ol={class:"richMarketplaceMenuButton"},cl=Object(r["createElementVNode"])("hr",null,null,-1),sl={class:"intro"},ul={class:"cta"},dl=Object(r["createElementVNode"])("span",{class:"icon-marketplace"},"",-1);function pl(e,t,n,a,l,i){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ol,[cl,Object(r["createElementVNode"])("p",sl,Object(r["toDisplayString"])(e.translate("Marketplace_RichMenuIntro")),1),Object(r["createElementVNode"])("p",ul,[Object(r["createElementVNode"])("a",{class:"btn btn-outline",tabindex:"5",href:"",onClick:t[0]||(t[0]=Object(r["withModifiers"])((function(t){return e.$emit("action")}),["prevent"])),onKeyup:t[1]||(t[1]=Object(r["withKeys"])((function(t){return e.$emit("action")}),["enter"]))},[dl,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("Marketplace_Marketplace")),1)],32)])])}var ml=Object(r["defineComponent"])({});ml.render=pl;var bl=ml;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["ProfessionalServices"]=t(require("CoreHome")):e["ProfessionalServices"]=t(e["CoreHome"])})("undefined"!==typeof self?self:this,(function(e){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/ProfessionalServices/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"DismissPromoWidget",(function(){return u})),"undefined"!==typeof window){var n=window.document.currentScript,r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(o.p=r[1])}var i=o("19dc");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function a(e,t){var o=e.value.widgetName,n=i["ReportingMenuStore"].activeCategory.value;return t.preventDefault(),i["Matomo"].helper.showAjaxLoading(),i["AjaxHelper"].post({method:"ProfessionalServices.dismissWidget"},{widgetName:o}).catch((function(e){throw i["Matomo"].helper.hideAjaxLoading(),e})).then((function(){i["ReportingMenuStore"].reloadMenuItems().then((function(){i["Matomo"].helper.hideAjaxLoading(),i["MatomoUrl"].updateHash("category=Dashboard_Dashboard&subcategory=1"),i["NotificationsStore"].show({id:"ProfessionalServices_PromoWidgetDismissed",animate:!1,context:"info",noclear:!0,message:Object(i["translate"])("ProfessionalServices_DismissedNotification",Object(i["translate"])(n)),type:"toast"})}))}))}var u={mounted:function(e,t){var o=t.value.widgetName;o&&(t.value.onClickHandler=a.bind(null,t),e.addEventListener("click",t.value.onClickHandler))},unmounted:function(e,t){e.removeEventListener("click",t.value.onClickHandler)}};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["CustomDimensions"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["CustomDimensions"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/CustomDimensions/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"CustomDimensionsStore",(function(){return d})),n.d(t,"Edit",(function(){return P})),n.d(t,"List",(function(){return pe})),n.d(t,"Manage",(function(){return Ne})),"undefined"!==typeof window){var i=window.document.currentScript,o=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var s=n("8bbf"),a=n("19dc");function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var m=function(){function e(){var t=this;c(this,e),u(this,"privateState",Object(s["reactive"])({customDimensions:[],availableScopes:[],extractionDimensions:[],isLoading:!1,isUpdating:!1})),u(this,"state",Object(s["computed"])((function(){return Object(s["readonly"])(t.privateState)}))),u(this,"isLoading",Object(s["computed"])((function(){return t.state.value.isLoading}))),u(this,"isUpdating",Object(s["computed"])((function(){return t.state.value.isUpdating}))),u(this,"extractionDimensions",Object(s["computed"])((function(){return t.state.value.extractionDimensions}))),u(this,"extractionDimensionsOptions",Object(s["computed"])((function(){return t.extractionDimensions.value.map((function(e){return{key:e.value,value:e.name}}))}))),u(this,"availableScopes",Object(s["computed"])((function(){return t.state.value.availableScopes}))),u(this,"customDimensions",Object(s["computed"])((function(){return t.state.value.customDimensions}))),u(this,"customDimensionsById",Object(s["computed"])((function(){var e={};return t.customDimensions.value.forEach((function(t){e["".concat(t.idcustomdimension)]=t})),e}))),u(this,"reloadPromise",null)}return l(e,[{key:"reload",value:function(){return this.privateState.customDimensions=[],this.privateState.availableScopes=[],this.privateState.extractionDimensions=[],this.reloadPromise=null,this.fetch()}},{key:"fetch",value:function(){var e=this;return this.reloadPromise||(this.privateState.isLoading=!0,this.reloadPromise=Promise.all([this.fetchConfiguredCustomDimensions(),this.fetchAvailableExtractionDimensions(),this.fetchAvailableScopes()]).finally((function(){e.privateState.isLoading=!1}))),this.reloadPromise}},{key:"fetchConfiguredCustomDimensions",value:function(){var e=this;return a["AjaxHelper"].fetch({method:"CustomDimensions.getConfiguredCustomDimensions",filter_limit:"-1"}).then((function(t){e.privateState.customDimensions=t}))}},{key:"fetchAvailableExtractionDimensions",value:function(){var e=this;return a["AjaxHelper"].fetch({method:"CustomDimensions.getAvailableExtractionDimensions",filter_limit:"-1"}).then((function(t){e.privateState.extractionDimensions=t}))}},{key:"fetchAvailableScopes",value:function(){var e=this;return a["AjaxHelper"].fetch({method:"CustomDimensions.getAvailableScopes",filter_limit:"-1"}).then((function(t){e.privateState.availableScopes=t}))}},{key:"createOrUpdateDimension",value:function(e,t){var n=this;return this.privateState.isUpdating=!0,a["AjaxHelper"].post({method:t,scope:e.scope,idDimension:e.idcustomdimension,idSite:e.idsite,name:e.name,active:e.active?"1":"0",caseSensitive:e.case_sensitive?"1":"0"},{extractions:e.extractions}).finally((function(){n.privateState.isUpdating=!1}))}}]),e}(),d=new m,p={class:"editCustomDimension"},b={class:"loadingPiwik"},v=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),f={class:"row form-group"},j={class:"col s12"},O={class:"col s12 m6"},h={class:"row"},D={class:"col s12 m6"},C={class:"col s12 m6"},g={class:"col s12"},V=["onClick"],E={class:"row"},N={class:"col s12"},S={class:"col s12 m6 form-help"},y=["value","disabled"],x=["value","disabled"],w={class:"btn cancel",type:"button",href:"#list"},k={class:"alert alert-info howToTrackInfo"},T=["innerHTML"],_=["innerHTML"],M=["innerHTML"],U=["innerHTML"];function B(e,t,n,i,o,a){var c=Object(s["resolveComponent"])("Field"),r=Object(s["resolveComponent"])("ContentBlock"),l=Object(s["resolveDirective"])("copy-to-clipboard");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",p,[Object(s["createVNode"])(r,{"content-title":e.contentTitleText},{default:Object(s["withCtx"])((function(){var n;return[Object(s["withDirectives"])(Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("span",b,[v,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[s["vShow"],e.isLoading||e.isUpdating]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",null,[Object(s["createElementVNode"])("form",{onSubmit:t[4]||(t[4]=Object(s["withModifiers"])((function(t){return e.edit?e.updateCustomDimension():e.createCustomDimension()}),["prevent"]))},[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c,{uicontrol:"text",name:"name",modelValue:e.dimension.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.dimension.name=t}),maxlength:255,required:!0,title:e.translate("General_Name"),"inline-help":e.translate("CustomDimensions_NameAllowedCharacters")},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c,{uicontrol:"checkbox",name:"active",modelValue:e.dimension.active,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.dimension.active=t}),title:e.translate("CorePluginsAdmin_Active"),"inline-help":e.translate("CustomDimensions_CannotBeDeleted")},null,8,["modelValue","title","inline-help"])]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",f,[Object(s["createElementVNode"])("h3",j,Object(s["toDisplayString"])(e.translate("CustomDimensions_ExtractValue")),1),Object(s["createElementVNode"])("div",O,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.dimension.extractions,(function(n,i){return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{class:Object(s["normalizeClass"])("".concat(i,"extraction ")),key:i},[Object(s["createElementVNode"])("div",h,[Object(s["createElementVNode"])("div",D,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c,{uicontrol:"select",name:"".concat(i,"dimension"),modelValue:n.dimension,"onUpdate:modelValue":function(e){return n.dimension=e},"full-width":!0,options:e.extractionDimensionsOptions},null,8,["name","modelValue","onUpdate:modelValue","options"])])]),Object(s["createElementVNode"])("div",C,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c,{uicontrol:"text",name:"".concat(i,"pattern"),modelValue:n.pattern,"onUpdate:modelValue":function(e){return n.pattern=e},"full-width":!0,title:"urlparam"===n.dimension?e.translate("CustomDimensions_UrlQueryStringParameter"):"eg. /blog/(.*)/"},null,8,["name","modelValue","onUpdate:modelValue","title"])])]),Object(s["createElementVNode"])("div",g,[Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"icon-plus",onClick:t[2]||(t[2]=function(t){return e.addExtraction()})},null,512),[[s["vShow"],n.pattern]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"icon-minus",onClick:function(t){return e.removeExtraction(i)}},null,8,V),[[s["vShow"],e.dimension.extractions.length>1]])])])],2)})),128)),Object(s["createElementVNode"])("div",E,[Object(s["createElementVNode"])("div",N,[Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createVNode"])(c,{uicontrol:"checkbox",name:"casesensitive",modelValue:e.dimension.case_sensitive,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.dimension.case_sensitive=t}),title:e.translate("Goals_CaseSensitive")},null,8,["modelValue","title"]),[[s["vShow"],null===(n=e.dimension.extractions[0])||void 0===n?void 0:n.pattern]])])])])]),Object(s["createElementVNode"])("div",S,Object(s["toDisplayString"])(e.translate("CustomDimensions_ExtractionsHelp")),1)],512),[[s["vShow"],e.doesScopeSupportExtraction]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{class:"btn update",type:"submit",value:e.translate("General_Update"),disabled:e.isUpdating,style:{"margin-right":"3.5px"}},null,8,y),[[s["vShow"],e.edit]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{class:"btn create",type:"submit",value:e.translate("General_Create"),disabled:e.isUpdating,style:{"margin-right":"3.5px"}},null,8,x),[[s["vShow"],e.create]]),Object(s["createElementVNode"])("a",w,Object(s["toDisplayString"])(e.translate("General_Cancel")),1)],32),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",k,[Object(s["createElementVNode"])("strong",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyTitle")),1),Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaJs")),1),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("pre",null,[Object(s["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCodeViaJs(e.dimension))},null,8,T)],512),[[l,{}]])]),Object(s["createElementVNode"])("p",{innerHTML:e.$sanitize(e.howToTrackManuallyText)},null,8,_),Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaPhp")),1),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("pre",null,[Object(s["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCodeViaPhp(e.dimension))},null,8,M)],512),[[l,{}]])]),Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaHttp")),1),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("pre",null,[Object(s["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCode)},null,8,U)],512),[[l,{}]])])],512),[[s["vShow"],e.edit]])],512),[[s["vShow"],!e.isLoading]])]})),_:1},8,["content-title"])])}var L=n("a5a2");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function A(e){return"".concat(e[0].toUpperCase()).concat(e.slice(1))}var H="customdimensions",I=Object(s["defineComponent"])({props:{dimensionId:Number,dimensionScope:{type:String,required:!0}},components:{ContentBlock:a["ContentBlock"],Field:L["Field"]},directives:{CopyToClipboard:a["CopyToClipboard"]},data:function(){return{dimension:{extractions:[]},isUpdatingDim:!1}},created:function(){this.init()},watch:{dimensionId:function(){this.init()}},methods:{removeAnyCustomDimensionNotification:function(){a["NotificationsStore"].remove(H)},showNotification:function(e,t){a["NotificationsStore"].show({message:e,context:t,id:H,type:"transient"})},init:function(){var e=this;null!==this.dimensionId&&this.removeAnyCustomDimensionNotification(),d.fetch().then((function(){if(e.edit&&e.dimensionId){var t=d.customDimensionsById.value[e.dimensionId];if(!t)return void a["MatomoUrl"].updateHashToUrl("/list");e.dimension=Object(a["clone"])(t),e.dimension&&!e.dimension.extractions.length&&e.addExtraction()}else e.create&&(e.dimension={idsite:a["Matomo"].idSite,name:"",active:!1,extractions:[],scope:e.dimensionScope,case_sensitive:!0},e.addExtraction())}))},removeExtraction:function(e){e>-1&&this.dimension.extractions.splice(e,1)},addExtraction:function(){this.doesScopeSupportExtraction&&this.dimension.extractions.push({dimension:"url",pattern:""})},createCustomDimension:function(){var e=this;this.isUpdatingDim=!0,d.createOrUpdateDimension(this.dimension,"CustomDimensions.configureNewCustomDimension").then((function(){e.showNotification(Object(a["translate"])("CustomDimensions_DimensionCreated"),"success"),d.reload(),a["MatomoUrl"].updateHashToUrl("/list")})).finally((function(){e.isUpdatingDim=!1}))},updateCustomDimension:function(){var e=this;this.isUpdatingDim=!0,d.createOrUpdateDimension(this.dimension,"CustomDimensions.configureExistingCustomDimension").then((function(){e.showNotification(Object(a["translate"])("CustomDimensions_DimensionUpdated"),"success"),d.reload(),a["MatomoUrl"].updateHashToUrl("/list")})).finally((function(){e.isUpdatingDim=!1}))},manuallyTrackCodeViaJs:function(e){return"_paq.push(['setCustomDimension', ".concat(e.idcustomdimension,", ")+"'".concat(Object(a["translate"])("CustomDimensions_ExampleValue"),"']);")},manuallyTrackCodeViaPhp:function(e){return"$tracker->setCustomDimension('".concat(e.idcustomdimension,"', ")+"'".concat(Object(a["translate"])("CustomDimensions_ExampleValue"),"');")}},computed:{isLoading:function(){return d.isLoading.value},isUpdating:function(){return d.isUpdating.value||this.isUpdatingDim},create:function(){return 0===this.dimensionId},edit:function(){return!this.create},extractionDimensionsOptions:function(){return d.extractionDimensionsOptions.value},availableScopes:function(){return d.availableScopes.value},doesScopeSupportExtraction:function(){var e,t=this;if(null===(e=this.dimension)||void 0===e||!e.scope||!this.availableScopes)return!1;var n=this.availableScopes.find((function(e){return e.value===t.dimension.scope}));return null===n||void 0===n?void 0:n.supportsExtractions},contentTitleText:function(){var e;return Object(a["translate"])("CustomDimensions_ConfigureDimension",A(this.dimensionScope),"".concat((null===(e=this.dimension)||void 0===e?void 0:e.index)||""))},howToTrackManuallyText:function(){var e="https://developer.piwik.org/guides/tracking-javascript-guide#custom-dimensions";return Object(a["translate"])("CustomDimensions_HowToTrackManuallyViaJsDetails",'<a target=_blank href="'.concat(e,'" rel="noreferrer noopener">'),"</a>")},manuallyTrackCode:function(){var e=Object(a["translate"])("CustomDimensions_ExampleValue");return"&dimension".concat(this.dimension.idcustomdimension,"=").concat(e)}}});I.render=B;var P=I,q=["innerHTML"],z={class:"loadingPiwik"},G=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),$={class:"index"},F={class:"name"},J={class:"active"},Q={class:"action"},X={colspan:"5"},Y={class:"index"},K={class:"name"},R={class:"extractions"},W={class:"active"},Z={class:"action"},ee=["href"],te={class:"tableActionBar"},ne=["disabled","onClick"],ie=Object(s["createElementVNode"])("span",{class:"icon-add"},null,-1),oe={class:"info"};function se(e,t,n,i,o,a){var c=Object(s["resolveComponent"])("EnrichedHeadline"),r=Object(s["resolveComponent"])("ContentBlock"),l=Object(s["resolveDirective"])("content-intro"),u=Object(s["resolveDirective"])("content-table");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("div",null,[Object(s["createElementVNode"])("h2",null,[Object(s["createVNode"])(c,null,{default:Object(s["withCtx"])((function(){return[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("CustomDimensions_CustomDimensions")),1)]})),_:1})]),Object(s["createElementVNode"])("p",{innerHTML:e.$sanitize(e.contentIntroText)},null,8,q),Object(s["withDirectives"])(Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("span",z,[G,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[s["vShow"],e.isLoading]])],512),[[l]]),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.availableScopes,(function(t){return Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{key:t.value},[Object(s["createVNode"])(r,{"content-title":e.translate("CustomDimensions_ScopeTitle".concat(e.ucfirst(t.value)))},{default:Object(s["withCtx"])((function(){return[Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_ScopeDescription".concat(e.ucfirst(t.value))))+" "+Object(s["toDisplayString"])(e.translate("CustomDimensions_ScopeDescription".concat(e.ucfirst(t.value),"MoreInfo"))),1),Object(s["withDirectives"])(Object(s["createElementVNode"])("table",null,[Object(s["createElementVNode"])("thead",null,[Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("th",$,Object(s["toDisplayString"])(e.translate("General_Id")),1),Object(s["createElementVNode"])("th",F,Object(s["toDisplayString"])(e.translate("General_Name")),1),Object(s["withDirectives"])(Object(s["createElementVNode"])("th",{class:"extractions"},Object(s["toDisplayString"])(e.translate("CustomDimensions_Extractions")),513),[[s["vShow"],t.supportsExtractions]]),Object(s["createElementVNode"])("th",J,Object(s["toDisplayString"])(e.translate("CorePluginsAdmin_Active")),1),Object(s["createElementVNode"])("th",Q,Object(s["toDisplayString"])(e.translate("General_Action")),1)])]),Object(s["createElementVNode"])("tbody",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("td",X,Object(s["toDisplayString"])(e.translate("CustomDimensions_NoCustomDimensionConfigured")),1)],512),[[s["vShow"],0===t.numSlotsUsed&&!e.isLoading]]),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.sortedCustomDimensionsByScope[t.value],(function(e){var n;return Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",{class:Object(s["normalizeClass"])(["customdimension",e.idcustomdimension]),key:e.idcustomdimension},[Object(s["createElementVNode"])("td",Y,Object(s["toDisplayString"])(e.idcustomdimension),1),Object(s["createElementVNode"])("td",K,Object(s["toDisplayString"])(e.name),1),Object(s["withDirectives"])(Object(s["createElementVNode"])("td",R,[Object(s["createElementVNode"])("span",{class:Object(s["normalizeClass"])({"icon-ok":null===(n=e.extractions[0])||void 0===n?void 0:n.pattern})},null,2)],512),[[s["vShow"],t.supportsExtractions]]),Object(s["createElementVNode"])("td",W,[Object(s["createElementVNode"])("span",{class:Object(s["normalizeClass"])({"icon-ok":e.active})},null,2)]),Object(s["createElementVNode"])("td",Z,[Object(s["createElementVNode"])("a",{class:"table-action icon-edit",href:"#?idDimension=".concat(e.idcustomdimension,"&scope=").concat(t.value)},null,8,ee)])],2)})),128))])],512),[[u]]),Object(s["createElementVNode"])("div",te,[Object(s["withDirectives"])(Object(s["createElementVNode"])("button",{class:"btn",disabled:!t.numSlotsLeft,onClick:function(n){return e.addDimension(t.value)}},[ie,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("CustomDimensions_ConfigureNewDimension"))+" ",1),Object(s["createElementVNode"])("span",oe,"("+Object(s["toDisplayString"])(e.translate("CustomDimensions_XofYLeft",t.numSlotsLeft,t.numSlotsAvailable))+")",1)],8,ne),[[s["vShow"],!e.isLoading]])])]})),_:2},1032,["content-title"])],512)),[[s["vShow"],!e.isLoading]])})),128))])}function ae(e){return ue(e)||le(e)||re(e)||ce()}function ce(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function re(e,t){if(e){if("string"===typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(e,t):void 0}}function le(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ue(e){if(Array.isArray(e))return me(e)}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var de=Object(s["defineComponent"])({name:"listcustomdimensions",components:{EnrichedHeadline:a["EnrichedHeadline"],ContentBlock:a["ContentBlock"]},directives:{ContentIntro:a["ContentIntro"],ContentTable:a["ContentTable"]},created:function(){d.fetch()},methods:{ucfirst:function(e){return A(e)},addDimension:function(e){a["MatomoUrl"].updateHashToUrl("/?idDimension=0&scope=".concat(e))}},computed:{isLoading:function(){return d.isLoading.value},availableScopes:function(){return d.availableScopes.value},contentIntroText:function(){var e=Object(a["translate"])("CustomDimensions_CustomDimensionsIntroNext",'<a target=_blank href="https://piwik.org/docs/custom-variables">',"</a>",'<a target=_blank href="https://piwik.org/faq/general/faq_21117">',"</a>"),t=Object(a["translate"])("CustomDimensions_CustomDimensionsIntro",'<a target=_blank href="https://piwik.org/docs/custom-dimensions">',"</a>",this.siteName);return"".concat(e).concat(t)},customDimensions:function(){return d.customDimensions.value},sortedCustomDimensions:function(){var e=ae(this.customDimensions);return e.sort((function(e,t){var n=parseInt("".concat(e.idcustomdimension),10),i=parseInt("".concat(t.idcustomdimension),10);return n-i})),e},sortedCustomDimensionsByScope:function(){var e={};return this.sortedCustomDimensions.reduce((function(e,t){return e[t.scope]=e[t.scope]||[],e[t.scope].push(t),e}),e),e},siteName:function(){return a["Matomo"].helper.htmlEntities(a["Matomo"].helper.htmlDecode(a["Matomo"].siteName))}}});de.render=se;var pe=de,be={class:"manageCustomDimensions"},ve={key:0},fe=Object(s["createElementVNode"])("br",null,null,-1),je=Object(s["createElementVNode"])("br",null,null,-1),Oe=Object(s["createElementVNode"])("br",null,null,-1),he=Object(s["createElementVNode"])("br",null,null,-1),De=["textContent"],Ce=["textContent"],ge={key:1};function Ve(e,t,n,i,o,a){var c=Object(s["resolveComponent"])("CustomDimensionsList"),r=Object(s["resolveComponent"])("ContentBlock"),l=Object(s["resolveComponent"])("CustomDimensionsEdit"),u=Object(s["resolveDirective"])("copy-to-clipboard");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",be,[e.editMode?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",ve,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c)]),Object(s["createVNode"])(r,{id:"customDimensionsCreateMoreDimensions","content-title":e.translate("CustomDimensions_IncreaseAvailableCustomDimensionsTitle")},{default:Object(s["withCtx"])((function(){return[Object(s["createElementVNode"])("p",null,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("CustomDimensions_IncreaseAvailableCustomDimensionsTakesLong"))+" ",1),fe,je,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToCreateCustomDimension"))+" ",1),Oe,he]),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("pre",null,[Object(s["createElementVNode"])("code",{textContent:Object(s["toDisplayString"])(e.addCustomDimCode)},null,8,De)],512),[[u,{}]])]),Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToManyCreateCustomDimensions"))+" "+Object(s["toDisplayString"])(e.translate("CustomDimensions_ExampleCreateCustomDimensions",5)),1),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("pre",null,[Object(s["createElementVNode"])("code",{textContent:Object(s["toDisplayString"])(e.addMultipleCustomDimCode)},null,8,Ce)],512),[[u,{}]])])]})),_:1},8,["content-title"])])),e.editMode?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",ge,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(l,{"dimension-id":e.dimensionId,"dimension-scope":e.dimensionScope},null,8,["dimension-id","dimension-scope"])])])):Object(s["createCommentVNode"])("",!0)])}var Ee=Object(s["defineComponent"])({components:{CustomDimensionsList:pe,ContentBlock:a["ContentBlock"],CustomDimensionsEdit:P},directives:{CopyToClipboard:a["CopyToClipboard"]},data:function(){return{editMode:!1,dimensionId:null,dimensionScope:""}},created:function(){var e=this;Object(s["watch"])((function(){return a["MatomoUrl"].hashParsed.value}),(function(){e.initState()})),this.initState()},methods:{getValidDimensionScope:function(e){return-1!==["action","visit"].indexOf(e)?e:""},initState:function(){var e=a["MatomoUrl"].hashParsed.value.idDimension;if(e){var t=this.getValidDimensionScope(a["MatomoUrl"].hashParsed.value.scope);if("0"===e){var n={isAllowed:!0,scope:t};if(a["Matomo"].postEvent("CustomDimensions.initAddDimension",n),n&&!n.isAllowed)return this.editMode=!1,this.dimensionId=null,void(this.dimensionScope="")}this.editMode=!0,this.dimensionId=parseInt(e,10),this.dimensionScope=t}else this.editMode=!1,this.dimensionId=null,this.dimensionScope="";a["Matomo"].helper.lazyScrollToContent()}},computed:{addCustomDimCode:function(){return"./console customdimensions:add-custom-dimension --scope=action\n./console customdimensions:add-custom-dimension --scope=visit"},addMultipleCustomDimCode:function(){return"./console customdimensions:add-custom-dimension --scope=action --count=5"}}});Ee.render=Ve;var Ne=Ee;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["JsTrackerInstallCheck"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["JsTrackerInstallCheck"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,s){return function(e){var t={};function s(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="plugins/JsTrackerInstallCheck/vue/dist/",s(s.s="fae3")}({"19dc":function(t,s){t.exports=e},"8bbf":function(e,s){e.exports=t},a5a2:function(e,t){e.exports=s},fae3:function(e,t,s){"use strict";if(s.r(t),s.d(t,"JsTrackerInstallCheck",(function(){return O})),"undefined"!==typeof window){var n=window.document.currentScript,r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(s.p=r[1])}var c=s("8bbf"),i={class:"jsTrackerInstallCheck"},o={class:"row testInstallFields"},a={class:"col s2"},l={class:"col s10"},u=["disabled","value"],d={class:"system-success success-message"},h=Object(c["createElementVNode"])("span",{class:"icon-ok"},null,-1),p={class:"system-errors test-error"},f=Object(c["createElementVNode"])("span",{class:"icon-warning"},null,-1),m=Object(c["createTextVNode"])(" "),T=["innerHTML"];function b(e,t,s,n,r,b){var k=Object(c["resolveComponent"])("Field"),g=Object(c["resolveComponent"])("ActivityIndicator");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createElementVNode"])("span",null,Object(c["toDisplayString"])(e.translate("JsTrackerInstallCheck_OptionalTestInstallationDescription")),1),Object(c["createElementVNode"])("div",i,[Object(c["createElementVNode"])("div",o,[Object(c["createElementVNode"])("div",a,[Object(c["createVNode"])(k,{uicontrol:"url",name:"baseUrl",placeholder:"https://example.com",modelValue:e.baseUrl,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.baseUrl=t}),"full-width":!0,disabled:e.isTesting},null,8,["modelValue","disabled"])]),Object(c["createElementVNode"])("div",l,[Object(c["createElementVNode"])("input",{type:"button",class:"btn testInstallBtn",onClick:t[1]||(t[1]=function(){return e.initiateTrackerTest&&e.initiateTrackerTest.apply(e,arguments)}),disabled:!e.baseUrl||e.isTesting,value:e.translate("JsTrackerInstallCheck_TestInstallationBtnText")},null,8,u)])]),Object(c["createVNode"])(g,{loading:e.isTesting,loadingMessage:e.translate("General_Testing")},null,8,["loading","loadingMessage"]),Object(c["withDirectives"])(Object(c["createElementVNode"])("div",d,[h,Object(c["createTextVNode"])(" "+Object(c["toDisplayString"])(e.translate("JsTrackerInstallCheck_JsTrackingCodeInstallCheckSuccessMessage")),1)],512),[[c["vShow"],e.isTestSuccess]]),Object(c["withDirectives"])(Object(c["createElementVNode"])("div",p,[f,m,Object(c["createElementVNode"])("span",{innerHTML:e.$sanitize(e.getTestFailureMessage)},null,8,T)],512),[[c["vShow"],e.isTestComplete&&!e.isTestSuccess]])])],64)}var k=s("19dc"),g=s("a5a2"),C=10,j=1e3,v=Object(c["defineComponent"])({components:{Field:g["Field"],ActivityIndicator:k["ActivityIndicator"]},data:function(){return{checkNonce:"",isTesting:!1,isTestComplete:!1,isTestSuccess:!1,testTimeoutCount:0,baseUrl:""}},props:{site:{type:Object,required:!0},isWordpress:{type:Boolean,required:!1,default:!1}},created:function(){this.checkWhetherSuccessWasRecorded()},watch:{site:function(){this.onSiteChange()}},methods:{onSiteChange:function(){this.checkNonce="",this.isTesting=!1,this.isTestComplete=!1,this.isTestSuccess=!1,this.testTimeoutCount=0,this.checkWhetherSuccessWasRecorded()},initiateTrackerTest:function(){var e=this;this.isTesting=!0,this.isTestComplete=!1,this.isTestSuccess=!1,this.testTimeoutCount=0;var t=this.site,s={idSite:t.id,url:""};this.baseUrl&&(s.url=this.baseUrl),k["AjaxHelper"].post({module:"API",method:"JsTrackerInstallCheck.initiateJsTrackerInstallTest"},s).then((function(t){var s=t&&t.url&&t.nonce;if(s){e.checkNonce=t.nonce;var n=window.open(t.url);e.setCheckInTime(),setTimeout((function(){n&&!n.closed&&(n.close(),e.testTimeoutCount=C)}),C*j)}})).catch((function(){e.isTesting=!1}))},setCheckInTime:function(){setTimeout(this.checkWhetherSuccessWasRecorded,j)},checkWhetherSuccessWasRecorded:function(){var e=this,t=this.site,s={idSite:t.id,nonce:""};this.checkNonce&&(s.nonce=this.checkNonce),k["AjaxHelper"].post({module:"API",method:"JsTrackerInstallCheck.wasJsTrackerInstallTestSuccessful"},s).then((function(t){if(t&&t.mainUrl&&!e.baseUrl&&(e.baseUrl=t.mainUrl),e.isTestSuccess=t&&t.isSuccess,e.checkNonce&&!e.isTestSuccess&&e.testTimeoutCount<C)return e.testTimeoutCount+=1,void e.setCheckInTime();e.isTestComplete=!!e.checkNonce,e.isTesting=!1})).catch((function(){e.isTesting=!1}))}},computed:{getTestFailureMessage:function(){var e=Object(k["externalLink"])("https://matomo.org/faq/troubleshooting/faq_58/"),t="</a>";return this.isWordpress?Object(k["translate"])("JsTrackerInstallCheck_JsTrackingCodeInstallCheckFailureMessageWordpress",'<a target="_blank" rel="noreferrer noopener" href="https://wordpress.org/plugins/wp-piwik/">WP-Matomo Integration (WP-Piwik)</a>',e,t):Object(k["translate"])("JsTrackerInstallCheck_JsTrackingCodeInstallCheckFailureMessage",e,t)}}});v.render=b;var O=v;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["TagManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["TagManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/TagManager/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ImportVersion",(function(){return p})),n.d(t,"VariableSelect",(function(){return G})),n.d(t,"VariableSelectType",(function(){return ne})),n.d(t,"FieldTextareaVariable",(function(){return ue})),n.d(t,"FieldVariableTemplate",(function(){return Te})),n.d(t,"FieldVariableTypeTemplate",(function(){return Ne})),n.d(t,"VariableEdit",(function(){return St})),n.d(t,"VariableList",(function(){return yn})),n.d(t,"VariableManage",(function(){return wn})),n.d(t,"TriggerEdit",(function(){return Sa})),n.d(t,"TriggerList",(function(){return mi})),n.d(t,"TriggerManage",(function(){return vi})),n.d(t,"TagEdit",(function(){return wo})),n.d(t,"TagList",(function(){return Cl})),n.d(t,"TagManage",(function(){return Ml})),n.d(t,"VersionEdit",(function(){return Gc})),n.d(t,"VersionList",(function(){return Ls})),n.d(t,"VersionManage",(function(){return Gs})),n.d(t,"ContainerEdit",(function(){return pd})),n.d(t,"ContainerList",(function(){return Zd})),n.d(t,"ContainerManage",(function(){return nu})),n.d(t,"ContainerDashboard",(function(){return Ju})),n.d(t,"ContainerSelector",(function(){return sg})),n.d(t,"ManageInstallTagCode",(function(){return Kg})),n.d(t,"TrackingCodeCommon",(function(){return Nb})),n.d(t,"TrackingCodePage",(function(){return _b})),n.d(t,"TrackingSPAPage",(function(){return im})),n.d(t,"Debugging",(function(){return Vp})),n.d(t,"CopyDialog",(function(){return kp})),"undefined"!==typeof window){var a=window.document.currentScript,i=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var r=n("8bbf"),o={class:"tagManagerImportVersion"},l={class:"ui-confirm",id:"confirmImportContainerVersion",ref:"confirmImportContainerVersion"},c=["value"],s=["value"];function d(e,t,n,a,i,d){var u=Object(r["resolveComponent"])("ActivityIndicator"),g=Object(r["resolveComponent"])("Field"),b=Object(r["resolveComponent"])("SaveButton"),m=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",o,[Object(r["createVNode"])(m,{"content-title":e.translate("TagManager_ImportVersion")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_VersionImportInfo")),1),Object(r["createVNode"])(u,{loading:e.isUpdating,"loading-message":e.translate("TagManager_UpdatingData")},null,8,["loading","loading-message"]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(g,{uicontrol:"text",modelValue:e.backupName,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.backupName=t}),name:"backupName",placeholder:" ",title:e.backupNameTitle,"inline-help":e.translate("TagManager_BackupVersionNameHelp")},null,8,["modelValue","title","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(g,{uicontrol:"textarea",modelValue:e.importContent,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.importContent=t}),name:"importContent",placeholder:" ","full-width":!0,title:e.translate("TagManager_VersionImportContentTitle")},null,8,["modelValue","title"])]),Object(r["createVNode"])(b,{class:"importVersion",disabled:!e.importContent,onConfirm:t[2]||(t[2]=function(t){return e.importVersion(e.backupName,e.importContent)}),value:e.translate("TagManager_VersionImportOverwriteContent")},null,8,["disabled","value"])]})),_:1},8,["content-title"]),Object(r["createElementVNode"])("div",l,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_ConfirmImportContainerVersion")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,c),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,s)],512)])}var u=n("19dc"),g=n("a5a2"),b="importContainerVersion",m=Object(r["defineComponent"])({props:{idContainer:{type:String,required:!0}},components:{ContentBlock:u["ContentBlock"],ActivityIndicator:u["ActivityIndicator"],Field:g["Field"],SaveButton:g["SaveButton"]},data:function(){return{isUpdating:!1,backupName:"",importContent:""}},methods:{showNotification:function(e,t){var n=u["NotificationsStore"].show({message:e,context:t,type:"toast",id:b});setTimeout((function(){u["NotificationsStore"].scrollToNotification(n)}),200)},importVersion:function(e,t){var n=this;if(t){var a;try{a=JSON.parse(t)}catch(i){return void this.showNotification(Object(u["translate"])("TagManager_ErrorInvalidContainerImportFormat"),"error")}"tags"in a&&"triggers"in a&&"variables"in a&&"idcontainer"in a&&"context"in a?u["Matomo"].helper.modalConfirm(this.$refs.confirmImportContainerVersion,{yes:function(){n.isUpdating=!0;var e={exportedContainerVersion:t};u["AjaxHelper"].post({method:"TagManager.importContainerVersion",idContainer:n.idContainer,backupName:n.backupName},e).then((function(){n.showNotification(Object(u["translate"])("TagManager_VersionImportSuccess"),"success"),n.isUpdating=!1,window.location.reload()})).catch((function(){n.isUpdating=!1}))}}):this.showNotification(Object(u["translate"])("TagManager_ErrorContainerVersionImportIncomplete"),"error")}}},computed:{backupNameTitle:function(){return"".concat(Object(u["translate"])("TagManager_BackupVersionName")," (").concat(Object(u["translate"])("General_Recommended"),")")}}});m.render=d;var p=m,h={class:"tagManagerManageSelect tagManagerVariableSelect"},f={class:"tableActionBar"},v=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),j={class:"collection with-header"},O={class:"collection-header"},T=["onClick"],y={class:"title"},V={class:"secondary-content"},C=["onClick","title"],N={class:"collection-header"},E=["onClick"],S={class:"title"},w={class:"secondary-content"},k=["title"],M={class:"tableActionBar"},_=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1);function D(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("ActivityIndicator");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",h,[Object(r["createVNode"])(l,{loading:e.isLoading},null,8,["loading"]),Object(r["createElementVNode"])("div",f,[Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createNewVariable",onClick:t[0]||(t[0]=function(t){return e.createVariable()})},[v,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVariable")),1)],512),[[r["vShow"],!e.isLoading]])]),Object(r["createElementVNode"])("ul",j,[Object(r["createElementVNode"])("li",O,[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(e.translate("TagManager_CustomVariables")),1)]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.containerVariables,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{class:"collection-item",onClick:function(n){return e.selectVariable(t)},key:n},[Object(r["createElementVNode"])("span",y,Object(r["toDisplayString"])(t.name)+" ("+Object(r["toDisplayString"])(e.translate("TagManager_Type"))+": "+Object(r["toDisplayString"])(t.type)+") ",1),Object(r["createElementVNode"])("span",V,[Object(r["createElementVNode"])("i",{class:"icon-edit",onClick:Object(r["withModifiers"])((function(n){return e.editVariable(t)}),["stop"]),title:e.translate("General_Edit")},null,8,C)])],8,T)})),128))]),Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_PreconfiguredVariables")),1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.preconfiguredVariables,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("ul",{class:"collection with-header",key:t.name},[Object(r["createElementVNode"])("li",N,[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(t.name),1)]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t.types,(function(t,n){return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{class:"collection-item",key:n,onClick:function(n){return e.selectVariable(t)}},[Object(r["createElementVNode"])("span",S,Object(r["toDisplayString"])(t.name),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",w,[Object(r["createElementVNode"])("i",{class:"icon-help",title:t.description},null,8,k)],512),[[r["vShow"],!!t.description]])],8,E)),[[r["vShow"],t.is_pre_configured]])})),128))])})),128)),Object(r["createElementVNode"])("div",M,[Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createNewVariable",onClick:t[1]||(t[1]=function(t){return e.createVariable()})},[_,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVariable",e.translate("TagManager_Variable"))),1)],512),[[r["vShow"],!e.isLoading]])])])}function A(e){return U(e)||L(e)||B(e)||x()}function x(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function B(e,t){if(e){if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}function L(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function U(e){if(Array.isArray(e))return P(e)}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var I=window,F=I.tagManagerHelper,H=Object(r["defineComponent"])({props:{idContainer:{type:String,required:!0},idContainerVersion:Number},components:{ActivityIndicator:u["ActivityIndicator"]},data:function(){return{preconfiguredVariables:[],containerVariables:[],isLoading:!1,actualIdContainerVersion:this.idContainerVersion}},emits:["selectVariable"],created:function(){this.fetchAvailableVariables()},watch:{idContainerVersion:function(e){this.actualIdContainerVersion=e}},methods:{fetchAvailableVariables:function(){var e=this;this.preconfiguredVariables=[],this.containerVariables=[],this.fetchContainer().then((function(t){return e.isLoading=!0,e.actualIdContainerVersion=t.draft.idcontainerversion,u["AjaxHelper"].fetch({method:"TagManager.getAvailableContainerVariables",filter_limit:"-1",idContainer:e.idContainer,idContainerVersion:e.actualIdContainerVersion}).then((function(t){e.preconfiguredVariables=[],e.containerVariables=[],e.isLoading=!1,t.forEach((function(t){var n,a=Object.assign(Object.assign({},t),{},{types:t.types.filter((function(e){return e.is_pre_configured}))});(n=e.containerVariables).push.apply(n,A(t.types.filter((function(e){return!e.is_pre_configured})))),a.types.length&&e.preconfiguredVariables.push(a)}))})).catch((function(){e.isLoading=!1}))}))},editVariable:function(e){var t=this;this.actualIdContainerVersion&&F.editVariable(this.idContainer,this.actualIdContainerVersion,e.idvariable,(function(){t.fetchAvailableVariables()}))},createVariable:function(){var e=this;this.actualIdContainerVersion&&F.editVariable(this.idContainer,this.actualIdContainerVersion,0,(function(){e.fetchAvailableVariables()}))},selectVariable:function(e){this.$emit("selectVariable",{variable:e})},fetchContainer:function(){return this.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getContainer",filter_limit:"-1",idContainer:this.idContainer})}}});H.render=D;var G=H,R={class:"tagManagerManageSelect tagManagerVariableSelectType"},q=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1);function z(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",R,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"select",name:"variableType".concat(e.variableType),class:"selectVariableType","model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.onChange(t)}),"full-width":!0,options:e.containerVariables},null,8,["name","model-value","options"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createNewVariable",onClick:t[1]||(t[1]=Object(r["withModifiers"])((function(t){return e.createVariable()}),["prevent"]))},[q,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVariable")),1)],512),[[r["vShow"],!e.isLoading]])])}function W(e){return Y(e)||J(e)||K(e)||X()}function X(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,t){if(e){if("string"===typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}function J(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Y(e){if(Array.isArray(e))return Z(e)}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Q=window,ee=Q.tagManagerHelper,te=Object(r["defineComponent"])({props:{variableTypeName:{type:String,required:!0},modelValue:String,variableType:String},components:{Field:g["Field"]},emits:["update:modelValue"],data:function(){return{containerVariables:[],isLoading:!1,idContainerVersion:null}},created:function(){this.fetchAvailableVariables()},methods:{fetchAvailableVariables:function(){var e=this;this.containerVariables=[],this.fetchContainer().then((function(t){return e.isLoading=!0,e.idContainerVersion=t.draft.idcontainerversion,u["AjaxHelper"].fetch({method:"TagManager.getAvailableContainerVariables",filter_limit:"-1",idContainer:u["MatomoUrl"].parsed.value.idContainer,idContainerVersion:e.idContainerVersion}).then((function(t){e.containerVariables=[],e.isLoading=!1,t.forEach((function(t){var n,a=t.types.filter((function(t){return t.type===e.variableType})).map((function(e){return{key:"{{".concat(e.id,"}}"),value:e.name}}));(n=e.containerVariables).push.apply(n,W(a))})),e.modelValue||1!==e.containerVariables.length||e.onChange(e.containerVariables[0].key)})).catch((function(){e.isLoading=!1}))}))},onChange:function(e){this.$emit("update:modelValue",e)},createVariable:function(){var e=this;this.idContainerVersion&&ee.editVariable(u["MatomoUrl"].parsed.value.idContainer,this.idContainerVersion,0,(function(t){e.fetchAvailableVariables(),t&&e.onChange("{{".concat(t.name,"}}"))}),this.variableType)},fetchContainer:function(){return this.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getContainer",filter_limit:"-1",idContainer:u["MatomoUrl"].parsed.value.idContainer})}}});te.render=z;var ne=te,ae={class:"fieldVariableTemplate"},ie=["type","id","name","value"],re=["title"],oe=["for","innerHTML"];function le(e,t,n,a,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ae,[Object(r["createElementVNode"])("textarea",Object(r["mergeProps"])({class:"control_".concat(e.uiControl," materialize-textarea"),type:e.uiControl,id:e.name,name:e.name,value:e.modelValue,onKeydown:t[0]||(t[0]=function(t){return e.onKeydown(t)}),onChange:t[1]||(t[1]=function(t){return e.onKeydown(t)}),placeholder:"",style:{width:"calc(100% - 40px)"}},e.uiControlAttributes,{ref:"textarea"}),null,16,ie),Object(r["createElementVNode"])("span",{class:"icon-code",style:{"margin-top":"14px",position:"absolute"},title:e.translate("TagManager_ChooseVariable"),onClick:t[2]||(t[2]=function(t){return e.selectVariable()})},null,8,re),Object(r["createElementVNode"])("label",{for:e.name,innerHTML:e.$sanitize(e.title)},null,8,oe)])}var ce=window,se=ce.tagManagerHelper,de=Object(r["defineComponent"])({props:{name:String,uiControlAttributes:Object,modelValue:String,title:String,uiControl:{type:String,required:!0}},inheritAttrs:!1,emits:["update:modelValue"],created:function(){this.onKeydown=Object(u["debounce"])(this.onKeydown.bind(this),50)},methods:{onKeydown:function(e){this.$emit("update:modelValue",e.target.value)},selectVariable:function(){var e=this;se.selectVariable((function(t){se.insertTextSnippetAtElement(e.$refs.textarea,"{{".concat(t.id,"}}"))}))}},watch:{modelValue:function(){var e=this,t=window,n=t.Materialize;setTimeout((function(){n.textareaAutoResize(e.$refs.textarea),n.updateTextFields()}))}},mounted:function(){var e=this,t=window,n=t.Materialize;setTimeout((function(){n.textareaAutoResize(e.$refs.textarea),n.updateTextFields()}))}});de.render=le;var ue=de,ge={class:"fieldVariableTemplate"},be=["type","id","name","value"],me=["title"],pe=Object(r["createElementVNode"])("br",null,null,-1),he=["for","innerHTML"];function fe(e,t,n,a,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ge,[Object(r["createElementVNode"])("input",Object(r["mergeProps"])({class:"control_".concat(e.uiControl),type:e.uiControl,id:e.name,name:e.name,value:e.modelValueText,onKeydown:t[0]||(t[0]=function(t){return e.onKeydown(t)}),onChange:t[1]||(t[1]=function(t){return e.onKeydown(t)}),placeholder:"",style:{width:"calc(100% - 40px)"}},e.uiControlAttributes,{ref:"input"}),null,16,be),Object(r["createElementVNode"])("span",{class:"icon-code",title:e.translate("TagManager_ChooseVariable"),onClick:t[2]||(t[2]=function(t){return e.selectVariable()})},null,8,me),pe,Object(r["createElementVNode"])("label",{for:e.name,innerHTML:e.$sanitize(e.title)},null,8,he)])}var ve=window,je=ve.tagManagerHelper,Oe=Object(r["defineComponent"])({props:{uiControl:{type:String,required:!0},uiControlAttributes:Object,name:String,title:String,modelValue:null},inheritAttrs:!1,emits:["update:modelValue"],computed:{modelValueText:function(){return"undefined"===typeof this.modelValue||null===this.modelValue?"":this.modelValue.toString()}},created:function(){this.onKeydown=Object(u["debounce"])(this.onKeydown.bind(this),50)},mounted:function(){setTimeout((function(){window.Materialize.updateTextFields()}))},watch:{modelValue:function(){setTimeout((function(){window.Materialize.updateTextFields()}))}},methods:{onKeydown:function(e){this.$emit("update:modelValue",e.target.value)},selectVariable:function(){var e=this;je.selectVariable((function(t){je.insertTextSnippetAtElement(e.$refs.input,"{{".concat(t.id,"}}"))}))}}});Oe.render=fe;var Te=Oe,ye=["for","innerHTML"];function Ve(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("VariableSelectType");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createVNode"])(l,{"model-value":e.modelValue,id:e.name,name:e.name,"variable-type-name":e.title,"variable-type":e.uiControlAttributes.variableType,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t)})},null,8,["model-value","id","name","variable-type-name","variable-type"]),Object(r["createElementVNode"])("label",{for:e.name,style:{"font-size":"0.8rem"},innerHTML:e.$sanitize(e.title)},null,8,ye)])}var Ce=Object(r["defineComponent"])({props:{uiControlAttributes:{type:Object,required:!0},name:String,title:String,modelValue:String},components:{VariableSelectType:ne},emits:["update:modelValue"]});Ce.render=Ve;var Ne=Ce;function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Se={class:"editVariable tagManagerManageEdit",ref:"root"},we={class:"loadingPiwik"},ke=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Me={class:"loadingPiwik"},_e=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),De={key:0,class:"form-group row"},Ae={class:"col s12"},xe={key:1},Be={class:"form-group row"},Le={class:"col s12"},Ue={key:2},Pe={class:"innerFormField"},Ie={class:"form-group row"},Fe={class:"col s12 m12"},He={for:"lookup_table"},Ge={class:"innerFormField comparisonField"},$e={class:"innerFormField"},Re={class:"innerFormField"},qe=["onClick","title"],ze={class:"entityCancel"},We={id:"confirmSelectVariableType"},Xe={class:"collection-header"},Ke=["onClick","title"],Je=["src"],Ye={class:"title"},Ze={class:"secondary-content"},Qe=["title"],et={class:"entityCancel"};function tt(e,t,n,a,i,o){var l=this,c=Object(r["resolveComponent"])("Field"),s=Object(r["resolveComponent"])("GroupedSettings"),d=Object(r["resolveComponent"])("SaveButton"),u=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Se,[Object(r["createVNode"])(u,{feature:"Tag Manager","content-title":e.editTitle},{default:Object(r["withCtx"])((function(){var n,a,i,o,u,g,b;return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",we,[ke,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",Me,[_e,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("form",{onSubmit:t[9]||(t[9]=function(t){return e.edit?e.updateVariable():e.createVariable()})},[Object(r["createElementVNode"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"alert alert-warning"},Object(r["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[r["vShow"],e.isVariableDisabled]]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"text",name:"name","model-value":e.variable.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.variable.name=t,e.setValueHasChanged()}),maxlength:255,title:e.translate("General_Name"),"inline-help":e.translate("TagManager_VariableNameHelp"),placeholder:e.translate("TagManager_VariableNamePlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"textarea",name:"description","model-value":e.variable.description,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.variable.description=t,e.setValueHasChanged()}),maxlength:1e3,title:e.translate("TagManager_Description"),"inline-help":e.translate("TagManager_VariableDescriptionHelp"),placeholder:e.translate("TagManager_VariableDescriptionPlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),null!==(n=e.variable.typeMetadata)&&void 0!==n&&null!==(a=n.parameters)&&void 0!==a&&a.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",De,[Object(r["createElementVNode"])("div",Ae,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("TagManager_ConfigureThisVariable")),1)])])):Object(r["createCommentVNode"])("",!0),e.variable?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",xe,[Object(r["createVNode"])(s,{settings:(null===(i=e.variable.typeMetadata)||void 0===i?void 0:i.parameters)||[],"all-setting-values":e.parameterValues,onChange:t[2]||(t[2]=function(t){return e.parameterValues[t.name]=t.value})},null,8,["settings","all-setting-values"])])):Object(r["createCommentVNode"])("",!0),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Be,[Object(r["createElementVNode"])("div",Le,[Object(r["createElementVNode"])("h3",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"showAdvancedSettings",onClick:t[3]||(t[3]=Object(r["withModifiers"])((function(t){return e.showAdvanced=!0}),["prevent"]))},Object(r["toDisplayString"])(e.translate("TagManager_ShowAdvancedSettings")),513),[[r["vShow"],!e.showAdvanced]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"hideAdvancedSettings",onClick:t[4]||(t[4]=Object(r["withModifiers"])((function(t){return e.showAdvanced=!1}),["prevent"]))},Object(r["toDisplayString"])(e.translate("TagManager_HideAdvancedSettings")),513),[[r["vShow"],e.showAdvanced]])])])],512),[[r["vShow"],null===(o=e.variable.typeMetadata)||void 0===o?void 0:o.hasAdvancedSettings]]),e.variable&&e.variable.typeMetadata&&"MatomoConfiguration"===e.variable.typeMetadata.id?Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Ue,[Object(r["createVNode"])(s,{settings:(null===(u=e.variable.typeMetadata)||void 0===u?void 0:u.advancedParameters)||[],"all-setting-values":e.parameterValues,onChange:t[5]||(t[5]=function(t){return e.parameterValues[t.name]=t.value})},null,8,["settings","all-setting-values"])],512)),[[r["vShow"],e.showAdvanced&&(null===(g=e.variable.typeMetadata)||void 0===g?void 0:g.hasAdvancedSettings)]]):Object(r["createCommentVNode"])("",!0),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",Pe,[Object(r["createVNode"])(c,{uicontrol:"text",name:"default_value","model-value":e.variable.default_value,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.variable.default_value=t,e.setValueHasChanged()}),title:e.translate("TagManager_DefaultValue"),"inline-help":e.translate("TagManager_DefaultValueHelp"),placeholder:e.translate("TagManager_DefaultValuePlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createElementVNode"])("div",Ie,[Object(r["createElementVNode"])("div",Fe,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",He,Object(r["toDisplayString"])(e.translate("TagManager_LookupTableTitle")),1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.variable.lookup_table,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:n,class:Object(r["normalizeClass"])("lookupTable lookupTable".concat(n," multiple valign-wrapper"))},[Object(r["createElementVNode"])("div",Ge,[Object(r["createVNode"])(c,{uicontrol:"select",name:"lookup_table_comparison","model-value":t.comparison,"onUpdate:modelValue":function(n){t.comparison=n,e.setValueHasChanged()},"full-width":!0,options:e.availableLookUpComparisons},null,8,["model-value","onUpdate:modelValue","options"])]),Object(r["createElementVNode"])("div",$e,[Object(r["createVNode"])(c,{uicontrol:"text",name:"lookup_table_matchvalue","model-value":t.match_value,"onUpdate:modelValue":function(n){t.match_value=n,e.setValueHasChanged()},"full-width":!0,placeholder:e.translate("TagManager_LookupTableMatchValue")},null,8,["model-value","onUpdate:modelValue","placeholder"])]),Object(r["createElementVNode"])("div",Re,[Object(r["createVNode"])(c,{uicontrol:"text",name:"lookup_table_outvalue","model-value":t.out_value,"onUpdate:modelValue":function(n){t.out_value=n,e.setValueHasChanged()},"full-width":!0,placeholder:e.translate("TagManager_LookupTableOutValue")},null,8,["model-value","onUpdate:modelValue","placeholder"])]),n+1!==e.variable.lookup_table.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:0,class:"icon-minus valign",onClick:function(t){return e.removeLookUpEntry(n)},title:e.translate("General_Remove")},null,8,qe)):Object(r["createCommentVNode"])("",!0)],2)})),128))])])])],512),[[r["vShow"],e.showAdvanced&&(null===(b=e.variable.typeMetadata)||void 0===b?void 0:b.hasAdvancedSettings)&&e.variable&&e.variable.typeMetadata&&"MatomoConfiguration"!==e.variable.typeMetadata.id]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"alert alert-warning"},Object(r["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[r["vShow"],e.isVariableDisabled]]),Object(r["withDirectives"])(Object(r["createVNode"])(d,{class:"createButton",onConfirm:t[7]||(t[7]=function(t){return e.edit?e.updateVariable():e.createVariable()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.edit?e.translate("CoreUpdater_UpdateTitle"):e.translate("TagManager_CreateNewVariable")},null,8,["disabled","saving","value"]),[[r["vShow"],!e.isVariableDisabled]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",ze,[Object(r["createElementVNode"])("a",{onClick:t[8]||(t[8]=Object(r["withModifiers"])((function(t){return e.cancel()}),["prevent"]))},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[r["vShow"],!e.isEmbedded]])])],544),[[r["vShow"],!e.chooseVariableType&&e.editTitle]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",We,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.availableVariables,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("ul",{class:"collection with-header",key:n},[Object(r["createElementVNode"])("li",Xe,[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(t.name),1)]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t.types,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:n,class:Object(r["normalizeClass"])(["collection-item avatar",Ee({disabledTemplate:l.isVariableTemplateDisabled[t.id]},"templateType".concat(t.id),!0)]),onClick:function(n){return e.createVariableType(t)},title:l.isVariableTemplateDisabled[t.id]?e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates")):""},[t.icon?(Object(r["openBlock"])(),Object(r["createElementBlock"])("img",{key:0,alt:"",class:"circle",src:t.icon},null,8,Je)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("span",Ye,Object(r["toDisplayString"])(t.name),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(t.description),513),[[r["vShow"],t.description]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",Ze,[Object(r["createElementVNode"])("i",{class:"icon-help",title:t.help},null,8,Qe)],512),[[r["vShow"],!!t.help]])],10,Ke)})),128))])})),128)),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",et,[Object(r["createElementVNode"])("a",{onClick:t[10]||(t[10]=Object(r["withModifiers"])((function(t){return e.cancel()}),["prevent"]))},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[r["vShow"],!e.isEmbedded]])],512),[[r["vShow"],e.chooseVariableType]])]})),_:1},8,["content-title"])],512)}function nt(e,t){return rt(e)||it(e,t)||st(e,t)||at()}function at(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function it(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function rt(e){if(Array.isArray(e))return e}function ot(e){return ot="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(e)}function lt(e){return ut(e)||dt(e)||st(e)||ct()}function ct(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function st(e,t){if(e){if("string"===typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gt(e,t):void 0}}function dt(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ut(e){if(Array.isArray(e))return gt(e)}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function pt(e,t,n){return t&&mt(e.prototype,t),n&&mt(e,n),e}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var ft=function(){function e(){var t=this;bt(this,e),ht(this,"privateState",Object(r["reactive"])({variables:[],isLoadingVars:!1,isLoadingSingle:!1,isUpdating:!1})),ht(this,"state",Object(r["computed"])((function(){return t.privateState}))),ht(this,"isLoading",Object(r["computed"])((function(){var e=t.state.value;return e.isLoadingVars||e.isLoadingSingle}))),ht(this,"isUpdating",Object(r["computed"])((function(){return t.state.value.isUpdating}))),ht(this,"variables",Object(r["computed"])((function(){return t.state.value.variables}))),ht(this,"fetchPromise",null),ht(this,"availableVariablesPromises",{})}return pt(e,[{key:"fetchVariablesIfNotLoaded",value:function(e,t){this.fetchPromise||this.fetchVariables(e,t)}},{key:"findVariable",value:function(e,t,n,a){var i=this,r=this.variables.value.find((function(e){return e.idvariable===n}));return r&&!a?Promise.resolve(r):(this.privateState.isLoadingSingle=!0,u["AjaxHelper"].fetch({idVariable:n,idContainer:e,idContainerVersion:t,method:"TagManager.getContainerVariable",filter_limit:"-1"}).then((function(e){return i.privateState.variables=[].concat(lt(i.privateState.variables),[e]),e})).finally((function(){i.privateState.isLoadingSingle=!1})))}},{key:"fetchVariables",value:function(e,t){var n=this;return this.privateState.isLoadingVars=!0,this.privateState.variables=[],this.fetchPromise||(this.fetchPromise=u["AjaxHelper"].fetch({method:"TagManager.getContainerVariables",idContainer:e,idContainerVersion:t,filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(e){return n.privateState.variables=e,n.privateState.isLoadingVars=!1,n.variables.value})).finally((function(){n.privateState.isLoadingVars=!1}))}},{key:"fetchAvailableVariables",value:function(e){return this.availableVariablesPromises[e]||(this.availableVariablesPromises[e]=u["AjaxHelper"].fetch({method:"TagManager.getAvailableVariableTypesInContext",idContext:e,filter_limit:"-1"}).then((function(e){return e}))),Promise.resolve(this.availableVariablesPromises[e])}},{key:"suggestNameForType",value:function(e){for(var t=this,n=function(n){var a=e;n&&(a="".concat(a," (").concat(n,")"));var i=!t.variables.value.some((function(e){return e.name===a}));if(i)return{v:a}},a=0;a<100;a+=1){var i=n(a);if("object"===ot(i))return i.v}}},{key:"createOrUpdateVariable",value:function(e,t,n,a,i){var r=this;this.privateState.isUpdating=!0;var o=Object.entries(i).map((function(e){var t=nt(e,2),n=t[0],a=t[1],i=a;return"boolean"===typeof a&&(i=(+a).toString()),[n,i]})),l=Object.fromEntries(o),c=e.lookup_table.filter((function(e){return e&&e.out_value&&e.comparison}));return u["AjaxHelper"].post({idVariable:e.idvariable,method:t,idContainer:n,idContainerVersion:a,type:e.type,name:e.name,description:e.description,defaultValue:e.default_value},{parameters:l,lookupTable:c},{withTokenInUrl:!0}).finally((function(){r.privateState.isUpdating=!1}))}},{key:"reload",value:function(e,t){return this.privateState.variables=[],this.fetchPromise=null,this.availableVariablesPromises={},this.fetchVariables(e,t)}},{key:"deleteVariable",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,this.privateState.variables=[],u["AjaxHelper"].fetch({idVariable:n,idContainerVersion:t,idContainer:e,method:"TagManager.deleteContainerVariable"},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}}]),e}(),vt=new ft;function jt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ot(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Tt(e,t,n){return t&&Ot(e.prototype,t),n&&Ot(e,n),e}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Vt=function(){function e(){var t=this;jt(this,e),yt(this,"privateState",Object(r["reactive"])({comparisons:[],isLoading:!1})),yt(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),yt(this,"isLoading",Object(r["computed"])((function(){return t.state.value.isLoading}))),yt(this,"comparisons",Object(r["computed"])((function(){return t.state.value.comparisons}))),yt(this,"comparisonOptions",Object(r["computed"])((function(){return t.comparisons.value.map((function(e){var t=e.id,n=e.name;return{key:t,value:n}}))}))),yt(this,"initializePromise",null)}return Tt(e,[{key:"init",value:function(){return this.initializePromise||(this.initializePromise=this.fetchAvailableComparisons()),this.initializePromise}},{key:"fetchAvailableComparisons",value:function(){var e=this;return this.privateState.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getAvailableComparisons",filter_limit:"-1"}).then((function(t){e.privateState.comparisons=t})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),Ct=new Vt,Nt="tagvariablemanagement",Et=Object(r["defineComponent"])({props:{idVariable:Number,idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},variableType:String,isEmbedded:{type:Boolean,default:!1}},components:{GroupedSettings:g["GroupedSettings"],ContentBlock:u["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"]},data:function(){return{isDirty:!1,showAdvanced:!1,chooseVariableType:!1,canUseCustomTemplates:u["Matomo"].hasUserCapability("tagmanager_use_custom_templates"),availableVariables:[],editTitle:"",variable:{},parameterValues:{},advancedParameters:{},isUpdatingVar:!1}},emits:["changeVariable"],created:function(){Ct.init(),vt.fetchVariablesIfNotLoaded(this.idContainer,this.idContainerVersion),this.initIdVariable()},watch:{idVariable:function(e){null!==e&&this.initIdVariable()},variableParameterValues:{handler:function(e,t){e&&t&&(this.isDirty=!0)},deep:!0},variableLookupTable:{handler:function(){var e=(this.variable.lookup_table||[]).every((function(e){return!(null===e||void 0===e||!e.out_value)}));e&&this.addLookUpEntry()},deep:!0}},methods:{removeAnyVariableNotification:function(){u["NotificationsStore"].remove(Nt),u["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=u["NotificationsStore"].show({message:e,context:t,id:Nt,type:null!==n?n:"toast"});setTimeout((function(){u["NotificationsStore"].scrollToNotification(a)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(u["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdVariable:function(){var e=this;u["Matomo"].helper.lazyScrollToContent(),this.availableVariables=[],u["AjaxHelper"].fetch({method:"TagManager.getContainer",idContainer:this.idContainer,filter_limit:"-1"}).then((function(e){return vt.fetchAvailableVariables(e.context)})).then((function(t){e.availableVariables=t})).then((function(){if(e.edit&&e.idVariable)return e.editTitle=Object(u["translate"])("TagManager_EditVariable"),void vt.findVariable(e.idContainer,e.idContainerVersion,e.idVariable,e.isEmbedded).then((function(t){var n;t&&(e.variable=Object(u["clone"])(t),e.variable.typeMetadata.parameters=t.typeMetadata.parameters.filter((function(e){return!Object.prototype.hasOwnProperty.call(e,"uiControlAttributes")||!Object.prototype.hasOwnProperty.call(e.uiControlAttributes,"showAdvancedSettings")})),e.variable.typeMetadata.advancedParameters=t.typeMetadata.parameters.filter((function(e){return Object.prototype.hasOwnProperty.call(e,"uiControlAttributes")&&Object.prototype.hasOwnProperty.call(e.uiControlAttributes,"showAdvancedSettings")})),e.parameterValues=Object.fromEntries(t.typeMetadata.parameters.map((function(e){return[e.name,e.value]}))),(e.variable.lookup_table&&e.variable.lookup_table.length||e.variable.default_value)&&(e.showAdvanced=!0),e.addLookUpEntryIfNoneExists(),e.isDirty=!1,null!==(n=e.variable.typeMetadata)&&void 0!==n&&n.name&&(e.editTitle+=": ".concat(e.variable.typeMetadata.name)))}));if(e.create){var t=!1;e.variableType&&e.availableVariables.forEach((function(n){if(!t){var a=n.types.find((function(t){return(null===t||void 0===t?void 0:t.id)===e.variableType}));a&&(t=!0,e.createVariableType(a))}})),t||(e.editTitle=Object(u["translate"])("TagManager_ChooseVariableToContinue"),e.chooseVariableType=!0)}}))},addLookUpEntryIfNoneExists:function(){this.variable.lookup_table&&Array.isArray(this.variable.lookup_table)||(this.variable.lookup_table=[]),this.variable.lookup_table.length||this.variable.lookup_table.push({comparison:"equals",match_value:"",out_value:""})},addLookUpEntry:function(){this.variable.lookup_table.push({comparison:"equals",match_value:"",out_value:""}),this.isDirty=!0},removeLookUpEntry:function(e){e>-1&&(this.variable.lookup_table.splice(e,1),this.isDirty=!0)},createVariableType:function(e){var t,n=this;if(!e||!this.isVariableTemplateDisabled[e.id]){this.chooseVariableType=!1,this.editTitle=Object(u["translate"])("TagManager_CreateNewVariable"),this.variable={idsite:parseInt("".concat(u["Matomo"].idSite),10),name:vt.suggestNameForType(e.name)||"",description:"",type:e.id,idcontainer:this.idContainer,idcontainerversion:this.idContainerVersion,default_value:"",lookup_table:[],typeMetadata:e},this.variable.typeMetadata.advancedParameters=[];var a=e.parameters.filter((function(e){return Object.prototype.hasOwnProperty.call(e,"uiControlAttributes")&&Object.prototype.hasOwnProperty.call(e.uiControlAttributes,"showAdvancedSettings")})),i=e.parameters.filter((function(e){return!Object.prototype.hasOwnProperty.call(e,"uiControlAttributes")||!Object.prototype.hasOwnProperty.call(e.uiControlAttributes,"showAdvancedSettings")}));this.parameterValues=Object.fromEntries(e.parameters.map((function(e){return[e.name,e.value]}))),this.variable.typeMetadata.advancedParameters=a,this.variable.typeMetadata.parameters=i,null!==(t=this.variable.typeMetadata)&&void 0!==t&&t.name&&(this.editTitle+=": ".concat(this.variable.typeMetadata.name)),this.addLookUpEntry(),this.isDirty=!0,Object(r["nextTick"])((function(){if(n.$refs.root){var e=n.$refs.root;e.scrollIntoView();var t=e.querySelector("#name");t&&t.focus()}}))}},cancel:function(){var e=Object.assign({},u["MatomoUrl"].hashParsed.value);delete e.idVariable,u["MatomoUrl"].updateHash(e)},createVariable:function(){var e=this;this.removeAnyVariableNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVar=!0,vt.createOrUpdateVariable(Object.assign(Object.assign({},this.variable),{},{name:encodeURIComponent(this.variable.name)}),"TagManager.addContainerVariable",this.idContainer,this.idContainerVersion,this.parameterValues).then((function(t){if(t){e.isDirty=!1;var n=t.value;vt.reload(e.idContainer,e.idContainerVersion).then((function(){if(e.isEmbedded)return e.variable.idvariable=n,void e.$emit("changeVariable",{variable:e.variable});e.cancel(),setTimeout((function(){var t=Object(u["translate"])("TagManager_CreatedX",Object(u["translate"])("TagManager_Variable"));if(e.hasPublishCapability()){var n=Object(u["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(t," ").concat(n),"success","transient")}else e.showNotification(t,"success")}),200)}))}})).finally((function(){e.isUpdatingVar=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateVariable:function(){var e=this;this.removeAnyVariableNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVar=!0,vt.createOrUpdateVariable(Object.assign(Object.assign({},this.variable),{},{name:encodeURIComponent(this.variable.name)}),"TagManager.updateContainerVariable",this.idContainer,this.idContainerVersion,this.parameterValues).then((function(t){if(t)if(e.isEmbedded)e.$emit("changeVariable",{variable:e.variable});else{e.isDirty=!1,vt.reload(e.idContainer,e.idContainerVersion).then((function(){e.initIdVariable()})),e.cancel();var n=Object(u["translate"])("TagManager_UpdatedX",Object(u["translate"])("TagManager_Variable"));if(e.hasPublishCapability()){var a=Object(u["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(n," ").concat(a),"success","transient")}else e.showNotification(n,"success")}})).finally((function(){e.isUpdatingVar=!1})))},checkRequiredFieldsAreSet:function(){return!!this.variable.name||(this.showErrorFieldNotProvidedNotification(Object(u["translate"])("General_Name")),!1)},hasPublishCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_write")&&u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")}},computed:{typeInlineHelp:function(){var e,t,n=(null===(e=this.variable.typeMetadata)||void 0===e?void 0:e.description)||"",a=(null===(t=this.variable.typeMetadata)||void 0===t?void 0:t.help)||"";return"".concat(n," ").concat(a)},create:function(){return 0===this.idVariable},edit:function(){return!this.create},isLoading:function(){return vt.isLoading.value||Ct.isLoading.value},isUpdating:function(){return vt.isUpdating.value||this.isUpdatingVar},availableLookUpComparisons:function(){return Ct.comparisonOptions.value},isVariableTemplateDisabled:function(){var e=this,t={};return this.availableVariables.forEach((function(n){n.types.forEach((function(n){t[n.id]=!e.canUseCustomTemplates&&n.isCustomTemplate}))})),t},isVariableDisabled:function(){var e;return!this.canUseCustomTemplates&&(null===(e=this.variable.typeMetadata)||void 0===e?void 0:e.isCustomTemplate)},variableParameterValues:function(){var e;return null!==(e=this.variable.typeMetadata)&&void 0!==e&&e.parameters?this.parameterValues:null},variableLookupTable:function(){return this.variable.lookup_table}}});Et.render=tt;var St=Et,wt={class:"tagManagerManageList tagManagerVariableList"},kt={class:"variableSearchFilter"},Mt=["title"],_t=["title"],Dt=["title"],At=["title"],xt=["title"],Bt=["title"],Lt={colspan:"7"},Ut={class:"loadingPiwik"},Pt=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),It={colspan:"7"},Ft=["id"],Ht=["title"],Gt=["title"],$t=["title"],Rt={class:"lookupTable"},qt={class:"icon-ok"},zt=["title"],Wt=["onClick","title"],Xt=["onClick","title"],Kt=["onClick","title"],Jt={class:"tableActionBar"},Yt=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),Zt=["title"],Qt=Object(r["createElementVNode"])("span",{class:"icon-help preconfiguredVariablesHelp"},null,-1),en={class:"collection-header"},tn={class:"title"},nn=["textContent"],an={class:"secondary-content"},rn=["title"],on={class:"ui-confirm",id:"confirmDeleteVariable",ref:"confirmDeleteVariable"},ln=["value"],cn=["value"],sn={class:"ui-confirm",id:"confirmDeleteVariableNotPossible",ref:"confirmDeleteVariableNotPossible"},dn={class:"collection"},un=["value"];function gn(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("ContentBlock"),s=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",wt,[Object(r["createVNode"])(c,{feature:"Tag Manager",class:"tagManagerCustomVariablesList","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Variables")),"help-text":e.variablesHelpText},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_VariableUsageBenefits")),1),Object(r["createElementVNode"])("div",kt,[Object(r["withDirectives"])(Object(r["createVNode"])(l,{uicontrol:"text",name:"variableSearch",title:e.translate("General_Search"),modelValue:e.variableSearch,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.variableSearch=t})},null,8,["title","modelValue"]),[[r["vShow"],e.variables.length>0]])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",{class:"name",title:e.nameTranslatedText},Object(r["toDisplayString"])(e.translate("General_Name")),9,Mt),Object(r["createElementVNode"])("th",{class:"description",title:e.descriptionTranslatedText},Object(r["toDisplayString"])(e.translate("General_Description")),9,_t),Object(r["createElementVNode"])("th",{class:"type",title:e.typeTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_Type")),9,Dt),Object(r["createElementVNode"])("th",{class:"lookupTable",title:e.lookupTableTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_LookupTable")),9,At),Object(r["createElementVNode"])("th",{class:"lastUpdated",title:e.lastUpdatedTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_LastUpdated")),9,xt),Object(r["withDirectives"])(Object(r["createElementVNode"])("th",{class:"action",title:e.actionTranslatedText},Object(r["toDisplayString"])(e.translate("General_Actions")),9,Bt),[[r["vShow"],e.hasWriteAccess]])])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Lt,[Object(r["createElementVNode"])("span",Ut,[Pt,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",It,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_NoVariablesFound"))+" ",1),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createContainerVariableNow",onClick:t[1]||(t[1]=function(t){return e.createVariable()})},Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVariableNow")),513),[[r["vShow"],e.hasWriteAccess]])])],512),[[r["vShow"],!e.isLoading&&!e.variables.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedVariables,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{id:"variable".concat(t.idvariable),class:"variables",key:t.idvariable},[Object(r["createElementVNode"])("td",{class:"name",title:t.name},Object(r["toDisplayString"])(e.truncateText(t.name,50)),9,Ht),Object(r["createElementVNode"])("td",{class:"description",title:t.description},Object(r["toDisplayString"])(e.truncateText(t.description,75)),9,Gt),Object(r["createElementVNode"])("td",{class:"type",title:t.typeMetadata.description},Object(r["toDisplayString"])(t.typeMetadata.name),9,$t),Object(r["createElementVNode"])("td",Rt,[Object(r["withDirectives"])(Object(r["createElementVNode"])("span",qt,null,512),[[r["vShow"],t.lookup_table.length]])]),Object(r["createElementVNode"])("td",{class:"lastUpdated",title:e.translate("TagManager_CreatedOnX",t.created_date_pretty)},[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(t.updated_date_pretty),1)],8,zt),Object(r["withDirectives"])(Object(r["createElementVNode"])("td",{class:Object(r["normalizeClass"])(e.getActionClasses)},[Object(r["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editVariable(t.idvariable,t.type)},title:e.translate("TagManager_EditVariable")},null,8,Wt),Object(r["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteVariable(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Variable"))},null,8,Xt),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-content-copy",onClick:function(n){return e.openCopyDialog(t)},title:e.translate("TagManager_CopyX",e.translate("TagManager_Variable"))},null,8,Kt),[[r["vShow"],e.hasPublishCapability()]])],2),[[r["vShow"],e.hasWriteAccess]])],8,Ft)})),128))])],512),[[s]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Jt,[Object(r["createElementVNode"])("a",{class:"createNewVariable",value:"",onClick:t[2]||(t[2]=function(t){return e.createVariable()})},[Yt,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVariable")),1)])],512),[[r["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title","help-text"]),Object(r["createElementVNode"])("h2",{title:e.translate("TagManager_PreConfiguredInfoTitle")},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_PreconfiguredVariables"))+" ",1),Qt],8,Zt),Object(r["createElementVNode"])("div",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.containerVariables,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("ul",{class:"collection with-header",key:t},[Object(r["createElementVNode"])("li",en,[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(e.name),1)]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.types,(function(e){return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{class:"collection-item",key:e.id},[Object(r["createElementVNode"])("span",tn,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.name)+" ",1),Object(r["createElementVNode"])("span",{class:"variableId",textContent:Object(r["toDisplayString"])("{{".concat(e.id,"}}"))},null,8,nn)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",an,[Object(r["createElementVNode"])("i",{class:"icon-help",title:e.description},null,8,rn)],512),[[r["vShow"],!!e.description]])],512)),[[r["vShow"],e.is_pre_configured]])})),128))])})),128))]),Object(r["createElementVNode"])("div",on,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_DeleteVariableConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ln),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,cn)],512),Object(r["createElementVNode"])("div",sn,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_VariableCannotBeDeleted")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_VariableBeingUsedBy")),1),Object(r["createElementVNode"])("ul",dn,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.variableReferences,(function(e){return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{class:"collection-item",key:"".concat(e.referenceType,".").concat(e.referenceId)},Object(r["toDisplayString"])(e.referenceTypeName)+": "+Object(r["toDisplayString"])(e.referenceName),1)})),128))]),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_VariableBeingUsedNeedsRemove")),1),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_Cancel")},null,8,un)],512)])}function bn(e){return fn(e)||hn(e)||pn(e)||mn()}function mn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pn(e,t){if(e){if("string"===typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vn(e,t):void 0}}function hn(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function fn(e){if(Array.isArray(e))return vn(e)}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var jn=window,On=jn.tagManagerHelper,Tn=Object(r["defineComponent"])({props:{idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},variablesHelpText:String},components:{Field:g["Field"],ContentBlock:u["ContentBlock"]},directives:{ContentTable:u["ContentTable"]},data:function(){return{hasWriteAccess:u["Matomo"].hasUserCapability("tagmanager_write"),variableReferences:[],containerVariables:[],variableSearch:""}},created:function(){var e=this;vt.fetchVariables(this.idContainer,this.idContainerVersion),u["AjaxHelper"].fetch({method:"TagManager.getAvailableContainerVariables",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,filter_limit:"-1"}).then((function(t){e.containerVariables=t}))},methods:{createVariable:function(){this.editVariable(0)},editVariable:function(e){u["MatomoUrl"].updateHash(Object.assign(Object.assign({},u["MatomoUrl"].hashParsed.value),{},{idVariable:e}))},deleteVariable:function(e){var t=this;u["AjaxHelper"].fetch({method:"TagManager.getContainerVariableReferences",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,idVariable:e.idvariable}).then((function(n){n&&n.length?(t.variableReferences=n,u["Matomo"].helper.modalConfirm(t.$refs.confirmDeleteVariableNotPossible,{})):(t.variableReferences=[],u["Matomo"].helper.modalConfirm(t.$refs.confirmDeleteVariable,{yes:function(){vt.deleteVariable(t.idContainer,t.idContainerVersion,e.idvariable).then((function(){vt.reload(t.idContainer,t.idContainerVersion),u["NotificationsStore"].remove("CopyDialogResultNotification")}))}}))}))},truncateText:function(e,t){return On.truncateText(e,t)},hasPublishCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_write")&&u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},openCopyDialog:function(e){var t=u["MatomoUrl"].stringify({module:"TagManager",action:"copyVariableDialog",idSite:e.idsite,idContainer:this.idContainer,idVariable:e.idvariable,idContainerVersion:this.idContainerVersion});window.Piwik_Popover.createPopupAndLoadUrl(t,"","mtmCopyVariable")}},computed:{isLoading:function(){return vt.isLoading.value},isUpdating:function(){return vt.isUpdating.value},variables:function(){return vt.variables.value},sortedVariables:function(){var e=this.variableSearch.toLowerCase(),t=bn(this.variables).filter((function(t){return Object.keys(t).some((function(n){var a=t,i="";if("string"===typeof a[n])i=a[n];else if("typeMetadata"===n){var r=a.typeMetadata;i=r.name}else if("parameters"===n&&"CustomJsFunction"===a.type){var o=a.parameters;i=o.jsFunction}return-1!==i.toLowerCase().indexOf(e)}))}));return t.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),t},nameTranslatedText:function(){return this.translate("TagManager_VariablesNameDescription")},descriptionTranslatedText:function(){return this.translate("TagManager_VariablesDescriptionDescription")},typeTranslatedText:function(){return this.translate("TagManager_VariablesTypeDescription")},lookupTableTranslatedText:function(){return this.translate("TagManager_VariablesLookupTableDescription")},lastUpdatedTranslatedText:function(){return this.translate("TagManager_VariablesLastUpdatedDescription")},actionTranslatedText:function(){return this.translate("TagManager_VariablesActionDescription")},getActionClasses:function(){var e=this.hasPublishCapability()?" hasCopyAction":"";return"action".concat(e)}}});Tn.render=gn;var yn=Tn,Vn={class:"manageVariable"},Cn={key:0},Nn={key:1};function En(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("VariableList"),c=Object(r["resolveComponent"])("VariableEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Vn,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Cn,[Object(r["createVNode"])(l,{"id-container-version":e.idContainerVersion,"id-container":e.idContainer,"variables-help-text":e.variablesHelpText},null,8,["id-container-version","id-container","variables-help-text"])])),e.editMode?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Nn,[Object(r["createVNode"])(c,{"id-container-version":e.idContainerVersion,"id-container":e.idContainer,"id-variable":e.idVariable},null,8,["id-container-version","id-container","id-variable"])])):Object(r["createCommentVNode"])("",!0)])}var Sn=Object(r["defineComponent"])({props:{idContainerVersion:Number,idContainer:String,variablesHelpText:String},components:{VariableList:yn,VariableEdit:St},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(r["watch"])((function(){return u["MatomoUrl"].hashParsed.value.idVariable}),(function(t){e.onIdVariableParamChange(t)})),u["NotificationsStore"].remove("variablevariablemanagement"),this.onIdVariableParamChange(u["MatomoUrl"].hashParsed.value.idVariable)},methods:{onIdVariableParamChange:function(e){if("0"===e){var t={isAllowed:!0};u["Matomo"].postEvent("TagManager.initAddVariable",t),this.isAddAllowed=!!t.isAllowed}}},computed:{idVariable:function(){var e=u["MatomoUrl"].hashParsed.value.idVariable;return this.isAddAllowed||"0"!==e?e?parseInt(e,10):e:null},editMode:function(){return"number"===typeof this.idVariable}}});Sn.render=En;var wn=Sn;function kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mn={class:"editTrigger tagManagerManageEdit",ref:"root"},_n={class:"loadingPiwik"},Dn=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),An={class:"loadingPiwik"},xn=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Bn={class:"form-group row"},Ln={class:"col s12"},Un={key:0},Pn={class:"form-group row"},In={class:"col s12"},Fn={class:"form-group row multiple"},Hn={class:"col s12 input-field m6"},Gn={class:"col s12 input-field m6"},$n={class:"form-help"},Rn=["innerHTML"],qn={class:"col s12 m12"},zn={class:"innerFormField"},Wn={class:"innerFormField comparisonField"},Xn={class:"innerFormField"},Kn=["onClick","title"],Jn={class:"triggerConditionNode"},Yn={class:"entityCancel"},Zn={id:"confirmSelectTriggerType"},Qn={class:"collection-header"},ea=["onClick","title"],ta=["src"],na={class:"title"},aa={class:"secondary-content"},ia=["title"],ra={class:"entityCancel"};function oa(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("GroupedSettings"),s=Object(r["resolveComponent"])("SaveButton"),d=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Mn,[Object(r["createVNode"])(d,{feature:"Tag Manager","content-title":e.editTitle},{default:Object(r["withCtx"])((function(){var n,a,i,o,d;return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",_n,[Dn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",An,[xn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("form",{onSubmit:t[5]||(t[5]=function(t){return e.edit?e.updateTrigger():e.createTrigger()})},[Object(r["createElementVNode"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"alert alert-warning"},Object(r["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[r["vShow"],e.isTriggerDisabled]]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"text",name:"name","model-value":e.trigger.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.trigger.name=t,e.setValueHasChanged()}),maxlength:255,title:e.translate("General_Name"),"inline-help":e.translate("TagManager_TriggerNameHelp"),placeholder:e.translate("TagManager_TriggerNamePlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"textarea",name:"description","model-value":e.trigger.description,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.trigger.description=t,e.setValueHasChanged()}),maxlength:1e3,title:e.translate("TagManager_Description"),"inline-help":e.translate("TagManager_TriggerDescriptionHelp"),placeholder:e.translate("TagManager_TriggerDescriptionPlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Bn,[Object(r["createElementVNode"])("div",Ln,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("TagManager_ConfigureThisTrigger")),1)])],512),[[r["vShow"],null===(n=e.trigger.typeMetadata)||void 0===n||null===(a=n.parameters)||void 0===a?void 0:a.length]]),e.trigger?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Un,[Object(r["createVNode"])(c,{settings:(null===(i=e.trigger.typeMetadata)||void 0===i?void 0:i.parameters)||[],"all-setting-values":e.parameterValues,onChange:t[2]||(t[2]=function(t){return e.parameterValues[t.name]=t.value})},null,8,["settings","all-setting-values"])])):Object(r["createCommentVNode"])("",!0),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Pn,[Object(r["createElementVNode"])("div",In,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("TagManager_OnlyTriggerWhen"))+" "+Object(r["toDisplayString"])(e.translate("Goals_Optional")),1)])],512),[[r["vShow"],null===(o=e.trigger.typeMetadata)||void 0===o?void 0:o.hasAdvancedSettings]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",Fn,[Object(r["createElementVNode"])("div",Hn,[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_TriggerConditionsHelp")),1)]),Object(r["createElementVNode"])("div",Gn,[Object(r["createElementVNode"])("div",$n,[Object(r["createElementVNode"])("span",{class:"inline-help",innerHTML:e.$sanitize(e.triggerInlineHelpText)},null,8,Rn)])]),Object(r["createElementVNode"])("div",qn,[Object(r["createElementVNode"])("div",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.trigger.conditions,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:n,class:Object(r["normalizeClass"])(["condition multiple valign-wrapper","condition".concat(n)])},[Object(r["createElementVNode"])("div",zn,[Object(r["createVNode"])(l,{uicontrol:"expandable-select",name:"condition_actual","model-value":t.actual,"onUpdate:modelValue":function(n){t.actual=n,e.setValueHasChanged()},"full-width":!0,options:e.availableVariables,title:e.variableIdToName[t.actual]||t.actual},null,8,["model-value","onUpdate:modelValue","options","title"])]),Object(r["createElementVNode"])("div",Wn,[Object(r["createVNode"])(l,{uicontrol:"select",name:"condition_comparison","model-value":t.comparison,"onUpdate:modelValue":function(n){t.comparison=n,e.setValueHasChanged()},"full-width":!0,options:e.availableComparisons},null,8,["model-value","onUpdate:modelValue","options"])]),Object(r["createElementVNode"])("div",Xn,[Object(r["createVNode"])(l,{uicontrol:"text",name:"condition_expected","model-value":t.expected,"onUpdate:modelValue":function(n){t.expected=n,e.setValueHasChanged(),e.onConditionChange()},"full-width":!0},null,8,["model-value","onUpdate:modelValue"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-minus valign",onClick:function(t){return e.removeConditionEntry(n)},title:e.translate("General_Remove")},null,8,Kn),[[r["vShow"],!(n+1===e.trigger.conditions.length)]])],2)})),128))]),Object(r["createElementVNode"])("p",Jn,Object(r["toDisplayString"])(e.translate("TagManager_TriggerConditionNode")),1)])])],512),[[r["vShow"],null===(d=e.trigger.typeMetadata)||void 0===d?void 0:d.hasAdvancedSettings]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"alert alert-warning"},Object(r["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[r["vShow"],e.isTriggerDisabled]]),Object(r["withDirectives"])(Object(r["createVNode"])(s,{class:"createButton",onConfirm:t[3]||(t[3]=function(t){return e.edit?e.updateTrigger():e.createTrigger()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),[[r["vShow"],!e.isTriggerDisabled]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Yn,[Object(r["createElementVNode"])("a",{onClick:t[4]||(t[4]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[r["vShow"],!e.isEmbedded]])])],544),[[r["vShow"],!e.chooseTriggerType&&e.editTitle]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Zn,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.availableTriggers,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("ul",{class:"collection with-header",key:n},[Object(r["createElementVNode"])("li",Qn,[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(t.name),1)]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t.types,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{class:Object(r["normalizeClass"])(["collection-item avatar",kn({disabledTemplate:e.isTriggerTemplateDisabled[t.id]},"templateType".concat(t.id),!0)]),onClick:function(n){return e.createTriggerType(t)},key:n,title:e.isTriggerTemplateDisabled[t.id]?e.collectionItemAvatarText:""},[t.icon?(Object(r["openBlock"])(),Object(r["createElementBlock"])("img",{key:0,alt:"",class:"circle",src:t.icon},null,8,ta)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("span",na,Object(r["toDisplayString"])(t.name),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(t.description),513),[[r["vShow"],t.description]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",aa,[Object(r["createElementVNode"])("i",{class:"icon-help",title:t.help},null,8,ia)],512),[[r["vShow"],!!t.help]])],10,ea)})),128))])})),128)),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",ra,[Object(r["createElementVNode"])("a",{onClick:t[6]||(t[6]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[r["vShow"],!e.isEmbedded]])],512),[[r["vShow"],e.chooseTriggerType]])]})),_:1},8,["content-title"])],512)}function la(e,t){return da(e)||sa(e,t)||ma(e,t)||ca()}function ca(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sa(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function da(e){if(Array.isArray(e))return e}function ua(e){return ua="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ua(e)}function ga(e){return ha(e)||pa(e)||ma(e)||ba()}function ba(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ma(e,t){if(e){if("string"===typeof e)return fa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fa(e,t):void 0}}function pa(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ha(e){if(Array.isArray(e))return fa(e)}function fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function va(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ja(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Oa(e,t,n){return t&&ja(e.prototype,t),n&&ja(e,n),e}function Ta(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var ya=function(){function e(){var t=this;va(this,e),Ta(this,"privateState",Object(r["reactive"])({triggers:[],isLoadingTriggers:!1,isLoadingSingle:!1,isUpdating:!1})),Ta(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),Ta(this,"isUpdating",Object(r["computed"])((function(){return t.state.value.isUpdating}))),Ta(this,"isLoading",Object(r["computed"])((function(){var e=t.state.value;return e.isLoadingTriggers||e.isLoadingSingle}))),Ta(this,"triggers",Object(r["computed"])((function(){return t.state.value.triggers}))),Ta(this,"fetchPromise",null),Ta(this,"availableTriggersPromises",{})}return Oa(e,[{key:"fetchTriggers",value:function(e,t){var n=this;return this.privateState.triggers=[],this.privateState.isLoadingTriggers=!0,this.fetchPromise||(this.fetchPromise=u["AjaxHelper"].fetch({method:"TagManager.getContainerTriggers",idContainer:e,idContainerVersion:t,filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(e){return n.privateState.triggers=e,n.triggers.value})).finally((function(){n.privateState.isLoadingTriggers=!1}))}},{key:"fetchTriggersIfNotLoaded",value:function(e,t){this.fetchPromise||this.fetchTriggers(e,t)}},{key:"fetchAvailableTriggers",value:function(e){return this.availableTriggersPromises[e]||(this.availableTriggersPromises[e]=u["AjaxHelper"].fetch({method:"TagManager.getAvailableTriggerTypesInContext",idContext:e,filter_limit:"-1"})),Promise.resolve(this.availableTriggersPromises[e])}},{key:"findTrigger",value:function(e,t,n){var a=this,i=this.triggers.value.find((function(e){return e.idtrigger===n}));return i?Promise.resolve(i):(this.privateState.isLoadingSingle=!0,u["AjaxHelper"].fetch({idTrigger:n,idContainer:e,idContainerVersion:t,method:"TagManager.getContainerTrigger",filter_limit:"-1"}).then((function(e){return a.privateState.triggers=[].concat(ga(a.privateState.triggers),[e]),Object(r["readonly"])(e)})).finally((function(){a.privateState.isLoadingSingle=!1})))}},{key:"suggestNameForType",value:function(e){for(var t=this,n=function(n){var a=e;n&&(a="".concat(a," (").concat(n,")"));var i=!t.triggers.value.some((function(e){return e.name===a}));if(i)return{v:a}},a=0;a<100;a+=1){var i=n(a);if("object"===ua(i))return i.v}}},{key:"createOrUpdateTrigger",value:function(e,t,n,a,i){var r=this,o=Object.entries(i).map((function(e){var t=la(e,2),n=t[0],a=t[1],i=a;return"boolean"===typeof a&&(i=(+a).toString()),[n,i]})),l=Object.fromEntries(o),c=e.conditions.filter((function(e){return e&&e.actual&&e.comparison&&e.expected}));return this.privateState.isUpdating=!0,u["AjaxHelper"].post({idTrigger:e.idtrigger,method:t,idContainer:n,idContainerVersion:a,type:e.type,name:e.name,description:e.description},{parameters:l,conditions:c},{withTokenInUrl:!0}).finally((function(){r.privateState.isUpdating=!1}))}},{key:"reload",value:function(e,t){return this.privateState.triggers=[],this.fetchPromise=null,this.availableTriggersPromises={},this.fetchTriggers(e,t)}},{key:"deleteTrigger",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,this.privateState.triggers=[],u["AjaxHelper"].fetch({idTrigger:n,idContainerVersion:t,idContainer:e,method:"TagManager.deleteContainerTrigger"},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}}]),e}(),Va=new ya,Ca="tagvariablemanagement",Na={AllElementsClick:"ClickId",AllLinksClick:"ClickId",DownloadClick:"ClickId",ElementVisibility:"VisibleElementClasses",FormSubmit:"FormId",JavaScriptError:"ErrorMessage"},Ea=Object(r["defineComponent"])({props:{idTrigger:Number,idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},newTriggerType:String,isEmbedded:{type:Boolean,default:!1}},components:{ContentBlock:u["ContentBlock"],Field:g["Field"],GroupedSettings:g["GroupedSettings"],SaveButton:g["SaveButton"]},data:function(){return{isDirty:!1,chooseTriggerType:!1,availableTriggers:[],availableVariables:[],variableIdToName:{},editTitle:"",trigger:{},parameterValues:{},isUpdatingTrigger:!1}},emits:["changeTrigger"],created:function(){var e=this;Ct.init(),u["AjaxHelper"].fetch({method:"TagManager.getAvailableContainerVariables",filter_limit:"-1",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion}).then((function(t){t.forEach((function(t){t.types.forEach((function(n){e.variableIdToName[n.id]=n.name,e.availableVariables.push({key:n.id,value:n.name,group:t.name,tooltip:n.description})}))}))})),Va.fetchTriggersIfNotLoaded(this.idContainer,this.idContainerVersion),this.initIdTrigger()},watch:{idTrigger:function(e){null!==e&&this.initIdTrigger()},triggerParameterValues:{handler:function(e,t){e&&t&&(this.isDirty=!0)},deep:!0}},methods:{checkRequiredFieldsAreSet:function(){return!!this.trigger.name||(this.showErrorFieldNotProvidedNotification(Object(u["translate"])("General_Name")),!1)},removeAnyTriggerNotification:function(){u["NotificationsStore"].remove(Ca),u["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=u["NotificationsStore"].show({message:e,context:t,id:Ca,type:null!==n?n:"toast"});setTimeout((function(){u["NotificationsStore"].scrollToNotification(a)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(u["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdTrigger:function(){var e=this;this.trigger={},this.chooseTriggerType=!1,this.editTitle="",u["Matomo"].helper.lazyScrollToContent(),this.availableTriggers=[],u["AjaxHelper"].fetch({method:"TagManager.getContainer",idContainer:this.idContainer,filter_limit:"-1"}).then((function(e){return Va.fetchAvailableTriggers(e.context)})).then((function(t){e.availableTriggers=t})).then((function(){if(e.edit&&e.idTrigger)return e.editTitle=Object(u["translate"])("TagManager_EditTrigger"),void Va.findTrigger(e.idContainer,e.idContainerVersion,e.idTrigger).then((function(t){var n;t&&(e.trigger=Object(u["clone"])(t),e.parameterValues=Object.fromEntries(t.typeMetadata.parameters.map((function(e){return[e.name,e.value]}))),e.addConditionEntryIfNoneExists(),e.onConditionChange(),e.isDirty=!1,null!==(n=e.trigger.typeMetadata)&&void 0!==n&&n.name&&(e.editTitle+=": ".concat(e.trigger.typeMetadata.name)))}));e.create&&(e.editTitle=Object(u["translate"])("TagManager_ChooseTriggerToContinue"),e.chooseTriggerType=!0)}))},onConditionChange:function(){var e=(this.trigger.conditions||[]).every((function(e){return!(null===e||void 0===e||!e.expected)}));e&&this.addConditionEntry()},addConditionEntryIfNoneExists:function(){this.trigger.conditions&&Array.isArray(this.trigger.conditions)||(this.trigger.conditions=[]),this.trigger.conditions.length||this.trigger.conditions.push(this.makeDefaultCondition())},addConditionEntry:function(){this.trigger.conditions.push(this.makeDefaultCondition()),this.isDirty=!0},removeConditionEntry:function(e){if(e>-1){var t=this.trigger.conditions.length-1;t===e?this.trigger.conditions[e]=this.makeDefaultCondition():this.trigger.conditions.splice(e,1),this.isDirty=!0}},createTriggerType:function(e){var t,n=this;e&&this.isTriggerTemplateDisabled[e.id]||(this.chooseTriggerType=!1,this.editTitle=Object(u["translate"])("TagManager_CreateNewTrigger"),this.trigger={idsite:parseInt("".concat(u["Matomo"].idSite),10),name:Va.suggestNameForType(e.name)||"",description:"",type:e.id,idcontainerversion:this.idContainerVersion,conditions:[],typeMetadata:e},null!==(t=this.trigger.typeMetadata)&&void 0!==t&&t.name&&(this.editTitle+=": ".concat(this.trigger.typeMetadata.name)),this.parameterValues=Object.fromEntries(e.parameters.map((function(e){return[e.name,e.value]}))),this.addConditionEntry(),this.isDirty=!0,Object(r["nextTick"])((function(){if(n.$refs.root){var e=n.$refs.root;e.scrollIntoView();var t=e.querySelector("#name");t&&t.focus()}})))},cancel:function(){var e=Object.assign({},u["MatomoUrl"].hashParsed.value);delete e.idTrigger,u["MatomoUrl"].updateHash(e)},createTrigger:function(){var e=this;this.removeAnyTriggerNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingTrigger=!0,Va.createOrUpdateTrigger(this.trigger,"TagManager.addContainerTrigger",this.idContainer,this.idContainerVersion,this.parameterValues).then((function(t){var n=t.value;e.isDirty=!1,Va.reload(e.idContainer,e.idContainerVersion).then((function(){if(e.isEmbedded)return e.trigger.idtrigger=n,void e.$emit("changeTrigger",{trigger:e.trigger});e.cancel(),setTimeout((function(){var t=Object(u["translate"])("TagManager_CreatedX",Object(u["translate"])("TagManager_Trigger"));if(e.hasPublishCapability()){var n=Object(u["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(t," ").concat(n),"success","transient")}else e.showNotification(t,"success")}),200)}))})).finally((function(){e.isUpdatingTrigger=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateTrigger:function(){var e=this;this.removeAnyTriggerNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingTrigger=!0,Va.createOrUpdateTrigger(this.trigger,"TagManager.updateContainerTrigger",this.idContainer,this.idContainerVersion,this.parameterValues).then((function(t){if(t){if(e.isEmbedded)return e.$emit("changeTrigger",{trigger:e.trigger}),void Va.reload(e.idContainer,e.idContainerVersion);e.isDirty=!1,Va.reload(e.idContainer,e.idContainerVersion).then((function(){e.initIdTrigger()})),e.cancel();var n=Object(u["translate"])("TagManager_UpdatedX",Object(u["translate"])("TagManager_Trigger"));if(e.hasPublishCapability()){var a=Object(u["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(n," ").concat(a),"success","transient")}else e.showNotification(n,"success")}})).finally((function(){e.isUpdatingTrigger=!1})))},makeDefaultCondition:function(){var e,t="PageUrl";if(null!==(e=this.trigger)&&void 0!==e&&e.typeMetadata){var n=this.trigger.typeMetadata.id;Na[n]&&(t=Na[n])}return{comparison:"equals",actual:t,expected:""}},hasPublishCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_write")&&u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")}},computed:{isLoading:function(){return Va.isLoading.value||Ct.isLoading.value},isUpdating:function(){return Va.isUpdating.value||this.isUpdatingTrigger},create:function(){return 0===this.idTrigger},edit:function(){return!this.create},canUseCustomTemplates:function(){return u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},isTriggerDisabled:function(){var e;return!this.canUseCustomTemplates&&(null===(e=this.trigger.typeMetadata)||void 0===e?void 0:e.isCustomTemplate)},saveButtonText:function(){return this.edit?Object(u["translate"])("CoreUpdater_UpdateTitle"):Object(u["translate"])("TagManager_CreateNewTrigger")},collectionItemAvatarText:function(){return Object(u["translate"])("TagManager_UseCustomTemplateCapabilityRequired",Object(u["translate"])("TagManager_CapabilityUseCustomTemplates"))},triggerInlineHelpText:function(){return Object(u["translate"])("TagManager_TriggerConditionsHelpText",Object(u["externalLink"])("https://matomo.org/faq/tag-manager/create-a-trigger-to-track-interactions-on-all-nested-elements/"),"</a>")},availableComparisons:function(){return Ct.comparisonOptions.value},isTriggerTemplateDisabled:function(){var e=this,t={};return this.availableTriggers.forEach((function(n){n.types.forEach((function(n){t[n.id]=!e.canUseCustomTemplates&&n.isCustomTemplate}))})),t},triggerParameterValues:function(){var e;return null!==(e=this.trigger.typeMetadata)&&void 0!==e&&e.parameters?this.parameterValues:null}}});Ea.render=oa;var Sa=Ea,wa={class:"tagManagerManageList tagManagerTriggerList"},ka={class:"triggerSearchFilter"},Ma=["title"],_a=["title"],Da=["title"],Aa=["title"],xa=["title"],Ba=["title"],La={colspan:"7"},Ua={class:"loadingPiwik"},Pa=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Ia={colspan:"7"},Fa=["id"],Ha=["title"],Ga=["title"],$a=["title"],Ra={class:"conditions"},qa={class:"icon-ok"},za=["title"],Wa=["onClick","title"],Xa=["onClick","title"],Ka=["onClick","title"],Ja={class:"tableActionBar"},Ya=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),Za={class:"ui-confirm",id:"confirmDeleteTrigger",ref:"confirmDeleteTrigger"},Qa=["value"],ei=["value"],ti={class:"ui-confirm",id:"confirmDeleteTriggerNotPossible",ref:"confirmDeleteTriggerNotPossible"},ni={class:"collection"},ai=["value"];function ii(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("ContentBlock"),s=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",wa,[Object(r["createVNode"])(c,{feature:"Tag Manager","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Triggers")),"help-text":e.triggersHelpText},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_TriggerUsageBenefits")),1),Object(r["createElementVNode"])("div",ka,[Object(r["withDirectives"])(Object(r["createVNode"])(l,{uicontrol:"text",name:"triggerSearch",title:e.translate("General_Search"),modelValue:e.triggerSearch,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.triggerSearch=t})},null,8,["title","modelValue"]),[[r["vShow"],e.triggers.length>0]])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",{class:"name",title:e.nameTranslatedText},Object(r["toDisplayString"])(e.translate("General_Name")),9,Ma),Object(r["createElementVNode"])("th",{class:"description",title:e.descriptionTranslatedText},Object(r["toDisplayString"])(e.translate("General_Description")),9,_a),Object(r["createElementVNode"])("th",{class:"type",title:e.typeTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_Type")),9,Da),Object(r["createElementVNode"])("th",{class:"conditions",title:e.filterTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_Filter")),9,Aa),Object(r["createElementVNode"])("th",{class:"lastUpdated",title:e.lastUpdatedTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_LastUpdated")),9,xa),Object(r["withDirectives"])(Object(r["createElementVNode"])("th",{class:"action",title:e.actionTranslatedText},Object(r["toDisplayString"])(e.translate("General_Actions")),9,Ba),[[r["vShow"],e.hasWriteAccess]])])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",La,[Object(r["createElementVNode"])("span",Ua,[Pa,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Ia,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_NoTriggersFound"))+" ",1),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createContainerTriggerNow",onClick:t[1]||(t[1]=function(t){return e.createTrigger()})},Object(r["toDisplayString"])(e.translate("TagManager_CreateNewTriggerNow")),513),[[r["vShow"],e.hasWriteAccess]])])],512),[[r["vShow"],!e.isLoading&&0===e.triggers.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedTriggers,(function(t){var n;return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{id:"trigger".concat(t.idtrigger),class:"triggers",key:t.idtrigger},[Object(r["createElementVNode"])("td",{class:"name",title:t.name},Object(r["toDisplayString"])(e.truncateText(t.name,50)),9,Ha),Object(r["createElementVNode"])("td",{class:"description",title:t.description},Object(r["toDisplayString"])(e.truncateText(t.description,75)),9,Ga),Object(r["createElementVNode"])("td",{class:"type",title:t.typeMetadata.description},Object(r["toDisplayString"])(t.typeMetadata.name),9,$a),Object(r["createElementVNode"])("td",Ra,[Object(r["withDirectives"])(Object(r["createElementVNode"])("span",qa,null,512),[[r["vShow"],null===(n=t.conditions)||void 0===n?void 0:n.length]])]),Object(r["createElementVNode"])("td",{class:"lastUpdated",title:e.translate("TagManager_CreatedOnX",t.created_date_pretty)},[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(t.updated_date_pretty),1)],8,za),Object(r["withDirectives"])(Object(r["createElementVNode"])("td",{class:Object(r["normalizeClass"])(e.getActionClasses)},[Object(r["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editTrigger(t.idtrigger,t.type)},title:e.translate("TagManager_EditTrigger")},null,8,Wa),Object(r["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteTrigger(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Trigger"))},null,8,Xa),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-content-copy",onClick:function(n){return e.openCopyDialog(t)},title:e.translate("TagManager_CopyX",e.translate("TagManager_Trigger"))},null,8,Ka),[[r["vShow"],e.hasPublishCapability()]])],2),[[r["vShow"],e.hasWriteAccess]])],8,Fa)})),128))])],512),[[s]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Ja,[Object(r["createElementVNode"])("a",{class:"createNewTrigger",value:"",onClick:t[2]||(t[2]=function(t){return e.createTrigger()})},[Ya,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewTrigger")),1)])],512),[[r["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title","help-text"]),Object(r["createElementVNode"])("div",Za,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_DeleteTriggerConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Qa),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,ei)],512),Object(r["createElementVNode"])("div",ti,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_TriggerCannotBeDeleted")),1),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_TriggerBeingUsedBy")),1),Object(r["createElementVNode"])("ul",ni,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.triggerReferences,(function(e){return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{class:"collection-item",key:e.referenceId},Object(r["toDisplayString"])(e.referenceTypeName)+": "+Object(r["toDisplayString"])(e.referenceName),1)})),128))]),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_TriggerBeingUsedNeedsRemove")),1),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_Cancel")},null,8,ai)],512)])}function ri(e){return si(e)||ci(e)||li(e)||oi()}function oi(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function li(e,t){if(e){if("string"===typeof e)return di(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?di(e,t):void 0}}function ci(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function si(e){if(Array.isArray(e))return di(e)}function di(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ui=window,gi=ui.tagManagerHelper,bi=Object(r["defineComponent"])({props:{idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},triggersHelpText:String},components:{Field:g["Field"],ContentBlock:u["ContentBlock"]},directives:{ContentTable:u["ContentTable"]},data:function(){return{hasWriteAccess:u["Matomo"].hasUserCapability("tagmanager_write"),triggerReferences:[],triggerSearch:""}},created:function(){Va.fetchTriggers(this.idContainer,this.idContainerVersion)},methods:{createTrigger:function(){this.editTrigger(0)},editTrigger:function(e){u["MatomoUrl"].updateHash(Object.assign(Object.assign({},u["MatomoUrl"].hashParsed.value),{},{idTrigger:e}))},deleteTrigger:function(e){var t=this;u["AjaxHelper"].fetch({method:"TagManager.getContainerTriggerReferences",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,idTrigger:e.idtrigger}).then((function(n){if(n&&n.length)t.triggerReferences=n,u["Matomo"].helper.modalConfirm(t.$refs.confirmDeleteTriggerNotPossible,{});else{t.triggerReferences=[];var a=function(){Va.deleteTrigger(t.idContainer,t.idContainerVersion,e.idtrigger).then((function(){Va.reload(t.idContainer,t.idContainerVersion),u["NotificationsStore"].remove("CopyDialogResultNotification")}))};u["Matomo"].helper.modalConfirm(t.$refs.confirmDeleteTrigger,{yes:a})}}))},truncateText:function(e,t){return gi.truncateText(e,t)},hasPublishCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_write")&&u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},openCopyDialog:function(e){var t=u["MatomoUrl"].stringify({module:"TagManager",action:"copyTriggerDialog",idSite:e.idsite,idContainer:this.idContainer,idTrigger:e.idtrigger,idContainerVersion:this.idContainerVersion});window.Piwik_Popover.createPopupAndLoadUrl(t,"","mtmCopyTrigger")}},computed:{isLoading:function(){return Va.isLoading.value},isUpdating:function(){return Va.isUpdating.value},triggers:function(){return Va.triggers.value},sortedTriggers:function(){var e=this.triggerSearch.toLowerCase(),t=ri(this.triggers).filter((function(t){return Object.keys(t).some((function(n){var a=t,i="";if("string"===typeof a[n])i=a[n];else if("typeMetadata"===n){var r=a.typeMetadata;i=r.name}else if("parameters"===n&&"CustomEvent"===a.type){var o=a.parameters;i=o.eventName}return-1!==i.toLowerCase().indexOf(e)}))}));return t.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),t},nameTranslatedText:function(){return this.translate("TagManager_TriggersNameDescription")},descriptionTranslatedText:function(){return this.translate("TagManager_TriggersDescriptionDescription")},typeTranslatedText:function(){return this.translate("TagManager_TriggersTypeDescription")},filterTranslatedText:function(){return this.translate("TagManager_TriggersFilterDescription")},lastUpdatedTranslatedText:function(){return this.translate("TagManager_TriggersLastUpdatedDescription")},actionTranslatedText:function(){return this.translate("TagManager_TriggersActionDescription")},getActionClasses:function(){var e=this.hasPublishCapability()?" hasCopyAction":"";return"action".concat(e)}}});bi.render=ii;var mi=bi,pi={class:"manageTrigger"};function hi(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("TriggerList"),c=Object(r["resolveComponent"])("TriggerEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",pi,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion,"triggers-help-text":e.triggersHelpText},null,8,["id-container","id-container-version","triggers-help-text"])])],512),[[r["vShow"],!e.editMode]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion,"id-trigger":e.idTrigger},null,8,["id-container","id-container-version","id-trigger"])])],512),[[r["vShow"],e.editMode]])])}var fi=Object(r["defineComponent"])({props:{idContainerVersion:Number,idContainer:String,triggersHelpText:String},components:{TriggerList:mi,TriggerEdit:Sa},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(r["watch"])((function(){return u["MatomoUrl"].hashParsed.value.idTrigger}),(function(t){e.onIdTriggerParamChange(t)})),u["NotificationsStore"].remove("triggertriggermanagement"),this.onIdTriggerParamChange(u["MatomoUrl"].hashParsed.value.idTrigger)},methods:{onIdTriggerParamChange:function(e){if("0"===e){var t={isAllowed:!0};u["Matomo"].postEvent("TagManager.initAddTrigger",t),this.isAddAllowed=!!t.isAllowed}}},computed:{idTrigger:function(){var e=u["MatomoUrl"].hashParsed.value.idTrigger;return this.isAddAllowed||"0"!==e?e?parseInt(e,10):e:null},editMode:function(){return"number"===typeof this.idTrigger}}});fi.render=hi;var vi=fi;function ji(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Oi={class:"editTag tagManagerManageEdit",ref:"root"},Ti={class:"loadingPiwik"},yi=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Vi={class:"loadingPiwik"},Ci=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Ni={class:"form-group row"},Ei={class:"col s12"},Si={key:0},wi={class:"form-group row"},ki={class:"col s12"},Mi={class:"form-group row"},_i={class:"col s12"},Di={class:"form-group row tagStartDate"},Ai={class:"col s12 m6"},xi={class:"row"},Bi={class:"col s12"},Li={for:"start_date_date",class:"active"},Ui={class:"tagStartDate"},Pi={class:"col s12 m6 "},Ii={class:"form-help"},Fi={class:"inline-help"},Hi=["innerHTML"],Gi=Object(r["createElementVNode"])("br",null,null,-1),$i=["innerHTML"],Ri={class:"form-group row tagEndDate"},qi={class:"col s12 m6"},zi={class:"row"},Wi={class:"col s12"},Xi={for:"end_date_date",class:"active"},Ki={class:"tagEndDate"},Ji={class:"col s12 m6"},Yi={class:"form-help"},Zi={class:"inline-help"},Qi=["innerHTML"],er=Object(r["createElementVNode"])("br",null,null,-1),tr=["innerHTML"],nr={class:"entityCancel"},ar={id:"confirmSelectTagType"},ir={class:"collection-header"},rr=["onClick","title"],or=["src"],lr={class:"title"},cr={class:"secondary-content"},sr=["title"],dr={class:"entityCancel"};function ur(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("GroupedSettings"),s=Object(r["resolveComponent"])("TagTriggerArray"),d=Object(r["resolveComponent"])("TagDateInput"),u=Object(r["resolveComponent"])("SaveButton"),g=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Oi,[Object(r["createVNode"])(g,{feature:"Tag Manager","content-title":e.editTitle},{default:Object(r["withCtx"])((function(){var n,a,i,o,g;return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",Ti,[yi,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",Vi,[Ci,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("form",{onSubmit:t[18]||(t[18]=function(t){return e.edit?e.updateTag():e.createTag()})},[Object(r["createElementVNode"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"alert alert-warning"},Object(r["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[r["vShow"],e.isTagDisabled]]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"text",name:"name","model-value":e.tag.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.tag.name=t,e.setValueHasChanged()}),maxlength:255,title:e.translate("General_Name"),"inline-help":e.tagNameHelpText,placeholder:e.translate("TagManager_TagNamePlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"textarea",name:"description","model-value":e.tag.description,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.tag.description=t,e.setValueHasChanged()}),maxlength:1e3,title:e.translate("TagManager_Description"),placeholder:e.translate("TagManager_TagDescriptionPlaceholder")},null,8,["model-value","title","placeholder"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Ni,[Object(r["createElementVNode"])("div",Ei,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("TagManager_ConfigureWhatTagDoes")),1)])],512),[[r["vShow"],null===(n=e.tag.typeMetadata)||void 0===n?void 0:n.parameters.length]]),e.tag?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Si,[Object(r["createVNode"])(c,{settings:(null===(a=e.tag.typeMetadata)||void 0===a?void 0:a.parameters)||[],"all-setting-values":e.parameterValues,onChange:t[2]||(t[2]=function(t){e.parameterValues[t.name]=t.value,e.setValueHasChanged()})},null,8,["settings","all-setting-values"])])):Object(r["createCommentVNode"])("",!0),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",wi,[Object(r["createElementVNode"])("div",ki,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("TagManager_ConfigureWhenTagDoes")),1)])],512),[[r["vShow"],null===(i=e.tag.typeMetadata)||void 0===i?void 0:i.parameters.length]]),Object(r["createVNode"])(s,{"container-triggers":e.containerTriggers,type:"fire",title:e.translate("TagManager_FireTriggerTitle"),help:e.translate("TagManager_FireTriggerHelp",e.translate("TagManager_FireLimit")),"model-value":e.fireTriggers,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.fireTriggers=t,e.setValueHasChanged(),e.onFireTriggerChange()}),onCreate:t[4]||(t[4]=function(t){return e.onCreateNewFireTrigger()}),onEdit:t[5]||(t[5]=function(t){return e.editTrigger(t)})},null,8,["container-triggers","title","help","model-value"]),Object(r["createVNode"])(s,{"container-triggers":e.containerTriggers,type:"block",title:e.translate("TagManager_BlockTriggerTitle"),help:e.translate("TagManager_BlockTriggerHelp"),"model-value":e.blockTriggers,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.blockTriggers=t,e.setValueHasChanged(),e.onBlockTriggerChange()}),onCreate:t[7]||(t[7]=function(t){return e.onCreateNewBlockTrigger()}),onEdit:t[8]||(t[8]=function(t){return e.editTrigger(t)})},null,8,["container-triggers","title","help","model-value"]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Mi,[Object(r["createElementVNode"])("div",_i,[Object(r["createElementVNode"])("h3",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{href:"",class:"showAdvancedSettings",onClick:t[9]||(t[9]=Object(r["withModifiers"])((function(t){return e.showAdvanced=!0}),["prevent"]))},Object(r["toDisplayString"])(e.translate("TagManager_ShowAdvancedSettings")),513),[[r["vShow"],!e.showAdvanced]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{href:"",class:"hideAdvancedSettings",onClick:t[10]||(t[10]=Object(r["withModifiers"])((function(t){return e.showAdvanced=!1}),["prevent"]))},Object(r["toDisplayString"])(e.translate("TagManager_HideAdvancedSettings")),513),[[r["vShow"],e.showAdvanced]])])])],512),[[r["vShow"],null===(o=e.tag.typeMetadata)||void 0===o?void 0:o.hasAdvancedSettings]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"radio",name:"fire_limit","model-value":e.tag.fire_limit,"onUpdate:modelValue":t[11]||(t[11]=function(t){e.tag.fire_limit=t,e.setValueHasChanged()}),options:e.availableFireLimits,title:e.translate("TagManager_FireLimit"),"inline-help":e.fireLimitHelp},null,8,["model-value","options","title","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"text",name:"fire_delay","model-value":e.tag.fire_delay,"onUpdate:modelValue":t[12]||(t[12]=function(t){e.tag.fire_delay=t,e.setValueHasChanged()}),maxlength:8,title:e.translate("TagManager_FireDelay"),"inline-help":e.translate("TagManager_FireDelayHelp"),placeholder:e.translate("TagManager_PlaceholderZero")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"text",name:"priority","model-value":e.tag.priority,"onUpdate:modelValue":t[13]||(t[13]=function(t){e.tag.priority=t,e.setValueHasChanged()}),maxlength:4,title:e.translate("TagManager_Priority"),"inline-help":e.translate("TagManager_PriorityHelp"),placeholder:e.translate("TagManager_PriorityPlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createElementVNode"])("div",Di,[Object(r["createElementVNode"])("div",Ai,[Object(r["createElementVNode"])("div",xi,[Object(r["createElementVNode"])("div",Bi,[Object(r["createElementVNode"])("label",Li,Object(r["toDisplayString"])(e.translate("TagManager_StartDate"))+":",1)]),Object(r["createElementVNode"])("div",Ui,[Object(r["createVNode"])(d,{name:"start_date","model-value":e.tag.start_date,"onUpdate:modelValue":t[14]||(t[14]=function(t){e.tag.start_date=t,e.setValueHasChanged()}),"default-time":"00:00:00"},null,8,["model-value"])])])]),Object(r["createElementVNode"])("div",Pi,[Object(r["createElementVNode"])("div",Ii,[Object(r["createElementVNode"])("span",Fi,[Object(r["createElementVNode"])("span",null,[Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("TagManager_TagStartDateHelp","<strong>","</strong>"))},null,8,Hi),Gi,Object(r["createElementVNode"])("span",{class:"currentLocalTime",innerHTML:e.$sanitize(e.translate("TagManager_CurrentTimeInLocalTimezone","<strong>",e.currentTime,"</strong>"))},null,8,$i)])])])])]),Object(r["createElementVNode"])("div",Ri,[Object(r["createElementVNode"])("div",qi,[Object(r["createElementVNode"])("div",zi,[Object(r["createElementVNode"])("div",Wi,[Object(r["createElementVNode"])("label",Xi,Object(r["toDisplayString"])(e.translate("TagManager_EndDate"))+":",1)]),Object(r["createElementVNode"])("div",Ki,[Object(r["createVNode"])(d,{name:"end_date","model-value":e.tag.end_date,"onUpdate:modelValue":t[15]||(t[15]=function(t){e.tag.end_date=t,e.setValueHasChanged()}),"default-time":"23:59:59"},null,8,["model-value"])])])]),Object(r["createElementVNode"])("div",Ji,[Object(r["createElementVNode"])("div",Yi,[Object(r["createElementVNode"])("span",Zi,[Object(r["createElementVNode"])("span",null,[Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("TagManager_TagEndDateHelp","<strong>","</strong>"))},null,8,Qi),er,Object(r["createElementVNode"])("span",{class:"currentLocalTime",innerHTML:e.$sanitize(e.translate("TagManager_CurrentTimeInLocalTimezone","<strong>",e.currentTime,"</strong>"))},null,8,tr)])])])])])],512),[[r["vShow"],e.showAdvanced&&(null===(g=e.tag.typeMetadata)||void 0===g?void 0:g.hasAdvancedSettings)]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"alert alert-warning"},Object(r["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[r["vShow"],e.isTagDisabled]]),Object(r["withDirectives"])(Object(r["createVNode"])(u,{class:"createButton",onConfirm:t[16]||(t[16]=function(t){return e.edit?e.updateTag():e.createTag()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.edit?e.translate("CoreUpdater_UpdateTitle"):e.translate("TagManager_CreateNewTag")},null,8,["disabled","saving","value"]),[[r["vShow"],!e.isTagDisabled]]),Object(r["createElementVNode"])("div",nr,[Object(r["createElementVNode"])("a",{onClick:t[17]||(t[17]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)])])],544),[[r["vShow"],!e.chooseTagType&&e.editTitle]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",ar,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.availableTags,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("ul",{class:"collection with-header",key:t.name},[Object(r["createElementVNode"])("li",ir,[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(t.name),1)]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t.types,(function(t,n){return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:n,class:Object(r["normalizeClass"])(["collection-item avatar",ji({disabledTemplate:e.isTagTemplateDisabled[t.id]},"templateType".concat(t.id),!0)]),onClick:function(n){return e.createTagType(t)},title:e.isTagTemplateDisabled[t.id]?e.collectionItemAvatarText:""},[t.icon?(Object(r["openBlock"])(),Object(r["createElementBlock"])("img",{key:0,alt:"",class:"circle",src:t.icon},null,8,or)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("span",lr,Object(r["toDisplayString"])(t.name),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(t.description),513),[[r["vShow"],t.description]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",cr,[Object(r["createElementVNode"])("i",{class:"icon-help",title:t.help},null,8,sr)],512),[[r["vShow"],!!t.help]])],10,rr)),[[r["vShow"],e.isTagVisible(t.id)]])})),128))])})),128)),Object(r["createElementVNode"])("div",dr,[Object(r["createElementVNode"])("a",{onClick:t[19]||(t[19]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)])],512),[[r["vShow"],e.chooseTagType]])]})),_:1},8,["content-title"])],512)}function gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function br(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function mr(e,t,n){return t&&br(e.prototype,t),n&&br(e,n),e}function pr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var hr=function(){function e(){var t=this;gr(this,e),pr(this,"privateState",Object(r["reactive"])({fireLimits:[],isLoading:!1})),pr(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),pr(this,"isLoading",Object(r["computed"])((function(){return t.state.value.isLoading}))),pr(this,"fireLimits",Object(r["computed"])((function(){return t.state.value.fireLimits}))),pr(this,"fireLimitsOptions",Object(r["computed"])((function(){return t.fireLimits.value.map((function(e){var t=e.id,n=e.name;return{key:t,value:n}}))}))),pr(this,"initializePromise",null)}return mr(e,[{key:"init",value:function(){return this.initializePromise||(this.initializePromise=this.fetchAvailableFireLimits()),this.initializePromise}},{key:"fetchAvailableFireLimits",value:function(){var e=this;return this.privateState.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getAvailableTagFireLimits",filter_limit:"-1"}).then((function(t){var n;n=Array.isArray(t)?t:Object.values(t),e.privateState.fireLimits=n})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),fr=new hr,vr={class:"col s12 m6"},jr=["for"],Or=Object(r["createElementVNode"])("br",null,null,-1),Tr=["name"],yr=["onClick","title"],Vr=["onClick","title"],Cr={class:"col s12 m6"},Nr={class:"form-help"},Er={class:"inline-help"},Sr=Object(r["createElementVNode"])("br",null,null,-1),wr=Object(r["createElementVNode"])("br",null,null,-1);function kr(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])(["form-group row","".concat(e.type,"Triggers")])},[Object(r["createElementVNode"])("div",vr,[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("label",{for:"".concat(e.type,"_triggers")},Object(r["toDisplayString"])(e.title),9,jr),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Or,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("TagManager_NoTriggersFound"))+". ",1),Object(r["createElementVNode"])("a",{class:"createNewTrigger",onClick:t[0]||(t[0]=function(t){return e.$emit("create")})},Object(r["toDisplayString"])(e.translate("TagManager_CreateNewTriggerNow")),1)],512),[[r["vShow"],0===e.containerTriggers.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.modelValue,(function(t,n){return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])(["multiple valign-wrapper","".concat(e.type,"Trigger ").concat(e.type,"Trigger").concat(n)]),key:n},[Object(r["createElementVNode"])("div",{class:"innerFormField",name:"".concat(e.type,"_triggers")},[Object(r["createVNode"])(l,{uicontrol:"select",name:"".concat(e.type,"_triggers"),"model-value":t,"onUpdate:modelValue":function(t){return e.onChangeTrigger(t,n)},"full-width":!0,options:e.containerTriggers},null,8,["name","model-value","onUpdate:modelValue","options"])],8,Tr),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-edit valign",onClick:function(n){return e.$emit("edit",t)},title:e.translate("General_Edit")},null,8,yr),[[r["vShow"],t]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-minus valign",onClick:function(t){return e.removeTrigger(n)},title:e.translate("General_Remove")},null,8,Vr),[[r["vShow"],n+1!==e.modelValue.length]])],2)),[[r["vShow"],e.containerTriggers.length]])})),128))])]),Object(r["createElementVNode"])("div",Cr,[Object(r["createElementVNode"])("div",Nr,[Object(r["createElementVNode"])("span",Er,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.help)+" ",1),Sr,wr,Object(r["createElementVNode"])("a",{class:"createTriggerInHelp",onClick:t[1]||(t[1]=function(t){return e.$emit("create")})},Object(r["toDisplayString"])(e.translate("TagManager_CreateNewTriggerNow")),1)])])])],2)}function Mr(e){return xr(e)||Ar(e)||Dr(e)||_r()}function _r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Dr(e,t){if(e){if("string"===typeof e)return Br(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Br(e,t):void 0}}function Ar(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function xr(e){if(Array.isArray(e))return Br(e)}function Br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Lr=Object(r["defineComponent"])({props:{type:{type:String,required:!0},help:{type:String,required:!0},title:{type:String,required:!0},containerTriggers:{type:Array,required:!0},modelValue:{type:Array,required:!0}},components:{Field:g["Field"]},emits:["update:modelValue","create","edit"],methods:{onChangeTrigger:function(e,t){var n=Mr(this.modelValue);n[t]=parseInt(e,10),this.$emit("update:modelValue",n)},removeTrigger:function(e){var t=Mr(this.modelValue);t.splice(e,1),this.$emit("update:modelValue",t)}}});Lr.render=kr;var Ur=Lr,Pr={class:"col s12 m6 input-field"},Ir=["name","id","value"],Fr={class:"col s12 m6 input-field"},Hr=["name","id","value"];function Gr(e,t,n,a,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createElementVNode"])("div",Pr,[Object(r["createElementVNode"])("input",{ref:"dateInput",type:"text",name:"".concat(e.name,"_date"),id:"".concat(e.name,"_date"),class:"dateInput",value:e.dateText,onKeydown:t[0]||(t[0]=function(t){return e.onDateKeydown(t)}),onChange:t[1]||(t[1]=function(t){return e.onDateKeydown(t)})},null,40,Ir)]),Object(r["createElementVNode"])("div",Fr,[Object(r["createElementVNode"])("input",{ref:"timeInput",type:"text",name:"".concat(e.name,"_time"),id:"".concat(e.name,"_time"),class:"timeInput",value:e.timeText,onKeydown:t[2]||(t[2]=function(t){return e.onTimeKeydown(t)})},null,40,Hr)])],64)}function $r(e){var t=String(e);return 1===t.length&&(t="0".concat(t)),t}function Rr(e){if(e){var t=e;if(t){t="".concat(t).replace(/-/g,"/");try{return new Date("".concat(t," UTC"))}catch(c){try{return new Date(Date.parse("".concat(t," UTC")))}catch(s){var n=t.substr(0,10),a=t.substr(11),i=n.split("/"),r=a.split(":");if(3===i.length&&3===r.length){var o=new Date(parseInt(i[0],10),parseInt(i[1],10)-1,parseInt(i[2],10),parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)),l=o.getTime()+6e4*o.getTimezoneOffset();return new Date(l)}}}}}}function qr(e){var t=Rr(e);if(t){var n=$r(t.getMonth()+1),a=$r(t.getDate());return"".concat(t.getFullYear(),"-").concat(n,"-").concat(a)}var i=e.split(" ");return i[0]}function zr(e){var t=Rr(e);if(t){var n=$r(t.getHours()),a=$r(t.getMinutes()),i=$r(t.getSeconds());return"".concat(n,":").concat(a,":").concat(i)}var r=e.split(" ");return r[1]}function Wr(e){var t=e;t&&(t=t.replace(/-/g,"/"));try{var n=new Date(t),a=$r(n.getUTCMonth()+1),i=$r(n.getUTCDate()),r=$r(n.getUTCHours()),o=$r(n.getUTCMinutes()),l=$r(n.getUTCSeconds()),c="";return c+="".concat(n.getUTCFullYear(),"-").concat(a,"-").concat(i),c+=" ",c+="".concat(r,":").concat(o,":").concat(l),c}catch(s){return t}}var Xr=window,Kr=Xr.$,Jr=Object(r["defineComponent"])({props:{name:{type:String,required:!0},defaultTime:{type:String,required:!0},modelValue:String},mounted:function(){var e=this,t=Object.assign(Object.assign({},u["Matomo"].getBaseDatePickerOptions(null)),{},{minDate:new Date});delete t.maxDate,Kr(this.$refs.dateInput).datepicker(Object.assign({},t)),Kr(this.$refs.timeInput).timepicker({timeFormat:"H:i:s"}).on("change",(function(t){e.onTimeKeydown(t)}))},computed:{dateText:function(){return this.modelValue?qr(this.modelValue):""},timeText:function(){return this.modelValue?zr(this.modelValue):""}},methods:{onDateKeydown:function(e){var t=this;setTimeout((function(){var n=e.target.value;t.dateText!==n&&t.onChange(n,t.timeText)}))},onTimeKeydown:function(e){var t=this;setTimeout((function(){var n=e.target.value;t.timeText!==n&&t.onChange(t.dateText,n)}))},onChange:function(e,t){if(e){var n=t||this.defaultTime,a=Wr("".concat(e," ").concat(n));this.$emit("update:model-value",a)}else this.$emit("update:model-value",null)}}});Jr.render=Gr;var Yr=Jr;function Zr(e){return Zr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(e)}function Qr(e,t){return no(e)||to(e,t)||ro(e,t)||eo()}function eo(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function to(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function no(e){if(Array.isArray(e))return e}function ao(e){return lo(e)||oo(e)||ro(e)||io()}function io(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ro(e,t){if(e){if("string"===typeof e)return co(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?co(e,t):void 0}}function oo(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function lo(e){if(Array.isArray(e))return co(e)}function co(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function so(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function go(e,t,n){return t&&uo(e.prototype,t),n&&uo(e,n),e}function bo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var mo=function(){function e(){var t=this;so(this,e),bo(this,"privateState",Object(r["reactive"])({tags:[],isLoadingTags:!1,isLoadingSingle:!1,isUpdating:!1})),bo(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),bo(this,"isLoading",Object(r["computed"])((function(){var e=t.state.value;return e.isLoadingTags||e.isLoadingSingle}))),bo(this,"isUpdating",Object(r["computed"])((function(){return t.state.value.isUpdating}))),bo(this,"tags",Object(r["computed"])((function(){return t.state.value.tags}))),bo(this,"fetchPromise",null),bo(this,"availableTagsPromises",{})}return go(e,[{key:"fetchTags",value:function(e,t){var n=this;return this.privateState.isLoadingTags=!0,this.privateState.tags=[],this.fetchPromise||(this.fetchPromise=u["AjaxHelper"].fetch({method:"TagManager.getContainerTags",idContainer:e,idContainerVersion:t,filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(e){return n.privateState.tags=e,n.privateState.isLoadingTags=!1,n.tags.value})).finally((function(){n.privateState.isLoadingTags=!1}))}},{key:"reload",value:function(e,t){return this.privateState.tags=[],this.fetchPromise=null,this.availableTagsPromises={},this.fetchTags(e,t)}},{key:"findTag",value:function(e,t,n){var a=this,i=this.tags.value.find((function(e){return e.idtag===n}));return i?Promise.resolve(i):(this.privateState.isLoadingSingle=!0,u["AjaxHelper"].fetch({idTag:n,idContainer:e,idContainerVersion:t,method:"TagManager.getContainerTag",filter_limit:"-1"}).then((function(e){return a.privateState.tags=[].concat(ao(a.privateState.tags),[e]),Object(r["readonly"])(e)})).finally((function(){a.privateState.isLoadingSingle=!1})))}},{key:"fetchAvailableTags",value:function(e){return this.availableTagsPromises[e]||(this.availableTagsPromises[e]=u["AjaxHelper"].fetch({method:"TagManager.getAvailableTagTypesInContext",idContext:e,filter_limit:"-1"}).then((function(e){return Object(r["readonly"])(e)}))),Promise.resolve(this.availableTagsPromises[e])}},{key:"createOrUpdateTag",value:function(e,t,n,a,i,r,o){var l=this;this.privateState.isUpdating=!0;var c=Object.entries(i).map((function(e){var t=Qr(e,2),n=t[0],a=t[1],i=a;return"boolean"===typeof a&&(i=(+a).toString()),[n,i]})),s=Object.fromEntries(c);return u["AjaxHelper"].post({idTag:e.idtag,method:t,idContainer:n,idContainerVersion:a,type:e.type,name:e.name,description:e.description,startDate:e.start_date,endDate:e.end_date,fireLimit:e.fire_limit,fireDelay:e.fire_delay,priority:e.priority},{parameters:s,fireTriggerIds:r,blockTriggerIds:o},{withTokenInUrl:!0}).finally((function(){l.privateState.isUpdating=!1}))}},{key:"deleteTag",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,this.privateState.tags=[],u["AjaxHelper"].fetch({idTag:n,idContainerVersion:t,idContainer:e,method:"TagManager.deleteContainerTag"},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}},{key:"pauseTag",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,this.privateState.tags=[],u["AjaxHelper"].fetch({idTag:n,idContainerVersion:t,idContainer:e,method:"TagManager.pauseContainerTag"},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}},{key:"resumeTag",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,this.privateState.tags=[],u["AjaxHelper"].fetch({idTag:n,idContainerVersion:t,idContainer:e,method:"TagManager.resumeContainerTag"},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}},{key:"suggestNameForType",value:function(e){for(var t=this,n=function(n){var a=e;n&&(a="".concat(a," (").concat(n,")"));var i=!t.tags.value.some((function(e){return e.name===a}));if(i)return{v:a}},a=0;a<100;a+=1){var i=n(a);if("object"===Zr(i))return i.v}}}]),e}(),po=new mo;function ho(e){return Oo(e)||jo(e)||vo(e)||fo()}function fo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vo(e,t){if(e){if("string"===typeof e)return To(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?To(e,t):void 0}}function jo(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Oo(e){if(Array.isArray(e))return To(e)}function To(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function yo(){var e=new Date;return e&&e.toString?e.toString():null}var Vo=window,Co=Vo.$,No=Vo.tagManagerHelper,Eo="tagtagmanagement",So=Object(r["defineComponent"])({props:{idTag:Number,idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},newTagType:null},components:{TagDateInput:Yr,ContentBlock:u["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"],GroupedSettings:g["GroupedSettings"],TagTriggerArray:Ur},data:function(){return{isDirty:!1,showAdvanced:!1,chooseTagType:!1,availableTags:[],containerTriggers:[],currentTime:null,tag:{},editTitle:"",parameterValues:{},isUpdatingTag:!1,fireTriggers:[],blockTriggers:[],currentTimeTimeout:null}},created:function(){var e=this;fr.init(),this.updateAvailableTriggers(),this.setCurrentTime(),po.reload(this.idContainer,this.idContainerVersion).then((function(){e.initIdTag()}))},unmounted:function(){this.currentTimeTimeout&&clearTimeout(this.currentTimeTimeout)},watch:{idTag:function(e){null!==e&&this.initIdTag()}},methods:{setCurrentTime:function(){this.currentTime=yo(),this.currentTimeTimeout=setTimeout(this.setCurrentTime.bind(this),1e4)},updateAvailableTriggers:function(){var e=this;u["AjaxHelper"].fetch({method:"TagManager.getContainerTriggers",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,filter_limit:"-1"}).then((function(t){e.containerTriggers=t.map((function(e){return{key:e.idtrigger,value:e.name}}))}))},removeAnyTagNotification:function(){u["NotificationsStore"].remove(Eo),u["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=u["NotificationsStore"].show({message:e,context:t,id:Eo,type:null!==n?n:"toast"});setTimeout((function(){u["NotificationsStore"].scrollToNotification(a)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(u["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdTag:function(){var e=this;this.tag={},this.chooseTagType=!1,this.editTitle="",u["Matomo"].helper.lazyScrollToContent(),this.availableTags=[],u["AjaxHelper"].fetch({method:"TagManager.getContainer",idContainer:this.idContainer,filter_limit:"-1"}).then((function(e){return po.fetchAvailableTags(e.context)})).then((function(t){e.availableTags=t})).then((function(){if(e.edit&&e.idTag)return e.editTitle=Object(u["translate"])("TagManager_EditTag"),void po.findTag(e.idContainer,e.idContainerVersion,e.idTag).then((function(t){var n;t&&(e.tag=Object(u["clone"])(t),e.parameterValues=Object.fromEntries(t.typeMetadata.parameters.map((function(e){return[e.name,e.value]}))),e.blockTriggers=ho(e.tag.block_trigger_ids||[]),e.blockTriggers.length||e.blockTriggers.push(null),e.fireTriggers=ho(e.tag.fire_trigger_ids||[]),e.fireTriggers.length||e.fireTriggers.push(null),e.onFireTriggerChange(),e.onBlockTriggerChange(),e.isDirty=!1,e.editTitle=Object(u["translate"])("TagManager_EditTag"),null!==(n=e.tag.typeMetadata)&&void 0!==n&&n.name&&(e.editTitle+=": ".concat(e.tag.typeMetadata.name)))}));e.create&&(e.editTitle=Object(u["translate"])("TagManager_ChooseTagToContinue"),e.chooseTagType=!0)}))},onCreateNewBlockTrigger:function(){var e=this;this.openEditTrigger((function(t){var n=e.blockTriggers.length-1;e.blockTriggers[n]?e.blockTriggers.push(t.idtrigger):e.blockTriggers[n]=t.idtrigger,e.onBlockTriggerChange()}),0)},onCreateNewFireTrigger:function(){var e=this;this.openEditTrigger((function(t){var n=e.fireTriggers.length-1;e.fireTriggers[n]?e.fireTriggers.push(t.idtrigger):e.fireTriggers[n]=t.idtrigger,e.onFireTriggerChange()}),0)},editTrigger:function(e){this.openEditTrigger((function(){return null}),e)},openEditTrigger:function(e,t){var n=this;No.editTrigger(this.idContainer,this.idContainerVersion,t,(function(t){n.updateAvailableTriggers(),e(t)}))},onBlockTriggerChange:function(){var e=this.blockTriggers.every((function(e){return!!e}));e&&this.addBlockTrigger()},addBlockTrigger:function(){this.blockTriggers.push(null),this.isDirty=!0},removeBlockTrigger:function(e){if(e>-1){var t=this.blockTriggers.length-1;t===e?this.blockTriggers[e]=null:this.blockTriggers.splice(e,1),this.isDirty=!0}},onFireTriggerChange:function(){var e=this.fireTriggers.every((function(e){return!!e}));e&&this.addFireTrigger()},addFireTrigger:function(){this.fireTriggers.push(null),this.isDirty=!0},removeFireTrigger:function(e){if(e>-1){var t=this.fireTriggers.length-1;t===e?this.fireTriggers[e]=null:this.fireTriggers.splice(e,1),this.isDirty=!0}},createTagType:function(e){var t,n=this;e&&this.isTagTemplateDisabled[e.id]||(this.chooseTagType=!1,this.tag={idsite:parseInt("".concat(u["Matomo"].idSite),10),name:po.suggestNameForType(e.name)||"",type:e.id,fire_limit:"unlimited",priority:"GoogleTag"===e.id||"GoogleAnalytics4"===e.id?1:999,fire_delay:0,typeMetadata:e},this.editTitle=Object(u["translate"])("TagManager_CreateNewTag"),null!==(t=this.tag.typeMetadata)&&void 0!==t&&t.name&&(this.editTitle+=": ".concat(this.tag.typeMetadata.name)),this.blockTriggers=[null],this.fireTriggers=[null],this.parameterValues=Object.fromEntries(e.parameters.map((function(e){return[e.name,e.value]}))),this.isDirty=!1,setTimeout((function(){var e=Co(n.$refs.root);e.length&&e[0]&&e[0].scrollIntoView(),e.find("#name").focus()}),1))},cancel:function(){var e=Object.assign({},u["MatomoUrl"].hashParsed.value);delete e.idTag,u["MatomoUrl"].updateHash(e)},createTag:function(){var e=this;this.removeAnyTagNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingTag=!0,po.createOrUpdateTag(this.tag,"TagManager.addContainerTag",this.idContainer,this.idContainerVersion,this.parameterValues,this.fireTriggers.filter((function(e){return!!e})),this.blockTriggers.filter((function(e){return!!e}))).then((function(t){t&&(e.isDirty=!1,po.reload(e.idContainer,e.idContainerVersion).then((function(){e.cancel(),setTimeout((function(){var t=Object(u["translate"])("TagManager_CreatedX",Object(u["translate"])("TagManager_Tag"));if(e.hasPublishCapability()){var n=Object(u["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(t," ").concat(n),"success","transient")}else e.showNotification(t,"success")}),200)})))})).finally((function(){e.isUpdatingTag=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateTag:function(){var e=this;this.removeAnyTagNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingTag=!0,po.createOrUpdateTag(this.tag,"TagManager.updateContainerTag",this.idContainer,this.idContainerVersion,this.parameterValues,this.fireTriggers.filter((function(e){return!!e})),this.blockTriggers.filter((function(e){return!!e}))).then((function(t){if(t){e.isDirty=!1,po.reload(e.idContainer,e.idContainerVersion).then((function(){e.initIdTag()})),e.cancel();var n=Object(u["translate"])("TagManager_UpdatedX",Object(u["translate"])("TagManager_Tag"));if(e.hasPublishCapability()){var a=Object(u["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(n," ").concat(a),"success","transient")}else e.showNotification(n,"success")}})).finally((function(){e.isUpdatingTag=!1})))},checkRequiredFieldsAreSet:function(){if(!this.tag.name){var e=Object(u["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(e),!1}return!(!this.fireTriggers||!this.fireTriggers.length)||(this.showNotification(Object(u["translate"])("TagManager_TagFireTriggerRequirement"),"error"),!1)},hasPublishCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_write")&&u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},isTagVisible:function(e){return!this.create||"GoogleAnalytics4"!==e}},computed:{availableFireLimits:function(){return fr.fireLimitsOptions.value},isLoading:function(){return Va.isLoading.value||fr.isLoading.value},isUpdating:function(){return Va.isUpdating.value||this.isUpdatingTag},create:function(){return 0===this.idTag},edit:function(){return!this.create},canUseCustomTemplates:function(){return u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},isTagDisabled:function(){var e;return!this.canUseCustomTemplates&&(null===(e=this.tag.typeMetadata)||void 0===e?void 0:e.isCustomTemplate)},isTagTemplateDisabled:function(){var e=this,t={};return this.availableTags.forEach((function(n){n.types.forEach((function(n){t[n.id]=!e.canUseCustomTemplates&&n.isCustomTemplate}))})),t},collectionItemAvatarText:function(){return Object(u["translate"])("TagManager_UseCustomTemplateCapabilityRequired",Object(u["translate"])("TagManager_CapabilityUseCustomTemplates"))},fireLimitHelp:function(){return Object(u["translate"])("TagManager_FireLimitHelp",Object(u["translate"])("TagManager_Unlimited"),Object(u["translate"])("TagManager_OncePage"),Object(u["translate"])("TagManager_Once24Hours"),Object(u["translate"])("TagManager_OnceLifetime"))},tagNameHelpText:function(){var e="";return console.log(this.tag),"CustomHtml"===this.tag.type&&(e=Object(u["translate"])("TagManager_CustomHTMLTagNameInlineHelpText","<br><br><strong>","</strong>",Object(u["externalLink"])("https://matomo.org/faq/tag-manager/how-to-add-google-ads-remarketing-tags-in-matomo-tag-manager/"),"</a>")),Object(u["translate"])("TagManager_TagNameHelpV2")+e}}});So.render=ur;var wo=So,ko={class:"tagManagerManageList tagManagerTagList"},Mo={class:"tagSearchFilter"},_o=["title"],Do=["title"],Ao=["title"],xo=["title"],Bo=["title"],Lo=["title"],Uo={colspan:"6"},Po={class:"loadingPiwik"},Io=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Fo={colspan:"6"},Ho=["id"],Go=["title"],$o=["title"],Ro=["title"],qo={class:"triggers"},zo=["onClick","title"],Wo=["title"],Xo=["onClick","title"],Ko=["title"],Jo=["title"],Yo=["onClick","title"],Zo=["onClick","title"],Qo=["onClick","title"],el=["onClick","title"],tl=["onClick","title"],nl={class:"tableActionBar"},al=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),il={class:"ui-confirm",id:"confirmDeleteTag",ref:"confirmDeleteTag"},rl=["value"],ol=["value"],ll={class:"ui-confirm",id:"confirmPauseTag",ref:"confirmPauseTag"},cl=["value"],sl=["value"],dl={class:"ui-confirm",id:"confirmResumeTag",ref:"confirmResumeTag"},ul=["value"],gl=["value"];function bl(e,t,n,a,i,o){var l=this,c=Object(r["resolveComponent"])("Field"),s=Object(r["resolveComponent"])("ContentBlock"),d=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ko,[Object(r["createVNode"])(s,{feature:"Tag Manager","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Tags")),"help-text":e.tagsHelpText},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_TagUsageBenefits")),1),Object(r["createElementVNode"])("div",Mo,[Object(r["withDirectives"])(Object(r["createVNode"])(c,{uicontrol:"text",name:"tagSearch",title:e.translate("General_Search"),modelValue:e.tagSearch,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.tagSearch=t})},null,8,["title","modelValue"]),[[r["vShow"],e.tags.length>0]])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",{class:"name",title:e.nameTranslatedText},Object(r["toDisplayString"])(e.translate("General_Name")),9,_o),Object(r["createElementVNode"])("th",{class:"description",title:e.descriptionTranslatedText},Object(r["toDisplayString"])(e.translate("General_Description")),9,Do),Object(r["createElementVNode"])("th",{class:"type",title:e.typeTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_Type")),9,Ao),Object(r["createElementVNode"])("th",{class:"triggers",title:e.triggersTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_Triggers")),9,xo),Object(r["createElementVNode"])("th",{class:"lastUpdated",title:e.lastUpdatedTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_LastUpdated")),9,Bo),Object(r["withDirectives"])(Object(r["createElementVNode"])("th",{class:"action",title:e.actionTranslatedText},Object(r["toDisplayString"])(e.translate("General_Actions")),9,Lo),[[r["vShow"],e.hasWriteAccess]])])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Uo,[Object(r["createElementVNode"])("span",Po,[Io,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Fo,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_NoTagsFound"))+" ",1),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createContainerTagNow",onClick:t[1]||(t[1]=function(t){return e.createTag()})},Object(r["toDisplayString"])(e.translate("TagManager_CreateNewTagNow")),513),[[r["vShow"],e.hasWriteAccess]])])],512),[[r["vShow"],!e.isLoading&&0===e.tags.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedTags,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{class:"tags",key:t.idtag,id:"tag".concat(t.idtag)},[Object(r["createElementVNode"])("td",{class:"name",title:t.name},Object(r["toDisplayString"])(e.truncateText(t.name,50)),9,Go),Object(r["createElementVNode"])("td",{class:"description",title:t.description},Object(r["toDisplayString"])(e.truncateText(t.description,75)),9,$o),Object(r["createElementVNode"])("td",{class:"type",title:t.typeMetadata.description},Object(r["toDisplayString"])(t.typeMetadata.name),9,Ro),Object(r["createElementVNode"])("td",qo,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t.fire_trigger_ids,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:n,style:{"margin-right":"3.5px"}},[e.hasWriteAccess?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,style:{display:"inline-block","vertical-align":"top !important"},class:"chip",href:"",onClick:Object(r["withModifiers"])((function(n){return e.editTrigger(t)}),["prevent"]),title:l.triggers[t]},Object(r["toDisplayString"])(e.truncateText(l.triggers[t],e.triggerTruncateLength)),9,zo)):Object(r["createCommentVNode"])("",!0),e.hasWriteAccess?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:1,class:"chip",title:l.triggers[t]},Object(r["toDisplayString"])(e.truncateText(l.triggers[t],e.triggerTruncateLength)),9,Wo))])})),128)),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_Except"))+": ",1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t.block_trigger_ids,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:n,style:{"margin-right":"3.5px"}},[Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"chip",href:"",onClick:Object(r["withModifiers"])((function(n){return e.editTrigger(t)}),["prevent"]),title:l.triggers[t]},Object(r["toDisplayString"])(e.truncateText(l.triggers[t],e.triggerTruncateLength)),9,Xo),[[r["vShow"],e.hasWriteAccess]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"chip",title:l.triggers[t]},Object(r["toDisplayString"])(e.truncateText(l.triggers[t],e.triggerTruncateLength)),9,Ko),[[r["vShow"],!e.hasWriteAccess]])])})),128))],512),[[r["vShow"],t.block_trigger_ids.length]])]),Object(r["createElementVNode"])("td",{class:"lastUpdated",title:e.translate("TagManager_CreatedOnX",t.created_date_pretty)},[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(t.updated_date_pretty),1)],8,Jo),Object(r["withDirectives"])(Object(r["createElementVNode"])("td",{class:Object(r["normalizeClass"])(e.getActionClasses)},[Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-pause",onClick:function(n){return e.pauseTag(t)},title:e.translate("TagManager_PauseX",e.translate("TagManager_Tag"))},null,8,Yo),[[r["vShow"],"active"===t.status]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-play",onClick:function(n){return e.resumeTag(t)},title:e.translate("TagManager_ResumeX",e.translate("TagManager_Tag"))},null,8,Zo),[[r["vShow"],"paused"===t.status]]),Object(r["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editTag(t.idtag,t.type)},title:e.translate("TagManager_EditTag")},null,8,Qo),Object(r["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteTag(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Tag"))},null,8,el),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-content-copy",onClick:function(n){return e.openCopyDialog(t)},title:e.translate("TagManager_CopyX",e.translate("TagManager_Tag"))},null,8,tl),[[r["vShow"],e.hasPublishCapability()]])],2),[[r["vShow"],e.hasWriteAccess]])],8,Ho)})),128))])],512),[[d]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",nl,[Object(r["createElementVNode"])("a",{class:"createNewTag",value:"",onClick:t[2]||(t[2]=function(t){return e.createTag()})},[al,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewTag")),1)])],512),[[r["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title","help-text"]),Object(r["createElementVNode"])("div",il,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_DeleteTagConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,rl),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,ol)],512),Object(r["createElementVNode"])("div",ll,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_PauseTagConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,cl),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,sl)],512),Object(r["createElementVNode"])("div",dl,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_ResumeTagConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ul),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,gl)],512)])}function ml(e){return vl(e)||fl(e)||hl(e)||pl()}function pl(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hl(e,t){if(e){if("string"===typeof e)return jl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jl(e,t):void 0}}function fl(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function vl(e){if(Array.isArray(e))return jl(e)}function jl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ol=window,Tl=Ol.tagManagerHelper,yl="tagtagmanagementlist",Vl=Object(r["defineComponent"])({props:{idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},tagsHelpText:String},components:{ContentBlock:u["ContentBlock"],Field:g["Field"]},directives:{ContentTable:u["ContentTable"]},data:function(){return{hasWriteAccess:u["Matomo"].hasUserCapability("tagmanager_write"),triggerTruncateLength:40,tagSearch:""}},created:function(){var e=this;Object(r["watch"])((function(){return po.tags.value}),(function(){e.reloadTriggers()})),this.reloadTriggers(),po.fetchTags(this.idContainer,this.idContainerVersion)},methods:{reloadTriggers:function(){Va.reload(this.idContainer,this.idContainerVersion)},createTag:function(){this.editTag(0)},editTrigger:function(e){var t=this;Tl.editTrigger(this.idContainer,this.idContainerVersion,e,(function(){t.reloadTriggers()}))},editTag:function(e){u["MatomoUrl"].updateHash(Object.assign(Object.assign({},u["MatomoUrl"].hashParsed.value),{},{idTag:e}))},pauseTag:function(e){var t=this,n=function(){po.pauseTag(t.idContainer,t.idContainerVersion,e.idtag).then((function(){po.reload(t.idContainer,t.idContainerVersion).then((function(){setTimeout((function(){t.showDeployNotification("pause")}),200)}))}))};u["Matomo"].helper.modalConfirm("#confirmPauseTag",{yes:n})},resumeTag:function(e){var t=this,n=function(){po.resumeTag(t.idContainer,t.idContainerVersion,e.idtag).then((function(){po.reload(t.idContainer,t.idContainerVersion).then((function(){setTimeout((function(){t.showDeployNotification("resume")}),200)}))}))};u["Matomo"].helper.modalConfirm("#confirmResumeTag",{yes:n})},deleteTag:function(e){var t=this,n=function(){po.deleteTag(t.idContainer,t.idContainerVersion,e.idtag).then((function(){po.reload(t.idContainer,t.idContainerVersion),u["NotificationsStore"].remove("CopyDialogResultNotification")}))};u["Matomo"].helper.modalConfirm("#confirmDeleteTag",{yes:n})},truncateText:function(e,t){return Tl.truncateText(e,t)},hasPublishCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_write")&&u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},showDeployNotification:function(e){var t="pause"===e?"TagManager_PausedTag":"TagManager_ResumedTag",n=Object(u["translate"])(t,Object(u["translate"])("TagManager_Tag"));if(this.hasPublishCapability()){var a=Object(u["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");this.showNotification("".concat(n," ").concat(a),"success","transient")}else this.showNotification(n,"success")},showNotification:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=u["NotificationsStore"].show({message:e,context:t,id:yl,type:null!==n?n:"toast"});setTimeout((function(){u["NotificationsStore"].scrollToNotification(a)}),200)},openCopyDialog:function(e){var t=u["MatomoUrl"].stringify({module:"TagManager",action:"copyTagDialog",idSite:e.idsite,idContainer:this.idContainer,idTag:e.idtag,idContainerVersion:this.idContainerVersion});window.Piwik_Popover.createPopupAndLoadUrl(t,"","mtmCopyTag")}},computed:{triggers:function(){var e={};return Va.triggers.value.forEach((function(t){e["".concat(t.idtrigger)]=t.name})),e},isLoading:function(){return po.isLoading.value},isUpdating:function(){return po.isUpdating.value},tags:function(){return po.tags.value},sortedTags:function(){var e=this,t=this.tagSearch.toLowerCase(),n=ml(this.tags).filter((function(n){return Object.keys(n).some((function(a){var i=n,r="";if("string"===typeof i[a])r=i[a];else if("typeMetadata"===a){var o=i.typeMetadata;r=o.name}else if("fire_trigger_ids"===a)e.triggers&&i.fire_trigger_ids&&Object.values(i.fire_trigger_ids).forEach((function(t){e.triggers[t]&&(r+="".concat(e.triggers[t]," "))}));else if("parameters"===a&&"CustomHtml"===i.type){var l=i.parameters;r=l.customHtml}return-1!==r.toLowerCase().indexOf(t)}))}));return n.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),n},nameTranslatedText:function(){return this.translate("TagManager_TagsNameDescription")},descriptionTranslatedText:function(){return this.translate("TagManager_TagsDescriptionDescription")},typeTranslatedText:function(){return this.translate("TagManager_TagsTypeDescription")},triggersTranslatedText:function(){return this.translate("TagManager_TagsTriggersDescription")},lastUpdatedTranslatedText:function(){return this.translate("TagManager_TagsLastUpdatedDescription")},actionTranslatedText:function(){return this.translate("TagManager_TagsActionDescription")},getActionClasses:function(){var e=this.hasPublishCapability()?" hasCopyAction":"";return"action".concat(e)}}});Vl.render=bl;var Cl=Vl,Nl={class:"manageTag"},El={key:0},Sl={key:1};function wl(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("TagList"),c=Object(r["resolveComponent"])("TagEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Nl,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",El,[Object(r["createVNode"])(l,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion,"tags-help-text":e.tagsHelpText},null,8,["id-container","id-container-version","tags-help-text"])])),e.editMode?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Sl,[Object(r["createVNode"])(c,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion,"id-tag":e.idTag},null,8,["id-container","id-container-version","id-tag"])])):Object(r["createCommentVNode"])("",!0)])}var kl=Object(r["defineComponent"])({props:{idContainerVersion:Number,idContainer:String,tagsHelpText:String},components:{TagList:Cl,TagEdit:wo},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(r["watch"])((function(){return u["MatomoUrl"].hashParsed.value.idTag}),(function(t){e.onIdTagParamChange(t)})),u["NotificationsStore"].remove("tagtagmanagement"),this.onIdTagParamChange(u["MatomoUrl"].hashParsed.value.idTag)},methods:{onIdTagParamChange:function(e){if("0"===e){var t={isAllowed:!0};u["Matomo"].postEvent("TagManager.initAddTag",t),this.isAddAllowed=!!t.isAllowed}}},computed:{idTag:function(){var e=u["MatomoUrl"].hashParsed.value.idTag;return this.isAddAllowed||"0"!==e?e?parseInt(e,10):e:null},editMode:function(){return"number"===typeof this.idTag}}});kl.render=wl;var Ml=kl,_l={class:"editVersion tagManagerManageEdit"},Dl={class:"loadingPiwik"},Al=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),xl={class:"loadingPiwik"},Bl=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Ll={key:0},Ul={key:0},Pl={key:1},Il=["innerHTML"],Fl={key:2,class:"versionChanges"},Hl={key:0},Gl={colspan:"4"},$l={key:1},Rl={colspan:"4"},ql={class:"lastUpdated"},zl={class:"entityCancel"};function Wl(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("SaveButton"),s=Object(r["resolveComponent"])("ActivityIndicator"),d=Object(r["resolveComponent"])("ContentBlock"),u=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",_l,[Object(r["createVNode"])(d,{feature:"Tag Manager","content-title":e.editTitle},{default:Object(r["withCtx"])((function(){var n;return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",Dl,[Al,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",xl,[Bl,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["createElementVNode"])("form",{onSubmit:t[6]||(t[6]=function(t){return e.edit?e.updateVersion():e.createVersion()})},[Object(r["createElementVNode"])("div",null,[e.hasPublishCapability()||e.hasWriteCapability()&&e.hasPublishToLiveCapability()?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Ll,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"text",name:"name","inline-help":e.versionNameHelpText,"inline-help-bind":{lastVersion:e.lastVersion},"model-value":e.version.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.version.name=t,e.setValueHasChanged()}),maxlength:50,title:e.translate("TagManager_VersionName"),placeholder:e.translate("TagManager_VersionNamePlaceholder")},null,8,["inline-help","inline-help-bind","model-value","title","placeholder"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"textarea",name:"description","model-value":e.version.description,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.version.description=t,e.setValueHasChanged()}),title:e.translate("TagManager_VersionDescriptionOptional"),"inline-help":e.translate("TagManager_VersionDescriptionHelp"),placeholder:e.translate("TagManager_VersionDescriptionPlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createVNode"])(c,{class:"createButton no-publish",onConfirm:t[2]||(t[2]=function(t){return e.edit?e.updateVersion():e.createVersion()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.edit?e.translate("CoreUpdater_UpdateTitle"):e.translate("TagManager_CreateVersionWithoutPublishing")},null,8,["disabled","saving","value"]),e.create&&e.environments.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Ul,[Object(r["createVNode"])(l,{uicontrol:"select",name:"environment","inline-help":e.selectTagManagerEnvironmentHelp,"inline-help-bind":{canPublishToLive:e.canPublishToLive},"model-value":null===(n=e.version.environments)||void 0===n?void 0:n[0],"onUpdate:modelValue":t[3]||(t[3]=function(t){e.version.environments[0]=t,e.setValueHasChanged()}),options:e.environments,introduction:e.translate("TagManager_OrCreateAndPublishVersion"),title:e.translate("TagManager_Environment")},null,8,["inline-help","inline-help-bind","model-value","options","introduction","title"])])):Object(r["createCommentVNode"])("",!0),e.create&&e.environments.length?(Object(r["openBlock"])(),Object(r["createBlock"])(c,{key:1,class:"publishButton",onConfirm:t[4]||(t[4]=function(t){return e.createVersionAndPublish()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.translate("TagManager_CreateVersionAndPublishRelease")},null,8,["disabled","saving","value"])):Object(r["createCommentVNode"])("",!0)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Pl,[Object(r["createElementVNode"])("div",{class:"alert alert-warning",innerHTML:e.$sanitize(e.showNoAccessErrorMessage)},null,8,Il)])),e.lastVersion?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Fl,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("TagManager_ChangesSinceLastVersion"))+":",1),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("SitesManager_Type")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_Name")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("TagManager_Change")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("TagManager_LastUpdated")),1)])]),Object(r["createElementVNode"])("tbody",null,[e.isLoadingVersionChanges?(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",Hl,[Object(r["createElementVNode"])("td",Gl,[Object(r["createVNode"])(s,{"loading-message":e.translate("TagManager_DetectingChanges"),loading:!0},null,8,["loading-message"])])])):Object(r["createCommentVNode"])("",!0),e.versionChanges.length||e.isLoadingVersionChanges?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",$l,[Object(r["createElementVNode"])("td",Rl,Object(r["toDisplayString"])(e.translate("UserCountryMap_None")),1)])),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.versionChanges,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:n},[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.translate(t.entityType)),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.name),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.translate(t.type)),1),Object(r["createElementVNode"])("td",ql,[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(t.lastChanged),1)])])})),128))])],512),[[u]])])):Object(r["createCommentVNode"])("",!0),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",zl,[Object(r["createElementVNode"])("a",{onClick:t[5]||(t[5]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[r["vShow"],!e.isEmbedded]])])],32)]})),_:1},8,["content-title"])])}function Xl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kl(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Jl(e,t,n){return t&&Kl(e.prototype,t),n&&Kl(e,n),e}function Yl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Zl=function(){function e(){var t=this;Xl(this,e),Yl(this,"privateState",Object(r["reactive"])({environmentsWithPublish:[],isLoading:!1})),Yl(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),Yl(this,"isLoading",Object(r["computed"])((function(){return t.state.value.isLoading}))),Yl(this,"environmentsWithPublish",Object(r["computed"])((function(){return t.state.value.environmentsWithPublish}))),Yl(this,"environmentsWithPublishOptions",Object(r["computed"])((function(){return t.environmentsWithPublish.value.map((function(e){var t=e.id,n=e.name;e.disabled;return{key:t,value:n,disabled:!1}}))}))),Yl(this,"initializePromise",null)}return Jl(e,[{key:"init",value:function(){return this.initializePromise||(this.initializePromise=this.fetchEnvironments()),this.initializePromise}},{key:"fetchEnvironments",value:function(){var e=this;return this.privateState.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getAvailableEnvironmentsWithPublishCapability",filter_limit:"-1"}).then((function(t){var n;n=Array.isArray(t)?t:Object.values(t),e.privateState.environmentsWithPublish=n})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),Ql=new Zl;function ec(e){return ac(e)||nc(e)||oc(e)||tc()}function tc(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nc(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ac(e){if(Array.isArray(e))return lc(e)}function ic(e,t){return sc(e)||cc(e,t)||oc(e,t)||rc()}function rc(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oc(e,t){if(e){if("string"===typeof e)return lc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lc(e,t):void 0}}function lc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function cc(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function sc(e){if(Array.isArray(e))return e}
/**
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function dc(e,t,n){function a(e,t){return e.find((function(e){return e.name===t}))}function i(e,t,n,i){var r=[];return t.forEach((function(t){var o=a(n,t.name);o?i.some((function(n){return JSON.stringify(t[n])!==JSON.stringify(o[n])&&(r.push({entityType:e,type:"status"===n&&"paused"===t[n]?"TagManager_DiffPaused":"TagManager_DiffModified",name:t.name,lastChanged:t.updated_date_pretty}),!0)})):"paused"===t.status?r.push({entityType:e,type:"TagManager_DiffAddedPaused",name:t.name,lastChanged:t.updated_date_pretty}):r.push({entityType:e,type:"TagManager_DiffAdded",name:t.name,lastChanged:t.updated_date_pretty})})),n.forEach((function(n){a(t,n.name)||r.push({entityType:e,type:"TagManager_DiffDeleted",name:n.name,lastChanged:n.updated_date_pretty})})),r}function r(e,t){e.forEach((function(e){e.fire_triggers=[],e.block_triggers=[],e.fire_trigger_ids.forEach((function(n){var a=t.find((function(e){return e.idtrigger===n}));a&&e.fire_triggers.push(a.name)})),e.block_trigger_ids.forEach((function(n){var a=t.find((function(e){return e.idtrigger===n}));a&&e.block_triggers.push(a.name)}))}))}var o={module:"API",method:"TagManager.exportContainerVersion",format:"json",idContainer:e,filter_limit:-1};t&&(o.idContainerVersion=t);var l={module:"API",method:"TagManager.exportContainerVersion",format:"json",idContainer:e,idContainerVersion:n,filter_limit:-1};return u["AjaxHelper"].fetch([o,l]).then((function(e){var t=ic(e,2),n=t[0],a=t[1];r(n.tags,n.triggers),r(a.tags,a.triggers);var o=i("TagManager_Tag",n.tags,a.tags,["name","type","fire_limit","priority","fire_delay","fire_triggers","block_triggers","parameters","status"]),l=i("TagManager_Trigger",n.triggers,a.triggers,["name","type","conditions","parameters"]),c=i("TagManager_Variable",n.variables,a.variables,["name","type","lookup_table","default_value","parameters"]);return[].concat(ec(o),ec(l),ec(c))}))}function uc(e){return pc(e)||mc(e)||bc(e)||gc()}function gc(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bc(e,t){if(e){if("string"===typeof e)return hc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hc(e,t):void 0}}function mc(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function pc(e){if(Array.isArray(e))return hc(e)}function hc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function fc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vc(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jc(e,t,n){return t&&vc(e.prototype,t),n&&vc(e,n),e}function Oc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Tc=function(){function e(){var t=this;fc(this,e),Oc(this,"privateState",Object(r["reactive"])({versions:[],isLoadingVersions:!1,isLoadingSingle:!1,isUpdating:!1})),Oc(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),Oc(this,"isLoading",Object(r["computed"])((function(){var e=t.state.value;return e.isLoadingVersions||e.isLoadingSingle}))),Oc(this,"isUpdating",Object(r["computed"])((function(){return t.state.value.isUpdating}))),Oc(this,"versions",Object(r["computed"])((function(){return t.state.value.versions}))),Oc(this,"fetchPromise",null)}return jc(e,[{key:"reload",value:function(e){return this.privateState.versions=[],this.fetchPromise=null,this.fetchVersions(e)}},{key:"fetchVersions",value:function(e){var t=this;return this.privateState.isLoadingVersions=!0,this.privateState.versions=[],this.fetchPromise||(this.fetchPromise=u["AjaxHelper"].fetch({method:"TagManager.getContainerVersions",idContainer:e,filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(e){return t.privateState.versions=e,t.privateState.isLoadingVersions=!1,t.versions.value})).finally((function(){t.privateState.isLoadingVersions=!1}))}},{key:"findVersion",value:function(e,t){var n=this,a=this.versions.value.find((function(e){return e.idcontainerversion===t}));return a?Promise.resolve(a):(this.privateState.isLoadingSingle=!0,u["AjaxHelper"].fetch({idContainerVersion:t,idContainer:e,method:"TagManager.getContainerVersion",filter_limit:"-1"}).then((function(e){return n.privateState.versions=[].concat(uc(n.privateState.versions),[e]),Object(r["readonly"])(e)})).finally((function(){n.privateState.isLoadingSingle=!1})))}},{key:"deleteVersion",value:function(e,t){var n=this;return this.privateState.isUpdating=!0,this.privateState.versions=[],u["AjaxHelper"].fetch({idContainerVersion:t,idContainer:e,method:"TagManager.deleteContainerVersion"},{withTokenInUrl:!0}).finally((function(){n.privateState.isUpdating=!1}))}},{key:"publishVersion",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,u["AjaxHelper"].fetch({idContainer:e,idContainerVersion:t,environment:n,method:"TagManager.publishContainerVersion"}).finally((function(){a.privateState.isUpdating=!1}))}},{key:"createOrUpdateVersion",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,u["AjaxHelper"].post({method:t,idContainer:n,idContainerVersion:e.idcontainerversion},{name:e.name,description:e.description},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}}]),e}(),yc=new Tc,Vc={id:"versionNameHelpText",class:"inline-help-node"},Cc=Object(r["createElementVNode"])("br",null,null,-1),Nc=Object(r["createElementVNode"])("br",null,null,-1),Ec=["innerHTML"];function Sc(e,t,n,a,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Vc,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_VersionNameHelp"))+" ",1),Cc,Nc,Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("TagManager_NameOfLatestVersion","<strong>".concat(e.lastVersion,"</strong>")))},null,8,Ec),[[r["vShow"],e.lastVersion]])])}var wc=Object(r["defineComponent"])({props:{lastVersion:String}});wc.render=Sc;var kc=wc,Mc={id:"selectTagManagerEnvironmentHelp",class:"inline-help-node"};function _c(e,t,n,a,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Mc,[Object(r["createElementVNode"])("div",null,Object(r["toDisplayString"])(e.translate("TagManager_VersionEnvironmentHelp")),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"alert alert-info",style:{"margin-bottom":"0","padding-bottom":"0"}},Object(r["toDisplayString"])(e.translate("TagManager_PublishLiveEnvironmentCapabilityRequired",e.translate("TagManager_CapabilityPublishLiveContainer"))),513),[[r["vShow"],!e.canPublishToLive]])])}var Dc=Object(r["defineComponent"])({props:{canPublishToLive:Boolean}});Dc.render=_c;var Ac=Dc;function xc(e){return Pc(e)||Uc(e)||Lc(e)||Bc()}function Bc(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Lc(e,t){if(e){if("string"===typeof e)return Ic(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ic(e,t):void 0}}function Uc(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Pc(e){if(Array.isArray(e))return Ic(e)}function Ic(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Fc="versiontagmanagement",Hc=Object(r["defineComponent"])({props:{idContainerVersion:{type:Number,required:!0},idContainer:{type:String,required:!0},isEmbedded:{type:Boolean,default:!1}},components:{ContentBlock:u["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"],ActivityIndicator:u["ActivityIndicator"]},directives:{ContentTable:u["ContentTable"]},data:function(){return{isDirty:!1,lastVersion:null,versionChanges:[],isLoadingVersionChanges:!1,isUpdatingVersion:!1,version:{}}},emits:["changeVersion"],created:function(){Ct.init(),Ql.init(),this.initIdContainerVersion()},watch:{idContainerVersion:function(e){null!==e&&this.initIdContainerVersion()}},methods:{removeAnyVersionNotification:function(){u["NotificationsStore"].remove(Fc),u["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=u["NotificationsStore"].show({message:e,context:t,id:Fc,type:null!==n?n:"toast"});setTimeout((function(){u["NotificationsStore"].scrollToNotification(a)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(u["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdContainerVersion:function(){var e=this;if(this.version={},this.lastVersion=null,this.versionChanges=[],this.isLoadingVersionChanges=!0,yc.fetchVersions(this.idContainer).then((function(){var t;e.isLoadingVersionChanges=!1,e.lastVersion=null;var n=xc(yc.versions.value);if(null!==n&&void 0!==n&&n.length){n.sort((function(e,t){return e.revision<t.revision?1:0}));var a=null;e.create&&null!==(t=n[0])&&void 0!==t&&t.name?(e.lastVersion=u["Matomo"].helper.htmlEntities(n[0].name),a=n[0].idcontainerversion):e.edit&&n.forEach((function(t,i){i>=n.length-1||t.idcontainerversion===e.idContainerVersion&&n[i+1]&&(e.lastVersion=u["Matomo"].helper.htmlEntities(n[i+1].name),a=n[i+1].idcontainerversion)})),e.lastVersion&&(e.isLoadingVersionChanges=!0,dc(e.idContainer,e.idContainerVersion,a).then((function(t){t.sort((function(e,t){return new Date(t.lastChanged).valueOf()-new Date(e.lastChanged).valueOf()})),e.versionChanges=t,e.isLoadingVersionChanges=!1})),e.create&&!e.version.name&&/^\d+$/.test(e.lastVersion)&&(e.version.name="".concat(parseInt(e.lastVersion,10)+1),e.isDirty=!0))}})),u["Matomo"].helper.lazyScrollToContent(),this.edit&&this.idContainerVersion)yc.findVersion(this.idContainer,this.idContainerVersion).then((function(t){t&&(e.version=Object(u["clone"])(t),e.isDirty=!1)}));else if(this.create){if(this.version={idSite:u["Matomo"].idSite,idcontainer:this.idContainer,name:"",description:""},this.canPublishToLive)this.version.environments=["live"];else{var t=this.environments.find((function(e){return"live"!==e.key}));this.version.environments=t?[t.key]:[]}this.isDirty=!1}},cancel:function(){var e=Object.assign({},u["MatomoUrl"].hashParsed.value);delete e.idContainerVersion,u["MatomoUrl"].updateHash(e)},createVersion:function(){var e=this;this.removeAnyVersionNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVersion=!0,yc.createOrUpdateVersion(this.version,"TagManager.createContainerVersion",this.idContainer).then((function(t){if(t){e.isDirty=!1;var n=t.value;if(e.isEmbedded)return e.version.idcontainerversion=n,void e.$emit("changeVersion",{version:e.version});yc.reload(e.idContainer).then((function(){u["MatomoUrl"].updateHash(Object.assign(Object.assign({},u["MatomoUrl"].hashParsed.value),{},{idContainerVersion:n})),setTimeout((function(){var t=Object(u["translate"])("TagManager_CreatedX",Object(u["translate"])("TagManager_Version"));if(e.hasPublishCapability()){var n=Object(u["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(t," ").concat(n),"success","transient")}else e.showNotification(t,"success")}),200)}))}})).finally((function(){e.isUpdatingVersion=!1})))},createVersionAndPublish:function(){var e=this;this.removeAnyVersionNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVersion=!0,yc.createOrUpdateVersion(this.version,"TagManager.createContainerVersion",this.idContainer).then((function(t){if(!t)return null;var n=t.value;return e.version.idcontainerversion=n,yc.publishVersion(e.idContainer,n,e.version.environments[0]).then((function(){e.isDirty=!1,e.isEmbedded?e.$emit("changeVersion",{version:e.version}):yc.reload(e.idContainer).then((function(){u["MatomoUrl"].updateHash(Object.assign(Object.assign({},u["MatomoUrl"].hashParsed.value),{},{idContainerVersion:n})),setTimeout((function(){e.showNotification(Object(u["translate"])("TagManager_VersionPublishSuccess"),"success")}),200)}))}))})).finally((function(){e.isUpdatingVersion=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateVersion:function(){var e=this;this.removeAnyVersionNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVersion=!0,yc.createOrUpdateVersion(this.version,"TagManager.updateContainerVersion",this.idContainer).then((function(t){t&&(e.isEmbedded?e.$emit("changeVersion",{version:e.version}):(e.isDirty=!1,e.version={},yc.reload(e.idContainer).then((function(){e.initIdContainerVersion()})),e.showNotification(Object(u["translate"])("TagManager_UpdatedX",Object(u["translate"])("TagManager_Version")),"success")))})).finally((function(){e.isUpdatingVersion=!1})))},checkRequiredFieldsAreSet:function(){if(!this.version.name){var e=Object(u["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(e),!1}return!0},hasPublishCapability:function(){return this.hasWriteCapability()&&u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},hasWriteCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_write")},hasPublishToLiveCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_publish_live_container")}},computed:{create:function(){return 0===this.idContainerVersion},edit:function(){return!this.create},isLoading:function(){return vt.isLoading.value||Ct.isLoading.value},isUpdating:function(){return vt.isUpdating.value||this.isUpdatingVersion},environments:function(){var e=Ql.environmentsWithPublishOptions.value;if(!this.canPublishToLive){var t=e.findIndex((function(e){return"live"===e.key}));t>-1&&(e[t].disabled=!0)}return e},canPublishToLive:function(){return u["Matomo"].hasUserCapability("tagmanager_publish_live_container")},versionNameHelpText:function(){return Object(r["markRaw"])(kc)},selectTagManagerEnvironmentHelp:function(){return Object(r["markRaw"])(Ac)},editTitle:function(){return this.create?Object(u["translate"])("TagManager_CreateNewVersion"):Object(u["translate"])("TagManager_EditVersion")},showNoAccessErrorMessage:function(){return Object(u["translate"])("TagManager_VersionEditWithNoAccessMessage",Object(u["externalLink"])("https://matomo.org/faq/tag-manager/faq_26547/"),"</a>")}}});Hc.render=Wl;var Gc=Hc,$c={class:"tagManagerManageList tagManagerVersionList"},Rc={class:"versionSearchFilter"},qc=["title"],zc=["title"],Wc=["title"],Xc=["title"],Kc=["title"],Jc=["title"],Yc={colspan:"7"},Zc={class:"loadingPiwik"},Qc=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),es={colspan:"7"},ts=["id"],ns={class:"index"},as=["title"],is=["title"],rs={class:"environments"},os=["title"],ls={class:"created"},cs={class:"action"},ss=["onClick","title"],ds=["onClick","title"],us=["onClick","href","title"],gs=["onClick","title"],bs=["onClick","title"],ms={class:"tableActionBar"},ps=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),hs=["href"],fs=Object(r["createElementVNode"])("span",{class:"icon-export"},"",-1),vs=Object(r["createElementVNode"])("span",{class:"icon-upload"},"",-1),js={class:"ui-confirm",id:"confirmDeleteVersion",ref:"confirmDeleteVersion"},Os=["value"],Ts=["value"],ys={class:"ui-confirm",id:"confirmPublishVersion",ref:"confirmPublishVersion"},Vs={key:0,class:"alert alert-info",style:{"margin-top":"16px"}},Cs=["value"],Ns=["value"];function Es(e,t,n,a,i,o){var l,c=Object(r["resolveComponent"])("Field"),s=Object(r["resolveComponent"])("ContentBlock"),d=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",$c,[Object(r["createVNode"])(s,{feature:"Tag Manager","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Versions")),"help-text":e.versionsHelpText},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_VersionUsageBenefits"))+" "+Object(r["toDisplayString"])(e.translate("TagManager_ConfigureEnvironmentsSuperUser")),1),Object(r["createElementVNode"])("div",Rc,[Object(r["withDirectives"])(Object(r["createVNode"])(c,{uicontrol:"text",name:"versionSearch",title:e.translate("General_Search"),modelValue:e.versionSearch,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.versionSearch=t})},null,8,["title","modelValue"]),[[r["vShow"],e.versions.length>0]])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",{class:"index",title:e.revisionTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_Revision")),9,qc),Object(r["createElementVNode"])("th",{class:"name",title:e.nameTranslatedText},Object(r["toDisplayString"])(e.translate("General_Name")),9,zc),Object(r["createElementVNode"])("th",{class:"description",title:e.descriptionTranslatedText},Object(r["toDisplayString"])(e.translate("General_Description")),9,Wc),Object(r["createElementVNode"])("th",{class:"environments",title:e.environmentTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_Environments")),9,Xc),Object(r["createElementVNode"])("th",{class:"created",title:e.createdTranslatedText},Object(r["toDisplayString"])(e.translate("TagManager_Created")),9,Kc),Object(r["createElementVNode"])("th",{class:"action",title:e.actionTranslatedText},Object(r["toDisplayString"])(e.translate("General_Actions")),9,Jc)])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Yc,[Object(r["createElementVNode"])("span",Zc,[Qc,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",es,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_NoVersionsFound"))+" ",1),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createContainerVersionNow",onClick:t[1]||(t[1]=function(t){return e.createVersion()})},Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVersionNow")),513),[[r["vShow"],e.hasWriteAccess&&e.hasCustomTemplatesCapability]])])],512),[[r["vShow"],!e.isLoading&&0===e.versions.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedVersions,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{id:"version".concat(t.idcontainerversion),class:"versions",key:t.revision},[Object(r["createElementVNode"])("td",ns,Object(r["toDisplayString"])(t.revision),1),Object(r["createElementVNode"])("td",{class:"name",title:t.name},Object(r["toDisplayString"])(e.truncateText(t.name,50)),9,as),Object(r["createElementVNode"])("td",{class:"description",title:t.description},Object(r["toDisplayString"])(e.truncateText(t.description,75)),9,is),Object(r["createElementVNode"])("td",rs,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(t.releases,(function(n,a){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:a,title:e.translate("TagManager_ReleaseInfo",n.release_login,n.release_date_pretty)},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.ucfirst(n.environment)),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",null,", ",512),[[r["vShow"],a!==t.releases.length-1]])],8,os)})),128))]),Object(r["createElementVNode"])("td",ls,[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(t.created_date_pretty),1)]),Object(r["createElementVNode"])("td",cs,[Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-rocket",onClick:function(n){return e.publishVersion(t)},title:e.translate("TagManager_PublishVersion",t.name)},null,8,ss),[[r["vShow"],e.hasWriteAccess&&(e.hasCustomTemplatesCapability||e.canPublishToLive)]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-bug",onClick:function(n){return e.enableDebugMode(t.idcontainerversion)},title:e.translate("TagManager_EnablePreviewDebug")},null,8,ds),[[r["vShow"],e.hasWriteAccess]]),Object(r["createElementVNode"])("a",{target:"_blank",class:"table-action icon-export",onClick:Object(r["withModifiers"])((function(n){e.exportVersion(t.idcontainerversion,t.name)}),["prevent"]),href:e.getExportUrl(t),title:e.translate("TagManager_ExportX",e.translate("TagManager_Version"))},null,8,us),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editVersion(t.idcontainerversion)},title:e.translate("TagManager_EditX",e.translate("TagManager_Version"))},null,8,gs),[[r["vShow"],e.hasWriteAccess]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteVersion(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Version"))},null,8,bs),[[r["vShow"],0===t.releases.length&&e.hasWriteAccess&&e.hasCustomTemplatesCapability]])])],8,ts)})),128))])],512),[[d]]),Object(r["createElementVNode"])("div",ms,[Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createNewVersion",onClick:t[2]||(t[2]=function(t){return e.createVersion()})},[ps,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVersion")),1)],512),[[r["vShow"],e.hasWriteAccess&&e.hasCustomTemplatesCapability]]),Object(r["createElementVNode"])("a",{class:"exportDraft",target:"_blank",onClick:t[3]||(t[3]=function(t){e.exportVersion(null,"draft"),t.preventDefault()}),href:e.getExportDraftUrl()},[fs,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_ExportDraft")),1)],8,hs),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"importVersion",onClick:t[4]||(t[4]=function(t){return e.importVersion()})},[vs,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_Import")),1)],512),[[r["vShow"],e.hasWriteAccess&&e.hasCustomTemplatesCapability]])])]})),_:1},8,["content-title","help-text"]),Object(r["createElementVNode"])("div",js,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_DeleteVersionConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Os),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Ts)],512),Object(r["createElementVNode"])("div",ys,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_PublishVersion",null===(l=e.versionToBePublished)||void 0===l?void 0:l.name)),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{uicontrol:"select",name:"environment",modelValue:e.availableEnvironmentsToPublish.deployEnvironment,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.availableEnvironmentsToPublish.deployEnvironment=t}),options:e.availableEnvironmentsToPublish.environnments,"full-width":!0,title:e.translate("TagManager_Environment")},null,8,["modelValue","options","title"])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{style:{"margin-bottom":"0"},class:"alert alert-info"},Object(r["toDisplayString"])(e.translate("TagManager_PublishLiveEnvironmentCapabilityRequired",e.translate("TagManager_CapabilityPublishLiveContainer"))),513),[[r["vShow"],!e.canPublishToLive]])],512),[[r["vShow"],e.availableEnvironmentsToPublish.environnments.length]]),e.availableEnvironmentsToPublish.environnments.length?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Vs,Object(r["toDisplayString"])(e.translate("TagManager_VersionAlreadyPublishedToAllEnvironments")),1)),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("TagManager_PublishRelease")},null,8,Cs),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_Cancel")},null,8,Ns)],512)])}function Ss(e){return _s(e)||Ms(e)||ks(e)||ws()}function ws(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ks(e,t){if(e){if("string"===typeof e)return Ds(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ds(e,t):void 0}}function Ms(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _s(e){if(Array.isArray(e))return Ds(e)}function Ds(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var As=window,xs=As.tagManagerHelper,Bs=Object(r["defineComponent"])({props:{idContainer:{type:String,required:!0},versionsHelpText:String},components:{ContentBlock:u["ContentBlock"],Field:g["Field"]},directives:{ContentTable:u["ContentTable"]},data:function(){return{versionToBePublished:null,versionSearch:""}},created:function(){Ql.init(),yc.fetchVersions(this.idContainer)},methods:{createVersion:function(){this.editVersion(0)},truncateText:function(e,t){return xs.truncateText(e,t)},publishVersion:function(e){var t=this;this.versionToBePublished=e,u["Matomo"].helper.modalConfirm(this.$refs.confirmPublishVersion,{yes:function(){var n=t.availableEnvironmentsToPublish.deployEnvironment;n&&yc.publishVersion(e.idcontainer,e.idcontainerversion,n).then((function(){yc.reload(t.idContainer)}))}})},enableDebugMode:function(e){xs.enablePreviewMode(this.idContainer,e)},exportVersion:function(e,t){var n={module:"API",method:"TagManager.exportContainerVersion",format:"json",idContainer:this.idContainer,filter_limit:-1};e&&(n.idContainerVersion=e);var a="container_".concat(this.idContainer);t&&(a+="_".concat(t)),u["AjaxHelper"].fetch(n).then((function(e){u["Matomo"].helper.sendContentAsDownload("".concat(a,".json"),JSON.stringify(e))}))},editVersion:function(e){u["MatomoUrl"].updateHash(Object.assign(Object.assign({},u["MatomoUrl"].hashParsed.value),{},{idContainerVersion:e}))},importVersion:function(){xs.importVersion(this.idContainer)},deleteVersion:function(e){var t=this,n=function(){yc.deleteVersion(t.idContainer,e.idcontainerversion).then((function(){yc.reload(t.idContainer)}))};u["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteVersion,{yes:n})},ucfirst:function(e){return"".concat(e.substring(0,1).toUpperCase()).concat(e.substring(1))},getExportUrl:function(e){return"?module=TagManager&action=exportContainerVersion&idContainer=".concat(this.idContainer)+"&idContainerVersion=".concat(e.idcontainerversion,"&idSite=").concat(e.idsite)+"&period=day&date=yesterday"},getExportDraftUrl:function(){return"?module=TagManager&action=exportContainerVersion&idContainer=".concat(this.idContainer)+"&idSite=".concat(this.idSite,"&period=day&date=yesterday")}},computed:{environments:function(){return Ql.environmentsWithPublishOptions.value},availableEnvironmentsToPublish:function(){var e=this,t="",n=this.environments.filter((function(n){var a,i;if(null===(a=e.versionToBePublished)||void 0===a||!a.releases)return!0;var r=null===(i=e.versionToBePublished)||void 0===i?void 0:i.releases.some((function(e){return e.environment===(null===n||void 0===n?void 0:n.key)}));return r||t||(t=n.key),!r}));return{deployEnvironment:t,environnments:n}},idSite:function(){return u["Matomo"].idSite},isLoading:function(){return yc.isLoading.value},isUpdating:function(){return yc.isUpdating.value},versions:function(){return yc.versions.value},sortedVersions:function(){var e=this.versionSearch.toLowerCase(),t=Ss(this.versions).filter((function(t){return Object.keys(t).some((function(n){var a=t,i="";return"string"===typeof a[n]?i=a[n]:"releases"===n&&Object.values(a.releases).forEach((function(e){e.environment&&(i+="".concat(e.environment," "))})),-1!==i.toLowerCase().indexOf(e)}))}));return t.sort((function(e,t){return e.revision<t.revision?1:e.revision>t.revision?0:1})),t},hasWriteAccess:function(){return u["Matomo"].hasUserCapability("tagmanager_write")},hasCustomTemplatesCapability:function(){return u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},canPublishToLive:function(){return u["Matomo"].hasUserCapability("tagmanager_publish_live_container")},revisionTranslatedText:function(){return this.translate("TagManager_VersionsRevisionDescription")},nameTranslatedText:function(){return this.translate("TagManager_VersionsNameDescription")},descriptionTranslatedText:function(){return this.translate("TagManager_VersionsDescriptionDescription")},environmentTranslatedText:function(){return this.translate("TagManager_VersionsEnvironmentsDescription")},createdTranslatedText:function(){return this.translate("TagManager_VersionsCreatedDescription")},actionTranslatedText:function(){return this.translate("TagManager_VersionsActionDescription")}}});Bs.render=Es;var Ls=Bs,Us={class:"manageVersion"},Ps={key:0},Is={key:1};function Fs(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("VersionList"),c=Object(r["resolveComponent"])("VersionEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Us,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Ps,[Object(r["createVNode"])(l,{"id-container":e.idContainer,"versions-help-text":e.versionsHelpText},null,8,["id-container","versions-help-text"])])),e.editMode?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Is,[Object(r["createVNode"])(c,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion},null,8,["id-container","id-container-version"])])):Object(r["createCommentVNode"])("",!0)])}var Hs=Object(r["defineComponent"])({props:{idContainer:String,versionsHelpText:String},components:{VersionList:Ls,VersionEdit:Gc},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(r["watch"])((function(){return u["MatomoUrl"].hashParsed.value.idContainerVersion}),(function(t){e.onIdContainerVersionParamChange(t)})),u["NotificationsStore"].remove("versiontagmanagement"),this.onIdContainerVersionParamChange(u["MatomoUrl"].hashParsed.value.idContainerVersion)},methods:{onIdContainerVersionParamChange:function(e){if("0"===e){var t={isAllowed:!0};u["Matomo"].postEvent("TagManager.initAddVersion",t),this.isAddAllowed=!!t.isAllowed}}},computed:{idContainerVersion:function(){var e=u["MatomoUrl"].hashParsed.value.idContainerVersion;return this.isAddAllowed||"0"!==e?e?parseInt(e,10):e:null},editMode:function(){return"number"===typeof this.idContainerVersion}}});Hs.render=Fs;var Gs=Hs,$s={class:"loadingPiwik"},Rs=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),qs={class:"loadingPiwik"},zs=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Ws={class:"entityCancel"};function Xs(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("SaveButton"),s=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createBlock"])(s,{class:"editContainer tagManagerManageEdit",feature:"Tag Manager","content-title":e.editTitle},{default:Object(r["withCtx"])((function(){return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",$s,[Rs,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",qs,[zs,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["createElementVNode"])("form",{onSubmit:t[8]||(t[8]=function(t){return e.edit?e.updateContainer():e.createContainer()})},[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",null,[Object(r["withDirectives"])(Object(r["createVNode"])(l,{uicontrol:"text",name:"idcontainer","model-value":e.container.idcontainer,disabled:!0,title:e.translate("General_Id")},null,8,["model-value","title"]),[[r["vShow"],e.edit]])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"select",name:"context","model-value":e.container.context,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.container.context=t,e.setValueHasChanged()}),disabled:!0,options:e.contexts,title:e.translate("TagManager_Context"),"inline-help":e.translate("TagManager_ContainerContextHelp")},null,8,["model-value","options","title","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"text",name:"name","model-value":e.container.name,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.container.name=t,e.setValueHasChanged()}),maxlength:255,title:e.translate("General_Name"),"inline-help":e.translate("TagManager_ContainerNameHelp"),placeholder:e.translate("TagManager_ContainerNamePlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"textarea",name:"description","model-value":e.container.description,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.container.description=t,e.setValueHasChanged()}),title:e.translate("TagManager_Description"),"inline-help":e.translate("TagManager_ContainerDescriptionHelp"),placeholder:e.translate("TagManager_ContainerDescriptionPlaceholder")},null,8,["model-value","title","inline-help","placeholder"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"checkbox",name:"ignoreGtmDataLayer","model-value":e.container.ignoreGtmDataLayer,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.container.ignoreGtmDataLayer=t,e.setValueHasChanged()}),title:e.translate("TagManager_IgnoreGtmDataLaterTitle"),"inline-help":e.translate("TagManager_IgnoreGtmDataLaterDescription")},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"checkbox",name:"activelySyncGtmDataLayer","model-value":e.container.activelySyncGtmDataLayer,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.container.activelySyncGtmDataLayer=t,e.setValueHasChanged()}),title:e.translate("TagManager_ActivelySyncGtmDataLayerTitle"),"inline-help":e.translate("TagManager_ActivelySyncGtmDataLayerDescription")},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"checkbox",name:"isTagFireLimitAllowedInPreviewMode","model-value":e.container.isTagFireLimitAllowedInPreviewMode,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.container.isTagFireLimitAllowedInPreviewMode=t,e.setValueHasChanged()}),title:e.translate("TagManager_TagFireLimitAllowedInPreviewModeTitle"),"inline-help":e.translate("TagManager_TagFireLimitAllowedInPreviewModeDescription")},null,8,["model-value","title","inline-help"])]),Object(r["createVNode"])(c,{class:"createButton",onConfirm:t[6]||(t[6]=function(t){return e.edit?e.updateContainer():e.createContainer()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.edit?e.translate("CoreUpdater_UpdateTitle"):e.translate("TagManager_CreateNewContainer")},null,8,["disabled","saving","value"]),Object(r["createElementVNode"])("div",Ws,[Object(r["createElementVNode"])("a",{onClick:t[7]||(t[7]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]})),_:1},8,["content-title"])}function Ks(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Js(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ys(e,t,n){return t&&Js(e.prototype,t),n&&Js(e,n),e}function Zs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Qs=function(){function e(){var t=this;Ks(this,e),Zs(this,"privateState",Object(r["reactive"])({contexts:[],isLoading:!1})),Zs(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),Zs(this,"isLoading",Object(r["computed"])((function(){return t.state.value.isLoading}))),Zs(this,"contexts",Object(r["computed"])((function(){return t.state.value.contexts}))),Zs(this,"contextsOptions",Object(r["computed"])((function(){return t.contexts.value.map((function(e){var t=e.id,n=e.name;return{key:t,value:n}}))}))),Zs(this,"initializePromise",null)}return Ys(e,[{key:"init",value:function(){return this.initializePromise||(this.initializePromise=this.fetchAvailableContexts()),this.initializePromise}},{key:"fetchAvailableContexts",value:function(){var e=this;return this.privateState.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getAvailableContexts",filter_limit:"-1"}).then((function(t){var n;n=Array.isArray(t)?t:Object.values(t),e.privateState.contexts=n})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),ed=new Qs;function td(e){return rd(e)||id(e)||ad(e)||nd()}function nd(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ad(e,t){if(e){if("string"===typeof e)return od(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?od(e,t):void 0}}function id(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function rd(e){if(Array.isArray(e))return od(e)}function od(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ld(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cd(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function sd(e,t,n){return t&&cd(e.prototype,t),n&&cd(e,n),e}function dd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var ud=function(){function e(){var t=this;ld(this,e),dd(this,"privateState",Object(r["reactive"])({containers:[],isLoadingContainers:!1,isLoadingSingle:!1,isUpdating:!1})),dd(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),dd(this,"isLoading",Object(r["computed"])((function(){var e=t.state.value;return e.isLoadingContainers||e.isLoadingSingle}))),dd(this,"isUpdating",Object(r["computed"])((function(){return t.state.value.isUpdating}))),dd(this,"containers",Object(r["computed"])((function(){return t.state.value.containers}))),dd(this,"fetchPromise",null)}return sd(e,[{key:"reload",value:function(){return this.privateState.containers=[],this.fetchPromise=null,this.fetchContainers()}},{key:"fetchContainers",value:function(){var e=this;return this.privateState.isLoadingContainers=!0,this.privateState.containers=[],this.fetchPromise||(this.fetchPromise=u["AjaxHelper"].fetch({method:"TagManager.getContainers",filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(t){return e.privateState.containers=t,e.privateState.isLoadingContainers=!1,e.containers.value})).finally((function(){e.privateState.isLoadingContainers=!1}))}},{key:"findContainer",value:function(e){var t=this,n=this.containers.value.find((function(t){return t.idcontainer===e}));return n?Promise.resolve(n):(this.privateState.isLoadingSingle=!0,u["AjaxHelper"].fetch({idContainer:e,method:"TagManager.getContainer",filter_limit:"-1"}).then((function(e){return t.privateState.containers=[].concat(td(t.privateState.containers),[e]),Object(r["readonly"])(e)})).finally((function(){t.privateState.isLoadingSingle=!1})))}},{key:"deleteContainer",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.containers=[],u["AjaxHelper"].fetch({idContainer:e,method:"TagManager.deleteContainer"},{withTokenInUrl:!0}).finally((function(){t.privateState.isUpdating=!1}))}},{key:"createOrUpdateContainer",value:function(e,t){var n=this;return this.privateState.isUpdating=!0,u["AjaxHelper"].post({method:t,idContainer:e.idcontainer},{name:e.name,description:e.description,ignoreGtmDataLayer:e.ignoreGtmDataLayer,activelySyncGtmDataLayer:e.activelySyncGtmDataLayer,isTagFireLimitAllowedInPreviewMode:e.isTagFireLimitAllowedInPreviewMode,context:e.context},{withTokenInUrl:!0}).finally((function(){n.privateState.isUpdating=!1}))}}]),e}(),gd=new ud,bd="containertagmanagement",md=Object(r["defineComponent"])({props:{idContainer:String},components:{ContentBlock:u["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"]},data:function(){return{isDirty:!1,editTitle:"",isUpdatingVersion:!1,container:{}}},created:function(){ed.init(),Ct.init(),this.initIdContainer()},watch:{idContainer:function(e){null!==e&&this.initIdContainer()}},methods:{removeAnyContainerNotification:function(){u["NotificationsStore"].remove(bd),u["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=u["NotificationsStore"].show({message:e,context:t,id:bd,type:"toast"});setTimeout((function(){u["NotificationsStore"].scrollToNotification(n)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(u["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdContainer:function(){var e=this;this.container={},u["Matomo"].helper.lazyScrollToContent(),this.edit&&this.idContainer?(this.editTitle=Object(u["translate"])("TagManager_EditContainer"),gd.findContainer(this.idContainer).then((function(t){t&&(e.container=Object(u["clone"])(t),e.isDirty=!1)}))):this.create&&(this.editTitle=Object(u["translate"])("TagManager_CreateNewContainer"),this.container={idSite:u["Matomo"].idSite,name:"",context:"web",description:"",activelySyncGtmDataLayer:!0},this.isDirty=!1)},cancel:function(){var e=Object.assign({},u["MatomoUrl"].hashParsed.value);delete e.idContainer,u["MatomoUrl"].updateHash(e)},createContainer:function(){var e=this;this.removeAnyContainerNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVersion=!0,gd.createOrUpdateContainer(this.container,"TagManager.addContainer").then((function(t){if(e.isUpdatingVersion=!1,t){e.isDirty=!1;var n=t.value;e.showNotification(Object(u["translate"])("TagManager_CreatedX",Object(u["translate"])("TagManager_Container")),"success"),u["MatomoUrl"].updateUrl(Object.assign(Object.assign({},u["MatomoUrl"].urlParsed.value),{},{module:"TagManager",action:"dashboard",idContainer:n}))}})).finally((function(){e.isUpdatingVersion=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateContainer:function(){var e=this;this.removeAnyContainerNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdating=!0,gd.createOrUpdateContainer(this.container,"TagManager.updateContainer").then((function(t){t&&(e.isDirty=!1,e.container={},gd.reload().then((function(){e.initIdContainer()})),e.showNotification(Object(u["translate"])("TagManager_UpdatedX",Object(u["translate"])("TagManager_Container")),"success"))})))},checkRequiredFieldsAreSet:function(){if(!this.container.name){var e=Object(u["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(e),!1}return!0}},computed:{contexts:function(){return ed.contextsOptions.value},create:function(){return"0"===this.idContainer},edit:function(){return!this.create},isLoading:function(){return vt.isLoading.value||Ct.isLoading.value},isUpdating:function(){return vt.isUpdating.value||this.isUpdatingVersion}}});md.render=Xs;var pd=md,hd={class:"tagManagerManageList tagManagerContainerList"},fd=["innerHTML"],vd={class:"index"},jd={class:"name"},Od={class:"description"},Td={class:"created"},yd={class:"action"},Vd={colspan:"5"},Cd={class:"loadingPiwik"},Nd=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Ed={colspan:"5"},Sd=["id"],wd=["title"],kd=["title"],Md=["title"],_d={class:"created"},Dd=["href","title"],Ad=["onClick","title"],xd=["onClick","title"],Bd=["onClick","title"],Ld=["onClick","title"],Ud={class:"tableActionBar"},Pd=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),Id={class:"ui-confirm",id:"confirmDeleteContainer",ref:"confirmDeleteContainer"},Fd=["value"],Hd=["value"];function Gd(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("ContentBlock"),c=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",hd,[Object(r["createVNode"])(l,{feature:"Tag Manager","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Containers"))},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.getManageContainersIntro)},null,8,fd),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",vd,Object(r["toDisplayString"])(e.translate("General_Id")),1),Object(r["createElementVNode"])("th",jd,Object(r["toDisplayString"])(e.translate("General_Name")),1),Object(r["createElementVNode"])("th",Od,Object(r["toDisplayString"])(e.translate("General_Description")),1),Object(r["createElementVNode"])("th",Td,Object(r["toDisplayString"])(e.translate("TagManager_CreatedDate")),1),Object(r["createElementVNode"])("th",yd,Object(r["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Vd,[Object(r["createElementVNode"])("span",Cd,[Nd,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Ed,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_NoContainersFound"))+" ",1),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"createContainerNow",onClick:t[0]||(t[0]=function(t){return e.createContainer()})},Object(r["toDisplayString"])(e.translate("TagManager_CreateNewContainerNow")),513),[[r["vShow"],e.hasWriteAccess]])])],512),[[r["vShow"],!e.isLoading&&0===e.containers.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedContainers,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{id:"container".concat(t.idcontainer),class:"containers",key:t.idcontainer},[Object(r["createElementVNode"])("td",{class:"index",title:"".concat(e.translate("TagManager_Context"),": ")+e.contexts[t.context]},Object(r["toDisplayString"])(t.idcontainer),9,wd),Object(r["createElementVNode"])("td",{class:"name",title:t.name},Object(r["toDisplayString"])(e.truncateText(t.name,50)),9,kd),Object(r["createElementVNode"])("td",{class:"description",title:t.description},Object(r["toDisplayString"])(e.truncateText(t.description,75)),9,Md),Object(r["createElementVNode"])("td",_d,[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(t.created_date_pretty),1)]),Object(r["createElementVNode"])("td",{class:Object(r["normalizeClass"])(e.getActionClasses)},[Object(r["createElementVNode"])("a",{class:"table-action icon-configure",href:"?module=TagManager&action="+e.containerDefaultAction+"&idContainer="+t.idcontainer+"&idSite="+t.idsite+"&period=day&date=yesterday",title:e.translate("TagManager_ConfigureX",e.translate("TagManager_Container"))},null,8,Dd),Object(r["createElementVNode"])("a",{class:"table-action installCode icon-embed",onClick:function(n){return e.installCode(t.idcontainer)},title:e.translate("TagManager_InstallCode")},null,8,Ad),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editContainer(t.idcontainer)},title:e.translate("TagManager_EditX",e.translate("TagManager_Container"))},null,8,xd),[[r["vShow"],e.hasWriteAccess]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteContainer(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Container"))},null,8,Bd),[[r["vShow"],e.hasWriteAccess]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action icon-content-copy",onClick:function(n){return e.openCopyDialog(t)},title:e.translate("TagManager_CopyX",e.translate("TagManager_Container"))},null,8,Ld),[[r["vShow"],e.canCopyContainer]])],2)],8,Sd)})),128))])],512),[[c]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",Ud,[Object(r["createElementVNode"])("a",{class:"createNewContainer",value:"",onClick:t[1]||(t[1]=function(t){return e.createContainer()})},[Pd,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewContainer")),1)])],512),[[r["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title"]),Object(r["createElementVNode"])("div",Id,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_DeleteContainerConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Fd),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Hd)],512)])}function $d(e){return Wd(e)||zd(e)||qd(e)||Rd()}function Rd(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qd(e,t){if(e){if("string"===typeof e)return Xd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xd(e,t):void 0}}function zd(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Wd(e){if(Array.isArray(e))return Xd(e)}function Xd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Kd=window,Jd=Kd.tagManagerHelper,Yd=Object(r["defineComponent"])({props:{isSuperUser:{type:Boolean,required:!0}},components:{ContentBlock:u["ContentBlock"]},directives:{ContentTable:u["ContentTable"]},created:function(){ed.init(),gd.fetchContainers()},computed:{contexts:function(){var e={};return ed.contexts.value.forEach((function(t){var n=t.id,a=t.name;e[n]=a})),e},hasWriteAccess:function(){return u["Matomo"].hasUserCapability("tagmanager_write")},containerDefaultAction:function(){return this.hasWriteAccess?"dashboard":"manageTags"},isLoading:function(){return yc.isLoading.value},isUpdating:function(){return yc.isUpdating.value},containers:function(){return gd.containers.value},sortedContainers:function(){var e=$d(this.containers);return e.sort((function(e,t){return e.created_date<t.created_date?1:e.created_date>t.created_date?-1:0})),e},getManageContainersIntro:function(){var e=Object(u["externalLink"])("https://matomo.org/guide/tag-manager/getting-started-with-tag-manager/");return Object(u["translate"])("TagManager_ManageContainersIntro",e,"</a>")},canCopyContainer:function(){return u["Matomo"].hasUserCapability("tagmanager_write")&&u["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},getActionClasses:function(){var e=this.canCopyContainer?" hasCopyAction":"";return"action".concat(e)}},methods:{createContainer:function(){this.editContainer("0")},editContainer:function(e){u["MatomoUrl"].updateHash(Object.assign(Object.assign({},u["MatomoUrl"].hashParsed.value),{},{idContainer:e}))},installCode:function(e){Jd.showInstallCode(e)},deleteContainer:function(e){function t(){gd.deleteContainer(e.idcontainer).then((function(){gd.reload(),u["NotificationsStore"].remove("CopyDialogResultNotification")}))}u["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteContainer,{yes:t})},truncateText:function(e,t){return e.length>t?"".concat(e.substr(0,t-3),"..."):e},openCopyDialog:function(e){var t=u["MatomoUrl"].stringify({module:"TagManager",action:"copyContainerDialog",idSite:e.idsite,idContainer:e.idcontainer});window.Piwik_Popover.createPopupAndLoadUrl(t,"","mtmCopyContainer")}}});Yd.render=Gd;var Zd=Yd,Qd={class:"manageContainer"};function eu(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("ContainerList"),c=Object(r["resolveComponent"])("ContainerEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Qd,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{"is-super-user":e.isSuperUser},null,8,["is-super-user"])],512),[[r["vShow"],!e.editMode]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{"id-container":e.idContainer},null,8,["id-container"])],512),[[r["vShow"],e.editMode]])])}var tu=Object(r["defineComponent"])({props:{isSuperUser:{type:Boolean,required:!0}},components:{ContainerList:Zd,ContainerEdit:pd},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(r["watch"])((function(){return u["MatomoUrl"].hashParsed.value.idContainer}),(function(t){e.onIdContainerParamChange(t)})),u["NotificationsStore"].remove("containertagmanagement"),this.onIdContainerParamChange(u["MatomoUrl"].hashParsed.value.idContainer)},computed:{idContainer:function(){var e=u["MatomoUrl"].hashParsed.value.idContainer;return this.isAddAllowed||""!==e?e:null},editMode:function(){return!!this.idContainer}},methods:{onIdContainerParamChange:function(e){if("0"===e){var t={isAllowed:!0};u["Matomo"].postEvent("TagManager.initAddVersion",t),this.isAddAllowed=!!t.isAllowed}}}});tu.render=eu;var nu=tu,au={class:"containerDashboard"},iu={key:0},ru={class:"dashboardCreationDate"},ou={key:0},lu=Object(r["createElementVNode"])("br",null,null,-1),cu=["innerHTML"],su={class:"row",style:{"margin-left":"-0.75rem"}},du={class:"col m6 s12"},uu={key:0},gu=["href","title"],bu={key:0},mu=Object(r["createElementVNode"])("hr",null,null,-1),pu=["href"],hu=Object(r["createElementVNode"])("span",{class:"icon-edit"},"",-1),fu=["href"],vu=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),ju={class:"col m6 s12"},Ou={key:0},Tu=["href","title"],yu=Object(r["createElementVNode"])("hr",null,null,-1),Vu=["href"],Cu=Object(r["createElementVNode"])("span",{class:"icon-edit"},"",-1),Nu=["href"],Eu=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),Su={class:"row",style:{"margin-left":"-0.75rem"}},wu={class:"col m6 s12"},ku=["href","title"],Mu={key:0},_u=Object(r["createElementVNode"])("hr",null,null,-1),Du=["href"],Au=Object(r["createElementVNode"])("span",{class:"icon-edit"},"",-1),xu=["href"],Bu=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1),Lu={class:"col m6 s12"},Uu=["title","href"],Pu={key:0},Iu=Object(r["createElementVNode"])("br",null,null,-1),Fu=["title"],Hu={key:0},Gu=Object(r["createElementVNode"])("hr",null,null,-1),$u=["href"],Ru=Object(r["createElementVNode"])("span",{class:"icon-edit"},"",-1),qu=["href"],zu=Object(r["createElementVNode"])("span",{class:"icon-add"},"",-1);function Wu(e,t,n,a,i,o){var l,c,s=Object(r["resolveComponent"])("ActivityIndicator"),d=Object(r["resolveComponent"])("EnrichedHeadline"),u=Object(r["resolveComponent"])("ContentBlock"),g=Object(r["resolveDirective"])("content-intro");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",au,[Object(r["createVNode"])(s,{loading:e.isLoading},null,8,["loading"]),e.isLoading?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",iu,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("h2",null,[Object(r["createVNode"])(d,{"feature-name":"Tag Manager","inline-help":e.dashboardHelpText},{default:Object(r["withCtx"])((function(){var t;return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_ContainerX",null===(t=e.container)||void 0===t?void 0:t.name)),1)]})),_:1},8,["inline-help"])]),Object(r["createElementVNode"])("p",ru,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.containerMetaInformation)+" ",1),null!==(l=e.containerVersion)&&void 0!==l&&l.description?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",ou,[lu,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_Description"))+": "+Object(r["toDisplayString"])(null===(c=e.containerVersion)||void 0===c?void 0:c.description),1)])):Object(r["createCommentVNode"])("",!0)]),Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.containerDashboardDescription)},null,8,cu)],512),[[g]]),Object(r["createElementVNode"])("div",su,[Object(r["createElementVNode"])("div",du,[Object(r["createVNode"])(u,{feature:"Tag Manager","content-title":"".concat(e.tagCount," ").concat(e.translate("TagManager_Tags")),"help-text":e.tagsHelpText},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,[e.tagCount?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",uu,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_Names"))+": ",1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedContainerVersionTags,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:n},[Object(r["createElementVNode"])("a",{href:e.linkTo("manageTags",{idTag:t.idtag}),title:e.translate("TagManager_EntityDateTypeMetaInformation",t.created_date_pretty,t.updated_date_pretty,t.type)},Object(r["toDisplayString"])(t.name),9,gu),n!==e.sortedContainerVersionTags.length-1?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",bu,", ")):Object(r["createCommentVNode"])("",!0)])})),128))])):Object(r["createCommentVNode"])("",!0)]),mu,Object(r["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageTags")},[hu,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_EditTags")),1)],8,pu),Object(r["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageTags",{idTag:0})},[vu,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewTag")),1)],8,fu)]})),_:1},8,["content-title","help-text"])]),Object(r["createElementVNode"])("div",ju,[Object(r["createVNode"])(u,{feature:"Tag Manager","content-title":"".concat(e.triggerCount," ").concat(e.translate("TagManager_Triggers")),"help-text":e.triggersHelpText},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,[e.triggerCount?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Ou,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_Names"))+": ",1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedTriggers,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:n},[Object(r["createElementVNode"])("a",{href:e.linkTo("manageTriggers",{idTrigger:t.idtrigger}),title:e.translate("TagManager_EntityDateTypeMetaInformation",t.created_date_pretty,t.updated_date_pretty,t.type)},Object(r["toDisplayString"])(t.name),9,Tu),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",null,", ",512),[[r["vShow"],n!==e.sortedTriggers.length-1]])])})),128))])):Object(r["createCommentVNode"])("",!0)]),yu,Object(r["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageTriggers")},[Cu,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_EditTriggers")),1)],8,Vu),Object(r["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageTriggers",{idTrigger:0})},[Eu,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewTrigger")),1)],8,Nu)]})),_:1},8,["content-title","help-text"])])]),Object(r["createElementVNode"])("div",Su,[Object(r["createElementVNode"])("div",wu,[Object(r["createVNode"])(u,{feature:"Tag Manager","content-title":"".concat(e.variableCount," ").concat(e.translate("TagManager_Variables")),"help-text":e.variablesHelpText},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_Names"))+": ",1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedVariables,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:n},[Object(r["createElementVNode"])("a",{href:e.linkTo("manageVariables",{idVariable:t.idvariable}),title:e.translate("TagManager_EntityDateTypeMetaInformation",t.created_date_pretty,t.updated_date_pretty,t.type)},Object(r["toDisplayString"])(t.name),9,ku),n!==e.sortedVariables.length-1?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Mu,", ")):Object(r["createCommentVNode"])("",!0)])})),128))],512),[[r["vShow"],e.variableCount]])]),_u,Object(r["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageVariables")},[Au,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_EditVariables")),1)],8,Du),Object(r["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageVariables",{idVariable:0})},[Bu,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVariable")),1)],8,xu)]})),_:1},8,["content-title","help-text"])]),Object(r["createElementVNode"])("div",Lu,[Object(r["createVNode"])(u,{feature:"Tag Manager","content-title":"".concat(e.versionCount," ").concat(e.translate("TagManager_Versions")),"help-text":e.versionsHelpText},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("span",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_LastVersions"))+": ",1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.lastVersions,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:n},[Object(r["createElementVNode"])("a",{title:e.lastVersionLinkTitle(t),href:e.linkTo("manageVersions",{idContainerVersion:t.idcontainerversion})},Object(r["toDisplayString"])(t.name),9,Uu),n!==e.lastVersions.length-1?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Pu,", ")):Object(r["createCommentVNode"])("",!0)])})),128))],512),[[r["vShow"],e.lastVersions.length]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",null,[Iu,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("TagManager_Environments"))+": ",1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.container.releases,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:n},[Object(r["createElementVNode"])("span",{title:e.releaseTooltip(t)},Object(r["toDisplayString"])(e.ucfirst(t.environment)),9,Fu),n!==e.container.releases.length-1?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",Hu,", ")):Object(r["createCommentVNode"])("",!0)])})),128))],512),[[r["vShow"],e.container.releases.length]])]),Gu,Object(r["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageVersions")},[Ru,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_EditVersions")),1)],8,$u),Object(r["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageVersions",{idContainerVersion:0})},[zu,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_CreateNewVersion")),1)],8,qu)]})),_:1},8,["content-title","help-text"])])])]))])}function Xu(e){e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}))}var Ku=Object(r["defineComponent"])({props:{idContainer:String,dashboardHelpText:String,tagsHelpText:String,triggersHelpText:String,variablesHelpText:String,versionsHelpText:String},components:{ActivityIndicator:u["ActivityIndicator"],EnrichedHeadline:u["EnrichedHeadline"],ContentBlock:u["ContentBlock"]},directives:{ContentIntro:u["ContentIntro"]},data:function(){return{container:null,containerVersion:null,isLoading:!1}},created:function(){var e=this;ed.init(),this.isLoading=!0;var t=u["AjaxHelper"].fetch({method:"TagManager.getContainer",idContainer:this.idContainer}).then((function(t){e.container=t})),n=u["AjaxHelper"].fetch({method:"TagManager.exportContainerVersion",idContainer:this.idContainer}).then((function(t){e.containerVersion=t}));Promise.all([t,n]).finally((function(){e.isLoading=!1}))},methods:{linkTo:function(e,t){var n=u["MatomoUrl"].stringify(Object.assign(Object.assign({},u["MatomoUrl"].urlParsed.value),{},{module:"TagManager",action:e}));return t&&(n+="#?".concat(u["MatomoUrl"].stringify(t))),"?".concat(n)},lastVersionLinkTitle:function(e){return"Created on ".concat(e.created_date_pretty)+", description: '".concat(e.description,"'")},releaseTooltip:function(e){var t=Object(u["translate"])("TagManager_ReleaseInfo",e.release_login,e.release_date_pretty),n=Object(u["translate"])("TagManager_ReleaseVersionInfo",e.version_name);return"".concat(t," ").concat(n)},ucfirst:function(e){return"".concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}},computed:{lastVersions:function(){var e,t;return null!==(e=this.container)&&void 0!==e&&null!==(t=e.versions)&&void 0!==t&&t.length?this.container.versions.slice(0,5):[]},contexts:function(){var e={};return ed.contexts.value.forEach((function(t){var n=t.id,a=t.name;e[n]=a})),e},containerMetaInformation:function(){var e;return Object(u["translate"])("TagManager_ContainerIdInformation",(null===(e=this.containerVersion)||void 0===e?void 0:e.idcontainer)||"")},containerDashboardDescription:function(){var e=Object(u["externalLink"])("https://matomo.org/guide/tag-manager/getting-started-with-tag-manager/");return Object(u["translate"])("TagManager_ContainerDashboardDescription",e,"</a>")},sortedContainerVersionTags:function(){var e,t=(null===(e=this.containerVersion)||void 0===e?void 0:e.tags)||[];return Xu(t),t},sortedTriggers:function(){var e,t=(null===(e=this.containerVersion)||void 0===e?void 0:e.triggers)||[];return Xu(t),t},sortedVariables:function(){var e,t=(null===(e=this.containerVersion)||void 0===e?void 0:e.variables)||[];return Xu(t),t},tagCount:function(){var e;return null===(e=this.containerVersion)||void 0===e?void 0:e.tags.length},triggerCount:function(){var e;return null===(e=this.containerVersion)||void 0===e?void 0:e.triggers.length},versionCount:function(){var e;return null===(e=this.container)||void 0===e?void 0:e.versions.length},variableCount:function(){var e;return null===(e=this.containerVersion)||void 0===e?void 0:e.variables.length}}});Ku.render=Wu;var Ju=Ku,Yu=["title"],Zu={class:"title"},Qu=Object(r["createElementVNode"])("span",{class:"icon icon-chevron-down"},"",-1),eg={class:"dropdown positionInViewport"},tg={class:"custom_select_container"},ng={class:"custom_select_ul_list"},ag=["title"],ig=["href"];function rg(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("ActivityIndicator"),c=Object(r["resolveDirective"])("focus-anywhere-but-here");return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])(["tagContainerSelector piwikSelector borderedControl",{expanded:e.showContainerList}]),onClick:t[1]||(t[1]=function(t){e.fetchContainers(),e.showContainerList=!e.showContainerList}),title:e.translate("TagManager_ChooseContainer")},[Object(r["createElementVNode"])("a",Zu,[Qu,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.truncateText(e.actualContainerName,50)),1)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",eg,[Object(r["createVNode"])(l,{loading:e.isLoading},null,8,["loading"]),Object(r["createElementVNode"])("div",tg,[Object(r["createElementVNode"])("ul",ng,[Object(r["withDirectives"])(Object(r["createElementVNode"])("li",null,[Object(r["createElementVNode"])("a",{tabindex:"-1",onClick:t[0]||(t[0]=Object(r["withModifiers"])((function(){}),["prevent","stop"]))},Object(r["toDisplayString"])(e.translate("TagManager_NoContainersFound")),1)],512),[[r["vShow"],!e.isLoading&&0===e.containers.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.containers,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{title:"".concat(t.name," (").concat(t.idcontainer,")"),key:t.idcontainer},[Object(r["createElementVNode"])("a",{href:e.linkTo(t.idcontainer)},Object(r["toDisplayString"])(t.name)+" ("+Object(r["toDisplayString"])(t.idcontainer)+") ",9,ig)],8,ag)})),128))])])],512),[[r["vShow"],e.showContainerList]])],10,Yu)),[[c,{blur:e.onBlur}]])}var og=window,lg=og.tagManagerHelper,cg=Object(r["defineComponent"])({props:{containerName:String},components:{ActivityIndicator:u["ActivityIndicator"]},directives:{FocusAnywhereButHere:u["FocusAnywhereButHere"]},data:function(){return{containers:[],isLoading:!1,showContainerList:!1}},created:function(){setTimeout((function(){window.initTopControls()}))},methods:{fetchContainers:function(){var e=this;this.isLoading=!0,this.containers=[],u["AjaxHelper"].fetch({method:"TagManager.getContainers"}).then((function(t){e.containers=t})).finally((function(){e.isLoading=!1}))},linkTo:function(e){var t=u["MatomoUrl"].urlParsed.value.action;t&&"manageContainers"!==t||(t=this.hasWriteAccess?"dashboard":"manageTags");var n=u["MatomoUrl"].stringify(Object.assign(Object.assign({},u["MatomoUrl"].urlParsed.value),{},{idContainer:e,action:t}));return"".concat(window.location.pathname,"?").concat(n)},onBlur:function(){this.showContainerList=!1},truncateText:function(e,t){return lg.truncateText(e,t)}},computed:{actualContainerName:function(){return this.containerName?Object(u["translate"])("TagManager_ContainerX",this.containerName):Object(u["translate"])("TagManager_ChooseContainer")},hasWriteAccess:function(){return u["Matomo"].hasUserCapability("tagmanager_write")}}});cg.render=rg;var sg=cg,dg={style:{"margin-left":"-0.75rem"}},ug=Object(r["createElementVNode"])("br",null,null,-1),gg=["href"],bg=["textContent"],mg={style:{"margin-top":"1rem"}},pg=["innerHTML"],hg=Object(r["createElementVNode"])("br",null,null,-1),fg=["href"],vg={class:"environment"},jg={class:"name"},Og={class:"name"},Tg={class:"released_by"},yg={class:"released_on"},Vg={key:0},Cg={colspan:"7"},Ng={class:"loadingPiwik"},Eg=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Sg={key:1},wg={colspan:"7"},kg={class:"environment"},Mg={class:"name"},_g={class:"revision"},Dg={class:"released_by"},Ag={class:"released_on"},xg={class:"date"};function Bg(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveComponent"])("ActivityIndicator"),s=Object(r["resolveComponent"])("ContentBlock"),d=Object(r["resolveDirective"])("copy-to-clipboard"),u=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createBlock"])(s,{class:"manageInstallTagCode",feature:"Tag Manager","content-title":"Install Code"},{default:Object(r["withCtx"])((function(){var n,a;return[Object(r["createElementVNode"])("div",dg,[Object(r["createVNode"])(l,{uicontrol:"select",name:"environment","model-value":e.environment,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.environment=t,e.fetchInstallInstructions(e.environment)}),options:e.environments,title:e.translate("TagManager_Environment")},null,8,["model-value","options","title"])]),Object(r["createVNode"])(c,{loading:e.isLoading},null,8,["loading"]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.installInstructions,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:n},[Object(r["createElementVNode"])("p",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.description)+" ",1),ug,t.helpUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,target:"_blank",href:t.helpUrl},Object(r["toDisplayString"])(e.translate("TagManager_LearnMore")),9,gg)):Object(r["createCommentVNode"])("",!0)]),Object(r["createElementVNode"])("div",null,[t.embedCode?Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("pre",{key:0,textContent:Object(r["toDisplayString"])(t.embedCode)},null,8,bg)),[[d,{}]]):Object(r["createCommentVNode"])("",!0)])])})),128)),Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_InstallCodePublishEnvironmentNote","preview"))+" "+Object(r["toDisplayString"])(e.translate("TagManager_ConfigureEnvironmentsSuperUser")),1),Object(r["createElementVNode"])("p",mg,[Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("TagManager_InstallCodeDataLayerNote","<strong>","</strong>"))},null,8,pg),hg,Object(r["createElementVNode"])("a",{target:"_blank",href:e.externalRawLink("https://matomo.org/faq/tag-manager/data-layer-in-matomo-tag-manager/")},Object(r["toDisplayString"])(e.translate("TagManager_LearnMore")),9,fg)]),Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("TagManager_ReleasesOverview")),1),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",vg,Object(r["toDisplayString"])(e.translate("TagManager_Environment")),1),Object(r["createElementVNode"])("th",jg,Object(r["toDisplayString"])(e.translate("TagManager_VersionName")),1),Object(r["createElementVNode"])("th",Og,Object(r["toDisplayString"])(e.translate("TagManager_VersionRevision")),1),Object(r["createElementVNode"])("th",Tg,Object(r["toDisplayString"])(e.translate("TagManager_ReleasedBy")),1),Object(r["createElementVNode"])("th",yg,Object(r["toDisplayString"])(e.translate("TagManager_ReleasedOn")),1)])]),Object(r["createElementVNode"])("tbody",null,[e.isLoading?(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",Vg,[Object(r["createElementVNode"])("td",Cg,[Object(r["createElementVNode"])("span",Ng,[Eg,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])])):Object(r["createCommentVNode"])("",!0),e.isLoading||0!==(null===(n=e.container)||void 0===n||null===(a=n.releases)||void 0===a?void 0:a.length)?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",Sg,[Object(r["createElementVNode"])("td",wg,Object(r["toDisplayString"])(e.translate("TagManager_NoReleasesFound")),1)])),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedReleases,(function(t){var n,a;return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:t.idcontainerrelease},[Object(r["createElementVNode"])("td",kg,Object(r["toDisplayString"])(e.ucfirst(t.environment)),1),Object(r["createElementVNode"])("td",Mg,Object(r["toDisplayString"])(null===(n=e.releaseVersions[t.idcontainerrelease])||void 0===n?void 0:n.name),1),Object(r["createElementVNode"])("td",_g,Object(r["toDisplayString"])(null===(a=e.releaseVersions[t.idcontainerrelease])||void 0===a?void 0:a.revision),1),Object(r["createElementVNode"])("td",Dg,Object(r["toDisplayString"])(t.release_login),1),Object(r["createElementVNode"])("td",Ag,[Object(r["createElementVNode"])("span",xg,Object(r["toDisplayString"])(t.release_date_pretty),1)])])})),128))])],512),[[u]])]})),_:1})}function Lg(e){return Ig(e)||Pg(e)||Gg(e)||Ug()}function Ug(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Pg(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ig(e){if(Array.isArray(e))return $g(e)}function Fg(e,t){return qg(e)||Rg(e,t)||Gg(e,t)||Hg()}function Hg(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Gg(e,t){if(e){if("string"===typeof e)return $g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$g(e,t):void 0}}function $g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Rg(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function qg(e){if(Array.isArray(e))return e}var zg=window,Wg=zg.$,Xg=Object(r["defineComponent"])({props:{idContainer:{type:String,required:!0}},components:{ContentBlock:u["ContentBlock"],Field:g["Field"],ActivityIndicator:u["ActivityIndicator"]},directives:{SelectOnFocus:u["SelectOnFocus"],ContentTable:u["ContentTable"],CopyToClipboard:u["CopyToClipboard"]},data:function(){return{container:null,environments:[],environment:"live",installInstructions:[],isLoading:!1,isLoadingInstructions:!1}},created:function(){var e=this;this.isLoading=!0,this.fetchReleases().finally((function(){e.isLoading=!1}))},methods:{fetchInstallInstructions:function(e){var t=this;return this.installInstructions=[],this.isLoadingInstructions=!0,u["AjaxHelper"].fetch({method:"TagManager.getContainerInstallInstructions",filter_limit:"-1",idContainer:this.idContainer,environment:e}).then((function(e){t.installInstructions=e,Object(r["nextTick"])((function(){var e=Array.isArray(t.$refs.codeblock)?t.$refs.codeblock:[t.$refs.codeblock];e.forEach((function(e){Wg(e).effect("highlight",{},1500)}))}))})).finally((function(){t.isLoadingInstructions=!1}))},fetchReleases:function(){var e=this;return u["AjaxHelper"].fetch([{method:"TagManager.getAvailableEnvironments",filter_limit:"-1"},{method:"TagManager.getContainer",idContainer:this.idContainer,filter_limit:"-1"}]).then((function(t){var n,a,i=Fg(t,2),r=i[0],o=i[1];e.environments=r.map((function(e){return{key:e.id,value:e.name}})),e.container=o;var l=o.releases.some((function(e){return"live"===e.environment}));if(!l&&null!==(n=e.environments)&&void 0!==n&&null!==(a=n[0])&&void 0!==a&&a.key?e.environment=e.environments[0].key:l||(e.environment=""),e.environment)return e.fetchInstallInstructions(e.environment)}))},ucfirst:function(e){return"".concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}},computed:{releaseVersions:function(){var e,t=this,n={};return((null===(e=this.container)||void 0===e?void 0:e.releases)||[]).forEach((function(e){n[e.idcontainerrelease]=t.container.versions.find((function(t){return t.idcontainerversion===e.idcontainerversion}))})),n},sortedReleases:function(){var e,t=Lg(((null===(e=this.container)||void 0===e?void 0:e.releases)||[]).map((function(e,t){return Object.assign(Object.assign({},e),{},{index:t})})));return t.sort((function(e,t){return e.release_date<t.release_date?1:e.release_date>t.release_date?-1:t.index-e.index})),t}}});Xg.render=Bg;var Kg=Xg,Jg={class:"tagManagerTrackingCode"},Yg={key:0},Zg={class:"trackingCodeAdvancedOptions"},Qg={class:"advance-option"},eb=Object(r["createElementVNode"])("span",{class:"icon-chevron-down"},null,-1),tb=Object(r["createElementVNode"])("span",{class:"icon-chevron-up"},null,-1),nb={id:"mtm-advanced-options"},ab=["innerHTML"],ib={key:1,class:"row"},rb={class:"col s12 m4 "},ob={class:"form-group row"},lb={class:"col s12 input-field"},cb={for:"tagManagerTrackingCodeSite",class:"siteSelectorLabel"},sb={class:"sites_autocomplete"},db={class:"col s12 m4"},ub={class:"col s12 m4"},gb=["innerHTML"],bb={key:1,class:"alert alert-info"},mb={href:""},pb={key:0},hb=["href"],fb=Object(r["createTextVNode"])(". "),vb=["innerHTML"],jb=["textContent"],Ob=["innerHTML"],Tb={key:1};function yb(e,t,n,a,i,o){var l=this,c=Object(r["resolveComponent"])("ActivityIndicator"),s=Object(r["resolveComponent"])("SiteSelector"),d=Object(r["resolveComponent"])("Field"),u=Object(r["resolveDirective"])("copy-to-clipboard");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Jg,[e.showContainerRow?(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",Yg,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_OptionallyCustomiseContainer"))+" ",1),Object(r["createElementVNode"])("div",Zg,[Object(r["createElementVNode"])("div",Qg,[Object(r["createElementVNode"])("span",null,[e.isAdvancedDisplayed?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,href:"javascript:;",onClick:t[0]||(t[0]=Object(r["withModifiers"])((function(t){return e.isAdvancedDisplayed=!0}),["prevent"]))},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("CoreAdminHome_ShowAdvancedOptions"))+" ",1),eb])),e.isAdvancedDisplayed?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:1,href:"javascript:;",onClick:t[1]||(t[1]=Object(r["withModifiers"])((function(t){return e.isAdvancedDisplayed=!1}),["prevent"]))},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("CoreAdminHome_HideAdvancedOptions"))+" ",1),tb])):Object(r["createCommentVNode"])("",!0)])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",nb,[Object(r["createElementVNode"])("ul",null,[Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.getAdvancedStepText)},null,8,ab),e.showContainerRow||e.environments.length>1?Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createBlock"])(c,{key:0,loading:!0},null,512)),[[r["vShow"],e.isLoading]]):Object(r["createCommentVNode"])("",!0),e.showContainerRow||e.environments.length>1?Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ib,[Object(r["createElementVNode"])("div",rb,[Object(r["createElementVNode"])("div",ob,[Object(r["createElementVNode"])("div",lb,[Object(r["createElementVNode"])("label",cb,Object(r["toDisplayString"])(e.translate("General_Website")),1),Object(r["createElementVNode"])("div",sb,[Object(r["createVNode"])(s,{id:"tagManagerTrackingCodeSite",modelValue:e.site,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.site=t}),"show-all-sites-item":!1,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["modelValue"])])])])]),Object(r["createElementVNode"])("div",db,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(d,{uicontrol:"select",name:"containers","model-value":e.idContainer,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.idContainer=t,e.onContainerChange()}),options:e.containerOptions,disabled:e.containerOptions.length<=1,"full-width":!0,title:e.translate("TagManager_Container")},null,8,["model-value","options","disabled","title"])])]),Object(r["createElementVNode"])("div",ub,[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(d,{uicontrol:"select",name:"environment","model-value":e.environment,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.environment=t,l.$emit("fetchInstallInstructions")}),options:e.environments,disabled:e.environments.length<=1,"full-width":!0,title:e.translate("TagManager_Environment")},null,8,["model-value","options","disabled","title"])])])],512)),[[r["vShow"],!e.isLoading]]):Object(r["createCommentVNode"])("",!0),e.idContainer?(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:2,innerHTML:e.$sanitize(e.getAdvancedStepInfo)},null,8,gb)):Object(r["createCommentVNode"])("",!0)])],512),[[r["vShow"],e.isAdvancedDisplayed]])])])):Object(r["createCommentVNode"])("",!0),e.idContainer&&e.noReleaseFound?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",bb,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("TagManager_NoReleasesFoundForContainer"))+" ",1),Object(r["createElementVNode"])("a",mb,Object(r["toDisplayString"])(e.translate("TagManager_PublishVersionToEnvironmentToViewEmbedCode")),1)])):Object(r["createCommentVNode"])("",!0),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.installInstructions,(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:n},[e.showDescription?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",pb,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.description)+" ",1),t.helpUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,target:"_blank",href:t.helpUrl},Object(r["toDisplayString"])(e.translate("TagManager_LearnMore")),9,hb)):Object(r["createCommentVNode"])("",!0),fb])):Object(r["createCommentVNode"])("",!0),e.showPlainMtmSteps?(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{key:1,innerHTML:e.$sanitize(e.getMtmStep3)},null,8,vb)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("pre",{class:"codeblock",textContent:Object(r["toDisplayString"])(t.embedCode),ref:"codeblock"},null,8,jb),[[u,{}]])])],64)})),128)),e.showBottom&&!e.noReleaseFound&&e.idContainer?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:2},[e.showTestSection?(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",Tb,[(Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])(e.testComponent),{site:e.site},null,8,["site"]))])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(e.getCongratulationsText)},null,8,Ob))],64)):Object(r["createCommentVNode"])("",!0)])}function Vb(e){return"".concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}var Cb=Object(r["defineComponent"])({props:{showContainerRow:Boolean,showBottom:Boolean,showDescription:Boolean,showPlainMtmSteps:Boolean,showTestSection:Boolean,showAdvancedOptions:{required:!1,type:Boolean,default:!1}},components:{ActivityIndicator:u["ActivityIndicator"],SiteSelector:u["SiteSelector"],Field:g["Field"]},emits:["fetchInstallInstructions"],directives:{CopyToClipboard:u["CopyToClipboard"]},data:function(){return{containerVariables:[],isLoading:!1,idContainer:"",environment:"",environments:[],environmentNameMap:{},containerMap:{},containerOptions:[],site:{id:u["Matomo"].idSite,name:u["Matomo"].helper.htmlDecode(u["Matomo"].siteName)},matomoConfigs:[],releases:[],installInstructions:[],noReleaseFound:!1,isAdvancedDisplayed:!1}},created:function(){var e=this;u["AjaxHelper"].fetch({method:"TagManager.getAvailableEnvironments",filter_limit:"-1"}).then((function(t){var n;n=Array.isArray(t)?t:Object.values(t),e.environmentNameMap=Object.fromEntries(n.map((function(e){var t=e.id,n=e.name;return[t,n]})))})),this.onSiteChange(),this.isAdvancedDisplayed=this.showAdvancedOptions},watch:{site:function(){this.onSiteChange()}},methods:{onSiteChange:function(){var e,t=this;this.installInstructions=[],this.containerOptions=[],this.containerMap={},this.environments=[],this.matomoConfigs=[],this.idContainer="",null!==(e=this.site)&&void 0!==e&&e.id&&(this.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getContainers",filter_limit:"-1",idSite:this.site.id}).then((function(e){if(t.containerOptions=[],null===e||void 0===e||!e.length)return t.idContainer="",t.isAdvancedDisplayed=!0,void t.containerOptions.push({key:"",value:t.translate("TagManager_NoContainersFound")});e.forEach((function(e){t.idContainer||(t.idContainer=e.idcontainer),t.containerMap[e.idcontainer]=e,t.containerOptions.push({key:e.idcontainer,value:e.name})})),t.onContainerChange()})).finally((function(){t.isLoading=!1})))},onContainerChange:function(){var e=this;if(this.noReleaseFound=!1,this.idContainer){this.installInstructions=[];var t=this.containerMap[this.idContainer],n=t.draft.idcontainerversion;this.environment="",this.environments=[];var a=t.releases||[];a.find((function(e){return"live"===e.environment}))&&(this.environment="live"),a.forEach((function(t){if("preview"!==t.environment){e.environment||(e.environment=t.environment);var n=Vb(t.environment);t.environment in e.environmentNameMap&&(n=e.environmentNameMap[t.environment]),e.environments.push({key:t.environment,value:n})}})),this.environments.length||(this.noReleaseFound=!0,this.environments.push({key:"",value:this.translate("TagManager_NoReleasesFound")})),this.$emit("fetchInstallInstructions"),this.fetchVariables(n)}},linkTo:function(e,t,n,a){var i=u["MatomoUrl"].stringify(Object.assign(Object.assign({},u["MatomoUrl"].urlParsed.value),{},{module:"TagManager",action:e,idSite:t,idContainer:n})),r="".concat(window.location.pathname,"?").concat(i);return a&&(r+="#?".concat(u["MatomoUrl"].stringify(a))),r},fetchVariables:function(e){var t,n=this;this.matomoConfigs=[],this.idContainer&&null!==(t=this.site)&&void 0!==t&&t.id&&e&&u["AjaxHelper"].fetch({method:"TagManager.getContainerVariables",filter_limit:"-1",idContainer:this.idContainer,idContainerVersion:e,idSite:this.site.id}).then((function(e){n.matomoConfigs=e.filter((function(e){return"MatomoConfiguration"===e.type}))})).finally((function(){n.isLoading=!1}))}},computed:{getLearnMoreLink:function(){return Object(u["translate"])("TagManager_CustomHtmlTagHelpText",Object(u["externalLink"])("https://matomo.org/faq/tag-manager/container-dashboard-in-matomo-tag-manager/"),"</a>")},getMtmStep3:function(){return Object(u["translate"])("TagManager_CopyCodePasteInHeader","&lt;/head&gt;")},getCongratulationsText:function(){return Object(u["translate"])("TagManager_SiteWithoutDataReactFollowStepCompleted","<strong>","</strong>")},testComponent:function(){return this.showTestSection?Object(u["useExternalPluginComponent"])("JsTrackerInstallCheck","JsTrackerInstallCheck"):""},getAdvancedStepText:function(){var e,t=Object(u["translate"])("TagManager_SelectContainerForWebsite","<strong>","</strong>");if(this.idContainer)return t;var n=this.linkTo("manageContainers",String(null===(e=this.site)||void 0===e?void 0:e.id),""),a=Object(u["translate"])("TagManager_ManageContainersLink",'<a href="'.concat(n,'" target="_blank" rel="noreferrer noopener">'),"</a>");return"".concat(t," ").concat(a)},getAdvancedStepInfo:function(){var e=this.site&&this.site.id?this.site.id:"",t=this.linkTo("dashboard",e,this.idContainer,[]);return Object(u["translate"])("TagManager_CustomiseContainer",'<a href="'.concat(t,'">'),"</a>",Object(u["externalLink"])("https://matomo.org/faq/tag-manager/container-dashboard-in-matomo-tag-manager/"),"</a>")}}});Cb.render=yb;var Nb=Cb,Eb=Object(r["createElementVNode"])("br",null,null,-1),Sb={class:"followStepsHeading"},wb={style:{"list-style":"inside decimal"}};function kb(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("TrackingCodeCommon");return Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])("getTrackingMethodsForSite"===e.currentAction?"div":"ContentBlock"),{anchor:"tagmanager","content-title":e.translate("TagManager_MatomoTagManager")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("TagManager_MtmTrackingCodeIntro")),1),Eb,Object(r["createElementVNode"])("p",Sb,[Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataCloudflareFollowStepsIntro")),1)]),Object(r["createElementVNode"])("ol",wb,[Object(r["createVNode"])(l,{"show-container-row":e.showContainerRow,showBottom:!0,showDescription:!1,showPlainMtmSteps:!0,showAdvancedOptions:"trackingCodeGenerator"===e.currentAction,showTestSection:"getTrackingMethodsForSite"===e.currentAction&&e.isJsTrackerInstallCheckAvailable,onFetchInstallInstructions:e.fetchInstallInstructions,ref:"trackingCodeCommon"},null,8,["show-container-row","showAdvancedOptions","showTestSection","onFetchInstallInstructions"])])]})),_:1},8,["content-title"])}var Mb=Object(r["defineComponent"])({props:{currentAction:String,showContainerRow:Boolean,isJsTrackerInstallCheckAvailable:Boolean},components:{ContentBlock:u["ContentBlock"],TrackingCodeCommon:Nb},methods:{fetchInstallInstructions:function(){var e,t,n=this,a=this.$refs.trackingCodeCommon;a.installInstructions=[],null!==a&&void 0!==a&&null!==(e=a.site)&&void 0!==e&&e.id&&null!==a&&void 0!==a&&a.environment&&(a.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getContainerInstallInstructions",filter_limit:"-1",idContainer:null===a||void 0===a?void 0:a.idContainer,environment:null===a||void 0===a?void 0:a.environment,idSite:null===a||void 0===a||null===(t=a.site)||void 0===t?void 0:t.id}).then((function(e){a.installInstructions=e,Object(r["nextTick"])((function(){var e=Array.isArray(n.$refs.codeblock)?n.$refs.codeblock:[n.$refs.codeblock];e.forEach((function(e){$(e).effect("highlight",{},1500)}))}))})).finally((function(){a.isLoading=!1})))}}});Mb.render=kb;var _b=Mb,Db={class:"list-style-decimal"},Ab={ref:"step1"},xb=["innerHTML"],Bb=["innerHTML"],Lb=["textContent"],Ub=["innerHTML"],Pb=["textContent"],Ib=["innerHTML"],Fb=["innerHTML"],Hb=["innerHTML"],Gb=["textContent"],$b={style:{"list-style":"lower-alpha","list-style-position":"inside"}},Rb=["innerHTML"],qb=["innerHTML"],zb=["innerHTML"],Wb=["textContent"],Xb=["textContent"],Kb=["innerHTML"],Jb=["textContent"],Yb=["innerHTML"],Zb=["innerHTML"],Qb=["textContent"];function em(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("TrackingCodeCommon"),c=Object(r["resolveDirective"])("copy-to-clipboard");return Object(r["openBlock"])(),Object(r["createElementBlock"])("ol",Db,[Object(r["withDirectives"])(Object(r["createElementVNode"])("li",Ab,[Object(r["createVNode"])(l,{"show-container-row":e.showContainerRow,showBottom:!1,showDescription:!1,onFetchInstallInstructions:e.fetchInstallInstructionsSPA,ref:"trackingCodeCommon"},null,8,["show-container-row","onFetchInstallInstructions"])],512),[[r["vShow"],e.step1HasContent]]),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.setupStep2)},null,8,xb),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.fetchFollowStep3)},null,8,Bb),Object(r["createElementVNode"])("li",{textContent:Object(r["toDisplayString"])(e.fetchClickX("TagManager_CreateNewTrigger"))},null,8,Lb),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.fetchFollowStep5)},null,8,Ub),Object(r["createElementVNode"])("li",{textContent:Object(r["toDisplayString"])(e.fetchClickX("TagManager_CreateNewTrigger"))},null,8,Pb),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.setupStep7)},null,8,Ib),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.fetchFollowStep8)},null,8,Fb),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.fetchFollowStep9)},null,8,Hb),Object(r["createElementVNode"])("li",null,[Object(r["createElementVNode"])("span",{textContent:Object(r["toDisplayString"])(e.fetchFollowStep10)},null,8,Gb),Object(r["createElementVNode"])("ol",$b,[Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.fetchFollowStep10a)},null,8,Rb),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.fetchFollowStep10b)},null,8,qb)])]),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.fetchFollowStep11)},null,8,zb),Object(r["createElementVNode"])("li",{textContent:Object(r["toDisplayString"])(e.fetchClickX("General_Update"))},null,8,Wb),Object(r["createElementVNode"])("li",{textContent:Object(r["toDisplayString"])(e.fetchFollowStep13)},null,8,Xb),Object(r["createElementVNode"])("li",{innerHTML:e.$sanitize(e.fetchFollowStep14)},null,8,Kb),Object(r["createElementVNode"])("li",{textContent:Object(r["toDisplayString"])(e.fetchFollowStep15)},null,8,Jb),Object(r["createElementVNode"])("li",null,["react"===e.jsFramework?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:0,innerHTML:e.$sanitize(e.fetchFollowStep16React)},null,8,Yb)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:1,innerHTML:e.$sanitize(e.fetchFollowStep16SPA)},null,8,Zb)),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.installInstructions,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:t},[Object(r["withDirectives"])(Object(r["createElementVNode"])("pre",{class:"codeblock",textContent:Object(r["toDisplayString"])(e.embedCode),ref:"codeblock"},null,8,Qb),[[c,{}]])])})),128))])])}var tm=Object(r["defineComponent"])({props:{showContainerRow:Boolean,jsFramework:String},components:{TrackingCodeCommon:Nb},directives:{CopyToClipboard:u["CopyToClipboard"]},data:function(){return{setupStep1:"",setupStep2:"",setupStep7:"",installInstructions:[]}},methods:{fetchInstallInstructionsSPA:function(){var e,t,n=this,a=this.$refs.trackingCodeCommon;if(this.installInstructions=[],null!==a&&void 0!==a&&a.idContainer&&null!==a&&void 0!==a&&a.environment&&null!==a&&void 0!==a&&null!==(e=a.site)&&void 0!==e&&e.id){var i=this.linkTo("manageContainers",a.site.id,a.idContainer);this.setupStep1=Object(u["translate"])("TagManager_SPAFollowStep1","<br><strong>","</strong>",'<a href="'.concat(i,'" target="_blank" rel="noreferrer noopener">'),"</a>");var o=this.linkTo("manageTriggers",a.site.id,a.idContainer);this.setupStep2=Object(u["translate"])("TagManager_SPAFollowStep2",'<a href="'.concat(o,'" target="_blank" rel="noreferrer noopener">'),"</a>");var l=this.linkTo("manageTags",a.site.id,a.idContainer);this.setupStep7=Object(u["translate"])("TagManager_SPAFollowStep7",'<a href="'.concat(l,'" target="_blank" rel="noreferrer noopener">'),"</a>"),a.isLoading=!0,u["AjaxHelper"].fetch({method:"TagManager.getContainerInstallInstructions",filter_limit:"-1",idContainer:null===a||void 0===a?void 0:a.idContainer,environment:null===a||void 0===a?void 0:a.environment,idSite:null===a||void 0===a||null===(t=a.site)||void 0===t?void 0:t.id,jsFramework:this.jsFramework}).then((function(e){n.installInstructions=e,Object(r["nextTick"])((function(){var e=Array.isArray(n.$refs.codeblock)?n.$refs.codeblock:[n.$refs.codeblock];e.forEach((function(e){$(e).effect("highlight",{},1500)}))}))})).finally((function(){a.isLoading=!1}))}},linkTo:function(e,t,n,a){var i=u["MatomoUrl"].stringify(Object.assign(Object.assign({},u["MatomoUrl"].urlParsed.value),{},{module:"TagManager",action:e,idSite:t,idContainer:n}));return a&&(i+="#?".concat(u["MatomoUrl"].stringify(a))),"?".concat(i)},fetchClickX:function(e){return Object(u["translate"])("General_ClickX",Object(u["translate"])(e))}},computed:{step1HasContent:function(){var e=this.$refs.step1;return e&&""!==e.textContent},fetchFollowStep3:function(){return Object(u["translate"])("TagManager_SPAFollowStep3","<strong>".concat(Object(u["translate"])("TagManager_PageViewTriggerName"),"</strong>"),Object(u["translate"])("TagManager_PageViewTriggerName"),Object(u["externalLink"])("https://matomo.org/faq/tag-manager/how-do-i-track-pageviews-of-my-website-using-matomo-tag-manager/#create-pageview-trigger"),"</a>")},fetchFollowStep5:function(){return Object(u["translate"])("TagManager_SPAFollowStep5","<strong>".concat(Object(u["translate"])("TagManager_HistoryChangeTriggerName"),"</strong>"),Object(u["translate"])("TagManager_CategoryUserEngagement"))},fetchFollowStep8:function(){return Object(u["translate"])("TagManager_SPAFollowStep8","<strong>".concat(Object(u["translate"])("TagManager_PageViewTriggerName"),"</strong>"),"<strong>".concat(Object(u["translate"])("TagManager_MatomoTagName"),"</strong>"),Object(u["translate"])("TagManager_PageViewTriggerName"),Object(u["externalLink"])("https://matomo.org/faq/tag-manager/how-do-i-track-pageviews-of-my-website-using-matomo-tag-manager/#create-pageview-tag"),"</a>")},fetchFollowStep9:function(){return Object(u["translate"])("TagManager_SPAFollowStep9",Object(u["translate"])("TagManager_ConfigureWhatTagDoes"),Object(u["translate"])("TagManager_CustomTitle"),"<strong>","</strong>")},fetchFollowStep10:function(){return Object(u["translate"])("TagManager_SPAFollowStep10",Object(u["translate"])("TagManager_CustomUrl"))},fetchFollowStep10a:function(){return Object(u["translate"])("TagManager_SPAFollowStep10a","<strong>","</strong>",Object(u["translate"])("TagManager_CustomUrl"))},fetchFollowStep10b:function(){return Object(u["translate"])("TagManager_SPAFollowStep10b",Object(u["translate"])("TagManager_CustomUrl"),"<strong>","</strong>")},fetchFollowStep11:function(){return Object(u["translate"])("TagManager_SPAFollowStep11",Object(u["translate"])("TagManager_ConfigureWhenTagDoes"),Object(u["translate"])("TagManager_FireTriggerTitle"),"<strong>".concat(Object(u["translate"])("TagManager_HistoryChangeTriggerName"),"</strong>"),"<strong>".concat(Object(u["translate"])("TagManager_PageViewTriggerName"),"</strong>"))},fetchFollowStep13:function(){return Object(u["translate"])("TagManager_SPAFollowStep13",Object(u["translate"])("TagManager_Publish"))},fetchFollowStep14:function(){return Object(u["translate"])("TagManager_SPAFollowStep14",Object(u["translate"])("TagManager_VersionName"),"<strong>","</strong>")},fetchFollowStep15:function(){return Object(u["translate"])("TagManager_SPAFollowStep15",Object(u["translate"])("TagManager_CreateVersionAndPublishRelease"))},fetchFollowStep16SPA:function(){return Object(u["translate"])("TagManager_SPAFollowStep16","&lt;/head&gt;",Object(u["externalLink"])("https://developer.matomo.org/guides/tagmanager/embedding"),"</a>")},fetchFollowStep16React:function(){return Object(u["translate"])("TagManager_ReactFollowStep16","<strong>","</strong>","<strong>App.js</strong>","<strong>React.useEffect</strong>","<strong>Hello World</strong>","<strong>React.js</strong>")}}});tm.render=em;var nm,am,im=tm,rm={class:"nav-wrapper"},om={class:"pull-right"},lm=Object(r["createElementVNode"])("svg",{class:"tm-icon tm-icon-close"},[Object(r["createElementVNode"])("use",{"xlink:href":"#tm-icon-close"})],-1),cm=[lm],sm={class:"pull-right"},dm=Object(r["createElementVNode"])("svg",{"aria-hidden":"true",style:{position:"absolute",width:"0",height:"0",overflow:"hidden"},version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Object(r["createElementVNode"])("defs",null,[Object(r["createElementVNode"])("symbol",{id:"tm-icon-checkmark",viewBox:"0 0 32 32"},[Object(r["createElementVNode"])("path",{d:"M27 4l-15 15-7-7-5 5 12 12 20-20z"})])])],-1),um=Object(r["createElementVNode"])("svg",{"aria-hidden":"true",style:{position:"absolute",width:"0",height:"0",overflow:"hidden"},version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Object(r["createElementVNode"])("symbol",{id:"tm-icon-close",viewBox:"0 0 32 32"},[Object(r["createElementVNode"])("path",{d:"M31.33 0.67c0.893 0.893 0.893 2.34 0 3.232l-27.427 27.427c-0.893 0.893-2.34\n          0.893-3.232 0s-0.893-2.34 0-3.232l27.427-27.427c0.892-0.893 2.34-0.893 3.232 0z"}),Object(r["createElementVNode"])("path",{d:"M0.67 0.67c0.893-0.893 2.34-0.893 3.232 0l27.427 27.427c0.893 0.892 0.893\n          2.34 0 3.232s-2.34 0.892-3.232 0l-27.427-27.427c-0.893-0.893-0.893-2.34 0-3.232z"})])],-1),gm={class:"page",style:{clear:"both"}},bm={key:0,id:"secondNavBar",class:"Menu--dashboard z-depth-1"},mm={class:"navbar",role:"menu",style:{padding:"0"}},pm={class:"menuTab",role:"menuitem"},hm={class:"item",style:{"font-weight":"normal"}},fm=Object(r["createTextVNode"])(" Events "),vm={key:0},jm=Object(r["createElementVNode"])("br",null,null,-1),Om=Object(r["createElementVNode"])("br",null,null,-1),Tm=Object(r["createElementVNode"])("label",{for:"onlyfiredTags",class:"lbl-onlyfiredTags"},"Only fired tags",-1),ym={key:0,style:{padding:"0 0 1rem 1.2rem"}},Vm=["onClick","title"],Cm={title:"This tag was fired"},Nm=Object(r["createElementVNode"])("svg",{class:"tm-icon tm-icon-checkmark"},[Object(r["createElementVNode"])("use",{"xlink:href":"#tm-icon-checkmark"})],-1),Em=[Nm],Sm={class:"pageWrap"},wm={class:"home",id:"content"},km=Object(r["createElementVNode"])("h3",null,"Fired Tags",-1),Mm={class:"entityTable"},_m=Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,"Action"),Object(r["createElementVNode"])("th",null,"Name"),Object(r["createElementVNode"])("th",null,"Type"),Object(r["createElementVNode"])("th",null,"Fired count")])],-1),Dm={key:0},Am=Object(r["createElementVNode"])("td",{colspan:"4"},"No tags",-1),xm=[Am],Bm=Object(r["createElementVNode"])("h3",{style:{"margin-top":"30px"}},"Not Yet Fired Tags",-1),Lm={class:"entityTable"},Um=Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,"Name"),Object(r["createElementVNode"])("th",null,"Type")])],-1),Pm=Object(r["createElementVNode"])("td",{colspan:"4"},"No tags",-1),Im=[Pm],Fm=Object(r["createElementVNode"])("h3",null,"Triggers",-1),Hm={class:"entityTable"},Gm=Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,"Name"),Object(r["createElementVNode"])("th",null,"Type")])],-1),$m={key:0},Rm=Object(r["createElementVNode"])("td",{colspan:"4"},"No trigger",-1),qm=[Rm],zm={key:1},Wm=Object(r["createElementVNode"])("h3",null,"Pushed data by this event",-1),Xm={class:"entityTable"},Km={style:{"word-break":"break-all"}},Jm=Object(r["createElementVNode"])("br",null,null,-1),Ym=Object(r["createElementVNode"])("h3",null,"Content after this event",-1),Zm={class:"entityTable"},Qm={style:{"word-break":"break-all"}},ep={class:"entityTable"},tp=Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,"Name"),Object(r["createElementVNode"])("th",null,"Type"),Object(r["createElementVNode"])("th",null,"Value")])],-1),np={key:0},ap=Object(r["createElementVNode"])("td",{colspan:"3"},"No variables",-1),ip=[ap],rp={style:{"word-break":"break-all"}},op={class:"entityTable"},lp=Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,"Time"),Object(r["createElementVNode"])("th",null,"Message")])],-1),cp={style:{"word-break":"break-all"}},sp=Object(r["createElementVNode"])("br",null,null,-1);function dp(e,t,n,a,i,o){var l,c,s,d,u,g,b,m,p,h;return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createElementVNode"])("nav",null,[Object(r["createElementVNode"])("div",rm,[Object(r["createElementVNode"])("ul",null,[Object(r["createElementVNode"])("li",null,[Object(r["renderSlot"])(e.$slots,"logo")]),Object(r["createElementVNode"])("li",{class:Object(r["normalizeClass"])({active:"tags"===e.contentTab||!e.contentTab})},[Object(r["createElementVNode"])("a",{onClick:t[0]||(t[0]=function(t){return e.contentTab="tags"})},"Tags")],2),Object(r["createElementVNode"])("li",{class:Object(r["normalizeClass"])({active:"triggers"===e.contentTab})},[Object(r["createElementVNode"])("a",{onClick:t[1]||(t[1]=function(t){return e.contentTab="triggers"})},"Triggers")],2),Object(r["createElementVNode"])("li",{class:Object(r["normalizeClass"])({active:"variables"===e.contentTab})},[Object(r["createElementVNode"])("a",{onClick:t[2]||(t[2]=function(t){return e.contentTab="variables"})},"Variables")],2),Object(r["createElementVNode"])("li",{class:Object(r["normalizeClass"])({active:"dataLayer"===e.contentTab})},[Object(r["createElementVNode"])("a",{onClick:t[3]||(t[3]=function(t){return e.contentTab="dataLayer"})},"Data Layer")],2),Object(r["createElementVNode"])("li",{class:Object(r["normalizeClass"])({active:"logs"===e.contentTab})},[Object(r["createElementVNode"])("a",{onClick:t[4]||(t[4]=function(t){return e.contentTab="logs"})},"Logs")],2),Object(r["createElementVNode"])("li",om,[Object(r["createElementVNode"])("a",{id:"mtmCloseDebug",onClick:t[5]||(t[5]=function(t){return e.mtmCloseDebugWindow()})},cm)]),Object(r["createElementVNode"])("li",sm,[Object(r["createElementVNode"])("a",{id:"mtmUpdateDebugPosition",onClick:t[6]||(t[6]=function(t){return e.mtmUpdateDebugPosition()})},Object(r["toDisplayString"])(e.positionText),1)])])])]),dm,um,Object(r["createElementVNode"])("div",gm,["logs"!==e.contentTab?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",bm,[Object(r["createElementVNode"])("ul",mm,[Object(r["createElementVNode"])("li",pm,[Object(r["createElementVNode"])("span",hm,[fm,e.mtmEvents.length>0?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",vm,[jm,Om,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"checkbox",class:"onlyFiredTags-chk",name:"onlyfiredTags",id:"onlyfiredTags",value:"1","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.onlyfiredTags=t}),style:{"margin-right":"3.5px"}},null,512),[[r["vModelCheckbox"],e.onlyfiredTags]]),Tm])):Object(r["createCommentVNode"])("",!0)])]),0===e.mtmEvents.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("li",ym,"No event executed")):Object(r["createCommentVNode"])("",!0),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.mtmEventsReversed,(function(t,n){var a,i;return Object(r["openBlock"])(),Object(r["createElementBlock"])("li",{class:Object(r["normalizeClass"])(["menuTab",{active:n===e.selectedEventIndex}]),role:"menuitem",key:n},[(t.tags||[]).length||!e.onlyfiredTags?(Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{key:0,class:"item",onClick:function(n){return e.selectEvent(t.index0)},title:"Time: ".concat(t.time,". Trigger: ").concat(null===(a=t.metTrigger)||void 0===a?void 0:a.name)},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.index)+": "+Object(r["toDisplayString"])(t.name)+" ",1),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",Cm,Em,512),[[r["vShow"],null===(i=t.tags)||void 0===i?void 0:i.length]])],8,Vm)):Object(r["createCommentVNode"])("",!0)],2)})),128))])])):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("div",Sm,[Object(r["createElementVNode"])("div",wm,[Object(r["withDirectives"])(Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.homeTabTitle),513),[[r["vShow"],"logs"!==e.contentTab]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[km,Object(r["createElementVNode"])("table",Mm,[_m,Object(r["createElementVNode"])("tbody",null,[null!==(l=e.selectedEvent)&&void 0!==l&&null!==(c=l.tags)&&void 0!==c&&c.length?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",Dm,xm)),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])((null===(s=e.selectedEvent)||void 0===s?void 0:s.tags)||[],(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:t},[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.action),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.name),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.type),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.numExecuted),1)])})),128))])]),Bm,Object(r["createElementVNode"])("table",Lm,[Um,Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,Im,512),[[r["vShow"],0===e.notFiredTags.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.notFiredTags,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:t},[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.name),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.type),1)])})),128))])])],512),[[r["vShow"],"tags"===e.contentTab||!e.contentTab]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Fm,Object(r["createElementVNode"])("table",Hm,[Gm,Object(r["createElementVNode"])("tbody",null,[null!==(d=e.selectedEvent)&&void 0!==d&&d.metTrigger?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",$m,qm)),null!==(u=e.selectedEvent)&&void 0!==u&&u.metTrigger?(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",zm,[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.selectedEvent.metTrigger.name),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.selectedEvent.metTrigger.type),1)])):Object(r["createCommentVNode"])("",!0)])])],512),[[r["vShow"],"triggers"===e.contentTab]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Wm,Object(r["createElementVNode"])("table",Xm,[Object(r["createElementVNode"])("tbody",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Km,Object(r["toDisplayString"])(e.selectedEventData),1)])])]),Jm,Ym,Object(r["createElementVNode"])("table",Zm,[Object(r["createElementVNode"])("tbody",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Qm,Object(r["toDisplayString"])(e.selectedEventContainerDataLayer),1)])])])],512),[[r["vShow"],"dataLayer"===e.contentTab]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("table",ep,[tp,Object(r["createElementVNode"])("tbody",null,[null!==(g=e.selectedEvent)&&void 0!==g&&null!==(b=g.container)&&void 0!==b&&null!==(m=b.variables)&&void 0!==m&&m.length?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",np,ip)),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])((null===(p=e.selectedEvent)||void 0===p||null===(h=p.container)||void 0===h?void 0:h.variables)||[],(function(t,n){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:n},[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.name),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.type),1),Object(r["createElementVNode"])("td",rp,Object(r["toDisplayString"])(e.stringifySelectedVariable(t)),1)])})),128))])])],512),[[r["vShow"],"variables"===e.contentTab]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("table",op,[lp,Object(r["createElementVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.mtmLogs,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:t},[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.time),1),Object(r["createElementVNode"])("td",cp,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.messages,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{key:t},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e),1),sp])})),128))])])})),128))])])],512),[[r["vShow"],"logs"===e.contentTab]])])])])])}function up(e){return pp(e)||mp(e)||bp(e)||gp()}function gp(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bp(e,t){if(e){if("string"===typeof e)return hp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hp(e,t):void 0}}function mp(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function pp(e){if(Array.isArray(e))return hp(e)}function hp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function fp(e){return fp="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fp(e)}window.mtmDbgData=Object(r["reactive"])({mtmEvents:(null===(nm=window.mtmDbgData)||void 0===nm?void 0:nm.mtmEvents)||[],mtmLogs:(null===(am=window.mtmDbgData)||void 0===am?void 0:am.mtmLogs)||[]});var vp="mtmPreviewPosition",jp="Stick to Top",Op="Stick to Bottom";function Tp(){var e=new WeakSet;function t(t,n){if("object"===fp(n)&&null!==n){if(e.has(n))return"";e.add(n)}return n}return t}var yp=Object(r["defineComponent"])({data:function(){return{contentTab:"tags",selectedEventIndex:0,onlyfiredTags:!1,positionText:"top"===Object(u["getCookie"])(vp)?Op:jp}},methods:{mtmUpdateDebugPosition:function(){var e=6048e5,t=Object(u["getCookie"])(vp),n="top"===t?"bottom":"top";Object(u["setCookie"])(vp,n,e);var a=window.parent.document.getElementById("mtmDebugFrame");"top"===n?(this.positionText=Op,a.classList.remove("mtmStickyBottom"),a.classList.add("mtmStickyTop")):(this.positionText=jp,a.classList.remove("mtmStickyTop"),a.classList.add("mtmStickyBottom"))},mtmCloseDebugWindow:function(){var e=window.parent.document.getElementById("mtmDebugFrame");e&&(e.style.display="none")},selectEvent:function(e){this.mtmEvents[e]&&(this.selectedEventIndex=e)},stringifySelectedVariable:function(e){return JSON.stringify(e.value,Tp())}},computed:{homeTabTitle:function(){var e;if(null===(e=this.selectedEvent)||void 0===e||!e.container)return"";var t=this.selectedEvent.container.versionName||"Draft version",n=this.selectedEvent.container.id,a=this.selectedEventIndex+1;return"Event ".concat(a,": ").concat(this.selectedEvent.name," (").concat(n," - ").concat(t,")")},notFiredTags:function(){var e;if(null===(e=this.selectedEvent)||void 0===e||!e.container)return[];var t=this.selectedEventIndex,n=[];this.mtmEvents.forEach((function(e,a){a>t||n.push.apply(n,up(e.tags.map((function(e){return e.name}))))}));var a=[];return this.selectedEvent.container.tags.forEach((function(e){-1===n.indexOf(e.name)&&a.push(e)})),a},selectedEvent:function(){return this.mtmEvents[this.selectedEventIndex]},mtmEvents:function(){return window.mtmDbgData.mtmEvents},mtmEventsReversed:function(){var e=up(this.mtmEvents);return e.reverse(),e},mtmLogs:function(){return window.mtmDbgData.mtmLogs},selectedEventData:function(){var e;return(null===(e=this.selectedEvent)||void 0===e?void 0:e.eventData)&&JSON.stringify(this.selectedEvent.eventData,Tp())},selectedEventContainerDataLayer:function(){var e,t;return(null===(e=this.selectedEvent)||void 0===e||null===(t=e.container)||void 0===t?void 0:t.dataLayer)&&JSON.stringify(this.selectedEvent.container.dataLayer,Tp())}}});yp.render=dp;var Vp=yp,Cp={class:"copyMtmObjectDialog"},Np=["innerHTML"],Ep=["innerHTML"];function Sp(e,t,n,a,i,o){var l=Object(r["resolveComponent"])("Field"),c=Object(r["resolveDirective"])("form");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Cp,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.getCopyDialogTitle),1),Object(r["createElementVNode"])("p",null,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.getCopyDescription)+" ",1),Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.getLearnMoreLink),class:"learnMore"},null,8,Np)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{uicontrol:"site",name:"destinationSite",title:e.translate("TagManager_ChooseWebsite"),modelValue:e.site,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.site=t})},null,8,["title","modelValue"]),"container"!==e.copyType.toLowerCase()?(Object(r["openBlock"])(),Object(r["createBlock"])(l,{key:0,uicontrol:"select",name:"idDestinationContainer",options:e.containerOptions,disabled:e.containerOptions.length<=1,"full-width":!0,title:e.translate("TagManager_Container"),modelValue:e.idDestinationContainer,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.idDestinationContainer=t})},null,8,["options","disabled","title","modelValue"])):Object(r["createCommentVNode"])("",!0),"container"===e.copyType.toLowerCase()?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",{key:1,class:"copyNote",innerHTML:e.$sanitize(e.getCopyContainerNote)},null,8,Ep)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("button",{class:"btn",onClick:t[2]||(t[2]=function(){return e.performCopy&&e.performCopy.apply(e,arguments)})},Object(r["toDisplayString"])(e.translate("General_Copy")),1)],512),[[c]])])}var wp=Object(r["defineComponent"])({props:{defaultSite:{type:Object,required:!0},copyType:{type:String,required:!0},copyNonce:{type:String,required:!1,default:""},idToCopy:{type:[String,Number],required:!0},idSourceContainer:{type:String,required:!1,default:""},idContainerVersion:{type:Number,required:!1,default:0}},directives:{Form:g["Form"]},components:{Field:g["Field"]},data:function(){return{site:this.defaultSite,idDestinationContainer:"",containerOptions:[]}},created:function(){this.onSiteChange(),this.idDestinationContainer=this.idSourceContainer},watch:{site:function(){this.onSiteChange()}},methods:{onSiteChange:function(){var e,t=this;"container"!==this.copyType.toLowerCase()&&(this.containerOptions=[],this.idDestinationContainer="",null!==(e=this.site)&&void 0!==e&&e.id&&u["AjaxHelper"].fetch({method:"TagManager.getContainers",filter_limit:"-1",idSite:this.site.id}).then((function(e){if(t.containerOptions=[],null===e||void 0===e||!e.length)return t.idDestinationContainer="",void t.containerOptions.push({key:"",value:t.translate("TagManager_NoContainersFound")});e.forEach((function(e){t.idDestinationContainer||(t.idDestinationContainer=e.idcontainer),t.containerOptions.push({key:e.idcontainer,value:e.name})}))})))},performCopy:function(){var e,t=this,n={module:"TagManager",action:"",idSite:this.defaultSite.id,idDestinationSite:null!==(e=this.site)&&void 0!==e&&e.id?this.site.id:0,nonce:this.copyNonce,idDestinationContainer:"",idSourceContainer:"",idContainerVersion:0,idContainer:0,idTag:0,idTrigger:0,idVariable:0};switch(this.copyType.toLowerCase()){case"container":n.action="copyContainer",n.idContainer=this.idToCopy;break;case"tag":n.action="copyTag",n.idTag=this.idToCopy;break;case"trigger":n.action="copyTrigger",n.idTrigger=this.idToCopy;break;case"variable":n.action="copyVariable",n.idVariable=this.idToCopy;break;default:throw Error("Unrecognised copy object type.")}this.idDestinationContainer&&(n.idDestinationContainer=this.idDestinationContainer),this.idSourceContainer&&(n.idSourceContainer=this.idSourceContainer),this.idContainerVersion>0&&(n.idContainerVersion=this.idContainerVersion),u["AjaxHelper"].fetch(n).then((function(e){if(!e||!e.isSuccess||!e.urlToNewCopy){var n=Object(u["translate"])("General_ErrorRequest","",""),a=u["NotificationsStore"].show({message:n,id:"CopyDialogResultNotification",context:"error",type:"transient"});return u["NotificationsStore"].scrollToNotification(a),void window.Piwik_Popover.close()}t.reloadEntityStore(),t.displaySuccessNotification(e.urlToNewCopy),window.Piwik_Popover.close()}))},reloadEntityStore:function(){switch(this.copyType.toLowerCase()){case"container":gd.reload();break;case"tag":po.reload(this.idSourceContainer,this.idContainerVersion);break;case"trigger":Va.reload(this.idSourceContainer,this.idContainerVersion);break;case"variable":vt.reload(this.idSourceContainer,this.idContainerVersion);break;default:throw Error("Unrecognised copy object type.")}},displaySuccessNotification:function(e){var t="TagManager_CopyXSuccess",n="";switch(this.copyType.toLowerCase()){case"container":n="TagManager_ContainerLowercase";break;case"tag":n="TagManager_TagLowercase";break;case"trigger":n="TagManager_TriggerLowercase";break;case"variable":n="TagManager_VariableLowercase";break;default:throw Error("Unrecognised copy object type.")}var a=Object(u["translate"])(t,['<a href="'.concat(e,'">'),Object(u["translate"])(n),"</a>"]),i=u["NotificationsStore"].show({message:a,id:"CopyDialogResultNotification",context:"success",type:"transient"});u["NotificationsStore"].scrollToNotification(i)}},computed:{getCopyDialogTitle:function(){var e="";switch(this.copyType.toLowerCase()){case"container":e=Object(u["translate"])("TagManager_Container");break;case"tag":e=Object(u["translate"])("TagManager_Tag");break;case"trigger":e=Object(u["translate"])("TagManager_Trigger");break;case"variable":e=Object(u["translate"])("TagManager_Variable");break;default:throw Error("Unrecognised copy object type.")}return Object(u["translate"])("TagManager_CopyX",e)},getCopyDescription:function(){if("container"===this.copyType.toLowerCase())return Object(u["translate"])("TagManager_CopyContainerDescription");var e="";switch(this.copyType.toLowerCase()){case"tag":e=Object(u["translate"])("TagManager_TagLowercase");break;case"trigger":e=Object(u["translate"])("TagManager_TriggerLowercase");break;case"variable":e=Object(u["translate"])("TagManager_VariableLowercase");break;default:throw Error("Unrecognised copy object type.")}return Object(u["translate"])("TagManager_CopyXDescription",e)},getCopyContainerNote:function(){return Object(u["translate"])("TagManager_CopyContainerNote","<strong>","</strong>")},getCopyUrl:function(){var e,t={module:"TagManager",action:"",idSite:this.defaultSite.id,idDestinationSite:null!==(e=this.site)&&void 0!==e&&e.id?this.site.id:0,nonce:this.copyNonce,idDestinationContainer:"",idSourceContainer:"",idContainerVersion:0,idContainer:0,idTag:0,idTrigger:0,idVariable:0};switch(this.copyType.toLowerCase()){case"container":t.action="copyContainer",t.idContainer=this.idToCopy;break;case"tag":t.action="copyTag",t.idTag=this.idToCopy;break;case"trigger":t.action="copyTrigger",t.idTrigger=this.idToCopy;break;case"variable":t.action="copyVariable",t.idVariable=this.idToCopy;break;default:throw Error("Unrecognised copy object type.")}return this.idDestinationContainer&&(t.idDestinationContainer=this.idDestinationContainer),this.idSourceContainer&&(t.idSourceContainer=this.idSourceContainer),this.idContainerVersion>0&&(t.idContainerVersion=this.idContainerVersion),"?".concat(u["MatomoUrl"].stringify(t))},getLearnMoreLink:function(){var e="";switch(this.copyType.toLowerCase()){case"container":e="https://matomo.org/faq/tag-manager/how-to-copy-a-matomo-tag-manager-container-and-its-components";break;case"tag":e="https://matomo.org/faq/tag-manager/how-to-copy-a-tag-in-matomo-tag-manager ";break;case"trigger":e="https://matomo.org/faq/tag-manager/how-to-copy-a-trigger-in-matomo-tag-manager";break;case"variable":e="https://matomo.org/faq/tag-manager/how-to-copy-a-variable-in-matomo-tag-manager";break;default:throw Error("Unrecognised copy object type.")}var t=Object(u["externalLink"])(e);return Object(u["translate"])("TagManager_LearnMoreFullStop",t,"</a>")}}});wp.render=Sp;var kp=wp;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 